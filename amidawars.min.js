enchant();
var AW=function(G){var N=function(){G.pageYOffset===0&&G.scrollTo(0,1)};G.addEventListener("load",function(){setTimeout(N,100)},false);G.onorientationchange=function(){setTimeout(N,100)};var q,O,u={USER:{UNIT:new Group,CASTLE:new Group,THUMB:new Group},ENEMY:{UNIT:new Group,CASTLE:new Group,THUMB:new Group},MAP_OPTION:{CASTLE_BASE:new Group,THUMB_BASE:new Group},EFFECT:{UNIT:new Group}},D="",K=[],z={USER:{},ENEMY:{},no:0},P={USER:[],ENEMY:[]},s={USER:[],ENEMY:[]},H={},L={},Q={},M=[],E={USER:[],ENEMY:[]},
R=[],F={},S,A=function(b,c){b===void 0&&(b={});for(var e in c)c.hasOwnProperty(e)&&(b[e]=c[e]);return b},B=function(b){b.layer.addChild(b.sprite);return b.sprite},T={},I=function(){return{TIMELIMIT:function(){return 180},FONT:function(){return"monospace"},UNIT:function(){return{IMAGE:"char.gif",CHIP_SIZE:16,FRAME_SIZE:{W:4,H:3},FRAME_LINE:16,FRAME_BLOCK:48,FRAME:{HUMAN:{LANCER:0,WARRIOR:4,KNIGHT:8,ARCHER:12,CLELIC:16,FIRE_MAGE:20,FROST_MAGE:24,WIZARD:28},UNDEAD:{BONE_DOG:32,BONE_WARRIER:36,BONE_ARCHER:40,
SPECTOR:44,BONE_SNAKE:48,GOLEM:52,SHADE:56,ARACHNE:60}},STATUS:{HUMAN:{WARRIOR:{name:"WARRIOR",frame:0,hp:2,armor:"MIDIUM",speed:1,damage:3,siege:1,reverse:4},LANCER:{name:"LANCER",frame:4,hp:3,armor:"MIDIUM",speed:1,damage:2,siege:1,reverse:2},KNIGHT:{name:"KNIGHT",frame:8,hp:4,armor:"HEAVY",speed:0.9,damage:2,siege:1,reverse:7},ARCHER:{name:"ARCHER",frame:12,hp:1,armor:"LIGHT",speed:1.1,damage:3,siege:1,reverse:3},CLELIC:{name:"CLELIC",frame:48,hp:1,armor:"NOARMOR",speed:0.5,damage:1,siege:1,reverse:2},
FIRE_MAGE:{name:"FIRE_MAGE",frame:52,hp:1,armor:"NOARMOR",speed:0.8,damage:2,siege:1,reverse:3},FROST_MAGE:{name:"FROST_MAGE",frame:56,hp:1,armor:"NOARMOR",speed:0.8,damage:2,siege:1,reverse:3},WIZARD:{name:"WIZARD",frame:60,hp:1,armor:"NOARMOR",speed:0.8,damage:3,siege:1,reverse:4}},UNDEAD:{BONE_DOG:{name:"BONE_DOG",frame:96,hp:1,armor:"LIGHT",speed:1.4,damage:2,siege:1,reverse:1},BONE_WARRIER:{name:"BONE_WARRIER",frame:100,hp:2,armor:"MIDIUM",speed:1,damage:2,siege:1,reverse:1},BONE_ARCHER:{name:"BONE_ARCHER",
frame:104,hp:1,armor:"MIDIUM",speed:1,damage:3,siege:1,reverse:1},SHADE:{name:"SHADE",frame:108,hp:1,armor:"NOARMOR",speed:0.7,damage:1,siege:1,reverse:3},BONE_SNAKE:{name:"BONE_SNAKE",frame:144,hp:2,armor:"LIGHT",speed:1.3,damage:1,siege:1,reverse:1},GOLEM:{name:"GOLEM",frame:148,hp:5,armor:"HEAVY",speed:0.5,damage:2,siege:10,reverse:6},SPECTOR:{name:"SPECTOR",frame:152,hp:1,armor:"NOARMOR",speed:0.7,damage:1,siege:1,reverse:3},ARACHNE:{name:"ARACHNE",frame:156,hp:3,armor:"MIDIUM",speed:1,damage:2,
siege:1,reverse:4}}},AI:{USER:[{direction:0,prop:"y",sign:-1,order:[1,3,0,2]},{direction:3,prop:"x",sign:-1,order:[0,2,3,1]},{direction:1,prop:"x",sign:1,order:[0,2,1,3]},{direction:2,prop:"y",sign:1,order:[3,1,2,0]}],ENEMY:[{direction:2,prop:"y",sign:1,order:[3,1,2,0]},{direction:3,prop:"x",sign:-1,order:[2,0,3,1]},{direction:1,prop:"x",sign:1,order:[2,0,1,3]},{direction:0,prop:"y",sign:1,order:[3,1,0,2]}]}}},THUMB:function(){return{IMAGE:"thumb.png",CHIP_SIZE:48,FRAME:{HUMAN:{LANCER:0,WARRIOR:1,
KNIGHT:2,ARCHER:3,CLELIC:4,FIRE_MAGE:5,FROST_MAGE:6,WIZARD:7},UNDEAD:{BONE_DOG:8,BONE_SNAKE:9,BONE_WARRIER:10,BONE_ARCHER:11,GOLEM:12,ARACHNE:13,SHADE:14,SPECTOR:15}},USER:{POSITION:[[0,384],[48,384],[96,384],[144,384],[0,432],[48,432],[96,432],[144,432]]},ENEMY:{},PROP:{}}},SCORE:function(){return{POSITION:[20,7]}},COUNTDOWN:function(){return{POSITION:[200,7]}},STATUS_VIEWER:function(){return{IMAGE:"window_status.png",POSITION:[192,384],BG_SIZE:[128,96]}},MAP:function(){return{IMAGE:"map.png",W:320,
H:480,CHIP_SIZE:32}},CASTLE:function(){return{FRAME:[{NORMAL:8,BRAKE:9},{NORMAL:10,BRAKE:11},{NORMAL:12,BRAKE:13},{NORMAL:14,BRAKE:15}],PROP:{frame:0,brake:0,hp:2,mhp:2,unitX:0,unitY:0}}},EFFECT:function(){return{IMAGE:"effect.gif",FRAME:{EXPLOSION:[0,5]}}},SOUND:function(){return{BGM:"bgm.wav",EFFECT:{EXPLOSION:"explosion.wav"}}},TYPE:function(){return{CASTLE:"CASTLE",THUMB:"THUMB",UNIT:"UNIT",EFFECT:"EFFECT"}},HAVE:function(){return{USER:"USER",ENEMY:"ENEMY"}},POINT:function(){return{UNIT:10,CASTLE:1E3,
WIN:5E3,LOSE:-5E3,TIME:100}}}},e=I(),e={TIMELIMIT:e.TIMELIMIT(),FONT:e.FONT(),UNIT:e.UNIT(),THUMB:e.THUMB(),SCORE:e.SCORE(),COUNTDOWN:e.COUNTDOWN(),STATUS_VIEWER:e.STATUS_VIEWER(),MAP:e.MAP(),CASTLE:e.CASTLE(),EFFECT:e.EFFECT(),SOUND:e.SOUND(),TYPE:e.TYPE(),HAVE:e.HAVE(),POINT:e.POINT()};T.init=function(b){var c=e.UNIT.IMAGE,h=e.THUMB.IMAGE,d=e.MAP.IMAGE,f=e.EFFECT.IMAGE,g=e.STATUS_VIEWER.IMAGE,a=e.SOUND.EFFECT.EXPLOSION,w=e.MAP.W,m=e.MAP.H,j=b.order,k,n;D=b.race;for(k=0,n=j.length;k<n;k++)K.push({name:j[k].toUpperCase(),
onMap:false});M=b=b.map;for(k=0,n=b.length;k<n;k++)b[k]=b[k].split("");k={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,24:0,26:0,27:0,28:0,29:0,30:0,31:0,32:0,33:0,34:0,35:0,36:0,37:0,38:0,39:0,40:0,41:0,42:0,43:0,44:0,45:0,46:0,47:0,48:0,49:0,50:0,51:0,52:0,25:[0,0,1,0],99:[1,0,0,0],16:[1,0,1,0],17:[0,1,0,1],18:[1,1,1,0],19:[1,0,1,1],20:[0,1,1,0],21:[0,0,1,1],22:[1,1,0,0],23:[1,0,0,1]};var o,i,x,p,t=[],b=[].concat([[26,27,28,29,30,31,32,33,34,35],[0,1,1,1,1,1,1,1,1,2]],b,[[5,6,6,6,6,6,6,6,6,7],[36,37,38,39,40,
41,42,43,44,45],[46,47,48,49,50,51,52,46,47,48],[49,50,51,52,51,52,46,47,48,49]]);for(n=0,o=b.length;n<o;n++){x=t[n]=[];p=b[n];p.length===8&&(b[n]=p=["3"].concat(p,"4"));for(j=0,i=p.length;j<i;j++){var y=p,v=j,l=p[j];l==="\u2502"?l=16:l==="\u2500"?l=17:l==="\u251c"?l=18:l==="\u2524"?l=19:l==="\u250c"?l=20:l==="\u2510"?l=21:l==="\u2514"?l=22:l==="\u2518"?l=23:l==="\u00d7"?l=24:l==="\u25a0"?l=25:l==="\u25a1"&&(l=99);y[v]=l;x[j]=k[p[j]];p[j]===25?E.ENEMY.push([j,n]):p[j]===99&&(E.USER.push([j,n]),p[j]=
25)}}M=b;R=t;q=new Game(w,m);q.preload(c,h,d,f,g,a);q.onload=Amida;q.start()};Amida=function(){var b=e.MAP.CHIP_SIZE,c=M,h=new Map(b,b),d=q.assets[e.MAP.IMAGE],f=u.USER,g=u.ENEMY,a=e.CASTLE.FRAME,w=e.THUMB.USER.POSITION,m=e.HAVE.USER,j=u.MAP_OPTION.CASTLE_BASE,k=u.MAP_OPTION.THUMB_BASE,n=u.EFFECT.UNIT,o=q.rootScene,U=e.UNIT.CHIP_SIZE,x=e.SCORE.POSITION,p,t=e.COUNTDOWN.POSITION,y=e.STATUS_VIEWER.POSITION,v,l;O=document.getElementById("enchant-stage");h.image=d;h.loadData(c);h.vibrate=function(a){var b=
O.style;a+="px";clearInterval(l);l=setTimeout(function(){b.top=0;b.left=a;l=setTimeout(function(){b.top=a;b.left=0;l=setTimeout(function(){b.top=0;b.left="-"+a;l=setTimeout(function(){b.top=0;b.left=0},30)},30)},30)},30)};h.getSquere=function(a){var c,d,e=Math.floor;h.getSquere=function(a){c=e(a.x/b);d=e(a.y/b);return{x:c,y:d}};return h.getSquere(a)};h.getCollision=function(a){var b=h.getSquere(a),c=R,d=false,e,f,g;if((c=c[b.y])&&(c=c[b.x]))if(c[0]+c[1]+c[2]+c[3]===1)for(e in s){if(s.hasOwnProperty(e)){f=
s[e];for(b=0,c=f.length;b<c;b++)if(g=f[b],a.intersect(g)){d=g;break}}}else d=c;return d};F=h;statusViewer=Q=new StatusViwer({mode:m,x:y[0],y:y[1]});c=H=new Score({mode:m,x:x[0],y:x[1]});p=L=new Countdown({x:t[0],y:t[1]});p.update();for(v in E)if(E.hasOwnProperty(v)){x=E[v];for(d=0,t=x.length;d<t;d++)y=new Castle({mode:v,frame:a[d].NORMAL,brake:a[d].BRAKE,x:x[d][0]*b,y:x[d][1]*b}),y.unitX=y.x+U/2,y.unitY=y.y+U/2}for(v=0,t=K.length;v<t;v++)a=K[v].name,new Thumb({mode:m,name:a,frame:e.THUMB.FRAME[D][a],
x:w[v][0],y:w[v][1]});o.addChild(h);o.addChild(j);o.addChild(statusViewer);o.addChild(k);o.addChild(g.CASTLE);o.addChild(g.UNIT);o.addChild(f.UNIT);o.addChild(f.CASTLE);o.addChild(f.THUMB);o.addChild(g.THUMB);o.addChild(n);o.addChild(c.label);o.addChild(p);S=q.assets[e.SOUND.EFFECT.EXPLOSION];C.init();(function(){var a=false,b=function(){new Result(a);r.end();J.end();i.end();p.stop()};r.add(function(){if(gameStart){var c,d;i.init();d=P.USER;J.init();p.setAfter(function(){a=true;b();return true});
p.init();for(c in d)d.hasOwnProperty(c)&&d[c].init();r.remove("playStart");q.popScene();return true}return false},"playStart");r.add(function(){var c,d,e,f,h,g;if(a!==false)return b(),true;for(c in s)if(s.hasOwnProperty(c)){f=s[c];e=f.length;for(d=g=0;d<e;d++)if(h=f[d],h.hp>0)break;else g++;if(g===e){a=c;break}}return false},"playEnd");r.init()})();f=new Scene;q.pushScene(f);f.backgroundColor="#F00"};Castle=function(b){var c=e.MAP.CHIP_SIZE,h=q.assets[e.MAP.IMAGE],d=I().CASTLE().PROP,f=b.mode.toUpperCase(),
g=e.HAVE,a=new Sprite(c,c),w=u.MAP_OPTION.CASTLE_BASE,m=-1,j,c=new Sprite(c,c);c.image=h;c.frame=24;if(f===g.USER)c.frame=16;c.x=b.x;c.y=b.y;B({layer:w,sprite:c});d.base=c;d=A(d,b);a.image=h;a=A(a,d);a.type=e.TYPE.CASTLE;s[f].push(a);a.focusOn=function(){a.scaleX=a.scaleY=1.4;a.focus=true};a.focusOff=function(){a.scaleX=a.scaleY=1;a.focus=false};j=function(){q.frame%4===0&&(a.opacity+=0.1*m,a.opacity<=0.5?m=1:a.opacity>=1&&(m=-1))};a.blinkOn=function(){a.addEventListener(enchant.Event.ENTER_FRAME,
j)};a.blinkOff=function(){a.removeEventListener(enchant.Event.ENTER_FRAME,j);a.opacity=1};a.damage=function(b){a.hp-=b.siege;if(a.hp<=0)a.hp=0,a.broke();else if(a.mhp/2>=a.hp)a.frame=a.brake};a.broke=function(){a.hp=a.opacity=a.base.opacity=0};a.checkBreak=function(){return a.hp===0?true:false};return B({layer:u[f].CASTLE,sprite:a})};Thumb=function(b){var c=e.THUMB.CHIP_SIZE,h=q.assets[e.THUMB.IMAGE],d=I().THUMB().PROP,f=e.UNIT.STATUS[D][b.name],g=b.mode.toUpperCase(),a=new Sprite(c,c),c=new Sprite(c,
c),w,m,j,k,n=enchant.Event,o=Q,i=new Label;c.image=h;c.frame=16;c.x=b.x;c.y=b.y;B({layer:u.MAP_OPTION.THUMB_BASE,sprite:c});i.text=Math.ceil(f.reverse);i.font="24px "+e.FONT;i.color="#ccc";i.x=b.x+17;i.y=b.y+7;B({layer:u.MAP_OPTION.THUMB_BASE,sprite:i});d=A(d,b);a.image=h;a=A(a,d);a.unit={mode:g};a.unit=A(a.unit,f);a.type=e.TYPE.THUMB;j=a.x;k=a.y;a.addEventListener(n.TOUCH_START,function(b){if(this.canDrag===true){w=b.x-this.x;m=b.y-this.y;var b=s.USER,c,d,e;for(d=0,e=b.length;d<e;d++)c=b[d],c.checkBreak()===
false&&c.blinkOn()}o.update(a.unit)});a.addEventListener(n.TOUCH_MOVE,function(a){if(this.canDrag===true){this.x=a.x-w;this.y=a.y-m;var a=s.USER,b,c,d,e=true;for(c=0,d=a.length;c<d;c++)b=a[c],e===true&&this.intersect(b)?(b.focusOn(),e=false):b.focusOff()}});a.addEventListener(n.TOUCH_END,function(){if(this.canDrag===true){var a;a=false;var b=s.USER,c,d,e;for(d=0,e=b.length;d<e;d++)if(c=b[d],this.intersect(c)){a=c;break}if(a)this.dragStop(),this.unit.x=a.unitX,this.unit.y=a.unitY,this.lastUnit=new Unit(this.unit),
this.lastUnit.thumb=this,a.focusOff();this.x=j;this.y=k;a=s.USER;for(c=0,d=a.length;c<d;c++)b=a[c],b.checkBreak()===false&&b.blinkOff()}});a.dragStart=function(){a.canDrag=true;a.opacity=1};a.dragStop=function(){a.canDrag=false;a.opacity=0};a.reverse=function(b){var c=Math.ceil(b.reverse),d=setInterval(function(){c--;i.text=c;if(c===0)i.text="",a.dragStart(),clearInterval(d)},1E3);i.text=c;a.opacity=0.3};P[g].push(a);a.dragStop();a.opacity=0.3;a.init=function(){a.reverse(a.unit)};return B({layer:u[g].THUMB,
sprite:a})};Unit=function(b){var c=e.UNIT.CHIP_SIZE,h=e.MAP.CHIP_SIZE,d=c/2,f=q.assets[e.UNIT.IMAGE],g=b.mode.toUpperCase(),a=new Sprite(c,c),c=e.HAVE,w=e.UNIT.FRAME_LINE,m=0,j=0,k=e.UNIT.AI[g],n,o,r,s,p,t;a.direction=0;a.image=f;a=A(a,b);a.type=e.TYPE.UNIT;a.attack=function(b){b.hp-=a.damage;b.hp<=0&&b.kill();return b.hp};a.kill=function(){var b=a.x,c=a.y;new Effect({type:a.type.toUpperCase(),x:b,y:c,frames:e.EFFECT.FRAME.EXPLOSION});S.play();delete z[g][a.myNo];u[g].UNIT.removeChild(a);typeof a.after_death===
"function"&&setTimeout(function(){a.after_death(a)},a.reverse);a.thumb&&a.thumb.reverse(a)};a.checkDeath=function(){return a.hp===0?true:false};n=a.frame;a.changeUnit=function(a){n=a.frame};o=function(){return F.getSquere(a)};a.beforePoint=o();r=function(){var b=false;if(d>=h){var c,e=a.beforePoint;d-=h;if(d>0)a.direction===0?a.y+=d:a.direction===1?a.x-=d:a.direction===2?a.y-=d:a.x+=d,a.y=Math.round(a.y),a.x=Math.round(a.x);d=0;c=o();if(c.x!==e.x||c.y!==e.y)b=true}return b};s=function(){return F.getCollision(a)};
p=function(){q.frame%5===0&&(m++,m===4?(m=0,j=-1):m===3&&(j=0),j++);a.frame=n+j*w+a.direction};t=function(){var b=a.direction,c=a.speed,f=e.TYPE,h,g=k.length,j,i;t=function(){p();d+=c;for(h=0;h<g;h++)if(j=k[h],b===j.direction){a[j.prop]+=c*j.sign;if(r()&&(i=s(),i!==false))i.type!==f.CASTLE?a.direction=i[j.order[0]]===1?j.order[0]:i[j.order[1]]===1?j.order[1]:i[j.order[2]]===1?j.order[2]:j.order[3]:C.siege(a,i);break}};t()};a.addEventListener(enchant.Event.ENTER_FRAME,t);a.stay=function(){a.removeEventListener(enchant.Event.ENTER_FRAME,
t);a.addEventListener(enchant.Event.ENTER_FRAME,function(){p()})};a.myNo=z.no;z[g][z.no]=a;z.no++;g===c.USER&&(d=-d);i.unit(a);return B({layer:u[g].UNIT,sprite:a})};Score=function(b){var c=e.HAVE,h=b.mode,d=b.x,b=b.y,f=new Label,g={},a=function(a){g.total+=a;return g.total};f.font="12px "+e.FONT;f.color="#ccc";f.x=d;f.y=b;g={label:f,total:0,rate:0.5,mode:h,point:I().POINT,add:a,update:function(){}};if(h===c.USER)g.update=function(){f.text="SCORE : "+g.total},g.get=function(){return g.total},g.add=
function(b){a(b);g.update();return g.total},g.rate=1;g.update();return g};Countdown=function(b){var c=new Label,h=e.TIMELIMIT,d=0,f,g=function(){};c.font="12px "+e.FONT;c.color="#ccc";c.x=b.x;c.y=b.y;c.update=function(){c.text="TIME-LIMIT : "+(h-d)};c.init=function(){c.stop();f=setInterval(function(){d++;d>=h&&(g(),c.stop());c.update()},1E3)};c.setAfter=function(a){g=a};c.getDiff=function(){return h-d};c.stop=function(){clearInterval(f)};return c};Effect=function(b){var c=e.UNIT.CHIP_SIZE,h=b.frames[0],
d=b.frames[1],f=b.type.toUpperCase(),g=u.EFFECT[f],a=new Sprite(c,c),i=function(){q.frame%3===0&&(a.frame++,a.frame>=d&&(a.removeEventListener(enchant.Event.ENTER_FRAME,i),g.removeChild(a)))};a.image=q.assets[e.EFFECT.IMAGE];a.x=b.x;a.y=b.y;a.frame=h;a.addEventListener(enchant.Event.ENTER_FRAME,i);return B({layer:g,sprite:a})};var J={aiid:0,race:"",order:[],init:function(){var b=J,c=e.HAVE.ENEMY,h,d,f,g=s.ENEMY,a=g.length,i=e.UNIT.STATUS,m,j,k;D==="HUMAN"?(b.race="UNDEAD",b.order="BONE_DOG,BONE_WARRIER,BONE_ARCHER,SHADE,BONE_SNAKE,GOLEM,SPECTOR,ARACHNE".split(",")):
(b.race="HUMAN",b.order="LANCER,WARRIOR,KNIGHT,ARCHER,CLELIC,FIRE_MAGE,FROST_MAGE,WIZARD".split(","));i=i[b.race];m=b.order;b.aiid=setInterval(function(){j=m.length;j>0&&(f=Math.floor(Math.random()*a),f>=a&&(f=a-1),h=g[f],f=Math.floor(Math.random()*j),f>=j&&(f=j-1),k=m[f],d=i[k],m.splice(f,1),f={mode:c,direction:2,x:h.unitX,y:h.unitY,after_death:function(a){m.push(a.name)}},f=A(f,d),d=new Unit(f))},3E3)},end:function(){clearInterval(J.aiid)}},C={init:function(){r.add(function(){var b=z.USER,c=z.ENEMY,
e,d,f,g;for(f in c)if(c.hasOwnProperty(f))for(g in d=c[f],b)b.hasOwnProperty(g)&&(e=b[g],d.intersect(e)&&(e.x===d.x||e.y===d.y)&&C.unitAndUnit(d,e))},"battle")},score:function(b){var c=e.HAVE,h=b.mode,d=e.TYPE,b=b.type,f=H,g=e.POINT;b!==d.CASTLE&&h===c.USER||b===d.CASTLE&&h===c.ENEMY?f.add(g[b]):b===d.CASTLE&&h===c.USER&&f.add(-g[b])},unitAndUnit:function(b,c){for(var e=b.hp,d=c.hp;e>0&&d>0;)e=b.attack(c),d=c.attack(b);b.checkDeath()&&(i.death(b),C.score(b));c.checkDeath()&&(i.death(c),C.score(c));
F.vibrate(1)},siege:function(b,c){i.siege(c);c.damage(b);b.kill();F.vibrate(3);c.checkBreak()&&(i.castle(c),C.score(c))}},r={functions:{},exefunc:function(){var b,c=r.functions;for(b in c)if(c.hasOwnProperty(b))c[b]()},add:function(b,c){r.functions[c]=b},remove:function(b){delete r.functions[b]},init:function(){q.addEventListener(enchant.Event.ENTER_FRAME,r.exefunc,false)},stop:function(){q.removeEventListener(enchant.Event.ENTER_FRAME,r.exefunc,false)},end:function(){r.functions={};r.stop()}};StatusViwer=
function(){var b=new Label,c=new Group,h,d=e.STATUS_VIEWER,f=d.POSITION,g=q.assets[d.IMAGE],d=d.BG_SIZE,d=new Sprite(d[0],d[1]),a=e.UNIT.STATUS[D],i=e.HAVE.USER,m={},j,k;for(j in a)a.hasOwnProperty(j)&&(k=a[j],m[j]="<b>"+k.name+"</b><br />HP: "+k.hp+"<br />Armor: "+k.armor+"<br />Damage: "+k.damage+"<br />Speed: "+k.speed+"<br />DownTime: "+k.reverse+"sec");c.x=f[0];c.y=f[1];d.image=g;d.frame=0;b.font="9px/1.5 "+e.FONT;b.color="#fff";b.text="";b.x=45;b.y=8;h=new Unit({mode:i,x:15,y:15,opacity:0});
h.frame=0;h.direction=2;h.stay();c.update=function(a){h.opacity=1;c.update=function(a){b.text=m[a.name];h.changeUnit(a)};c.update(a)};c.addChild(d);c.addChild(b);c.addChild(h);return c};var i={logid:0,data:{time:0,unit:{USER:0,ENEMY:0},death:{USER:0,ENEMY:0},siege:{USER:0,ENEMY:0},castle:{USER:0,ENEMY:0}},unit:function(b){i.data.unit[b.mode]++},death:function(b){i.data.death[b.mode]++},siege:function(b){i.data.siege[b.mode]++},castle:function(b){i.data.castle[b.mode]++},send:function(){i.data.time=
L.getDiff();console.log(JSON.stringify(i.data))},reset:function(){i.data={time:0,unit:{USER:0,ENEMY:0},death:{USER:0,ENEMY:0},siege:{USER:0,ENEMY:0},castle:{USER:0,ENEMY:0}}},init:function(){i.reset();i.end();i.logid=setInterval(i.send,3E4)},end:function(){i.send();clearInterval(i.logid)}};Result=function(b){var c=new Scene,h=new Label,d=new Label,f=e.HAVE,g=H.get(),a=e.POINT,i;console.log(H.get);i="SCORE: "+g+"<br>";b===f.ENEMY?(b="WIN",f=L.getDiff()*a.TIME,i+="&nbsp;WIN: "+a.WIN+"<br>&nbsp;CLEAR TIME BONUS: "+
f,g+=a.WIN+f):b===f.USER?(b="LOSE",i+="&nbsp;LOSE: "+a.LOSE,g+=a.LOSE):(b="DRAW",i+="&nbsp;DRAW: 0");i+="<br><br><b>TOTAL: "+g+"</b>";a=e.FONT;h.font="20px/1.5 "+a;h.color="#fff";h.text="RESULT";h.x=100;h.y=100;d.font="12px/1.5 "+a;d.color="#fff";d.text=i;d.x=100;d.y=150;c.addChild(h);c.addChild(d);c.backgroundColor="rgba(0,0,0,0.3)";q.pushScene(c);q.end(g,b+":"+g)};return T}(window);
AW.init({race:"UNDEAD",order:"bone_dog,bone_snake,bone_warrier,bone_archer,golem,arachne,spector,shade".split(","),map:"\u25a0\u00d7\u25a0\u00d7\u25a0\u00d7\u25a0\u00d7,\u251c\u2500\u2524\u00d7\u2502\u00d7\u2502\u00d7,\u2502\u00d7\u2502\u00d7\u251c\u2500\u2524\u00d7,\u2502\u00d7\u2514\u2510\u2502\u00d7\u2502\u00d7,\u2514\u2510\u00d7\u251c\u2524\u00d7\u2514\u2510,\u00d7\u2502\u00d7\u2502\u2514\u2510\u00d7\u2502,\u00d7\u251c\u2500\u2524\u00d7\u2502\u00d7\u2502,\u00d7\u2502\u00d7\u2502\u00d7\u251c\u2500\u2524,\u00d7\u25a1\u00d7\u25a1\u00d7\u25a1\u00d7\u25a1".split(",")});
