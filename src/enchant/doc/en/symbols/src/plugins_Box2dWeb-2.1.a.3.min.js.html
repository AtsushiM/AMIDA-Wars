<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Box2D</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">Object.prototype.defineProperty</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Function</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">Object.prototype.__defineGetter__</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Function</span><span class="PUNC">&&</span><span class="NAME">Object.prototype.__defineSetter__</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Function</span><span class="PUNC">)</span><span class="NAME">Object.defineProperty</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.get</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Function</span><span class="PUNC">&&</span><span class="NAME">y.__defineGetter__</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">A.get</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.set</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Function</span><span class="PUNC">&&</span><span class="NAME">y.__defineSetter__</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">A.set</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.inherit</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">K.prototype</span><span class="PUNC">=</span><span class="NAME">w.prototype</span><span class="PUNC">;</span><span class="NAME">y.prototype</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">y.prototype.constructor</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.generateCallback</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">w.apply</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  3</span> </span><span class="NAME">F.NVector</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">===</span><span class="NAME">G</span><span class="PUNC">)</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">y</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">A</span><span class="PUNC">)</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.is</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">===</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Function</span><span class="PUNC">&&</span><span class="NAME">y</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y.constructor.__implements</span><span class="PUNC">!=</span><span class="NAME">G</span><span class="PUNC">&&</span><span class="NAME">y.constructor.__implements</span><span class="PUNC">[</span><span class="NAME">w</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.parseUInt</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">Box2D</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">,</span><span class="NAME">Vector_a2j_Number</span><span class="PUNC">=</span><span class="NAME">Box2D.NVector</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">Box2D</span><span class="PUNC">===</span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="NAME">Box2D</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">Box2D.Collision</span><span class="PUNC">===</span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="NAME">Box2D.Collision</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  4</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">Box2D.Collision.Shapes</span><span class="PUNC">===</span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="NAME">Box2D.Collision.Shapes</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">Box2D.Common</span><span class="PUNC">===</span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="NAME">Box2D.Common</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">Box2D.Common.Math</span><span class="PUNC">===</span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="NAME">Box2D.Common.Math</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">Box2D.Dynamics</span><span class="PUNC">===</span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="NAME">Box2D.Dynamics</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">Box2D.Dynamics.Contacts</span><span class="PUNC">===</span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="NAME">Box2D.Dynamics.Contacts</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">Box2D.Dynamics.Controllers</span><span class="PUNC">===</span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="NAME">Box2D.Dynamics.Controllers</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">Box2D.Dynamics.Joints</span><span class="PUNC">===</span><span class="STRN">"undefined"</span><span class="PUNC">)</span><span class="NAME">Box2D.Dynamics.Joints</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  5</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">F.b2AABB.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">G.b2Bound.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">K.b2BoundValues.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">K</span><span class="PUNC">&&</span><span class="NAME">this.b2BoundValues.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">y.b2Collision.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">w.b2ContactID.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">w</span><span class="PUNC">&&</span><span class="NAME">this.b2ContactID.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.b2ContactPoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">U.b2Distance.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">p.b2DistanceInput.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>  6</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">B.b2DistanceOutput.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Q.b2DistanceProxy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">V.b2DynamicTree.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">V</span><span class="PUNC">&&</span><span class="NAME">this.b2DynamicTree.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">M</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">M.b2DynamicTreeBroadPhase.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">L.b2DynamicTreeNode.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">I</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">I.b2DynamicTreePair.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">W</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">W.b2Manifold.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">W</span><span class="PUNC">&&</span><span class="NAME">this.b2Manifold.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>  7</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Y</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Y.b2ManifoldPoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">Y</span><span class="PUNC">&&</span><span class="NAME">this.b2ManifoldPoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k.b2Point.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">z.b2RayCastInput.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">z</span><span class="PUNC">&&</span><span class="NAME">this.b2RayCastInput.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">u.b2RayCastOutput.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">D.b2Segment.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">H.b2SeparationFunction.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">O</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">O.b2Simplex.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>  8</span> </span><span class="NAME">O</span><span class="PUNC">&&</span><span class="NAME">this.b2Simplex.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">E</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E.b2SimplexCache.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">R</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">R.b2SimplexVertex.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">N.b2TimeOfImpact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">S.b2TOIInput.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">aa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">aa.b2WorldManifold.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">aa</span><span class="PUNC">&&</span><span class="NAME">this.b2WorldManifold.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Z</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Z.ClipVertex.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d.Features.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">h.b2CircleShape.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  9</span> </span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">this.b2CircleShape.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">l.b2EdgeChainDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">&&</span><span class="NAME">this.b2EdgeChainDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j.b2EdgeShape.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">j</span><span class="PUNC">&&</span><span class="NAME">this.b2EdgeShape.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">o.b2MassData.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">q.b2PolygonShape.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">q</span><span class="PUNC">&&</span><span class="NAME">this.b2PolygonShape.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n.b2Shape.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'> 10</span> </span><span class="NAME">n</span><span class="PUNC">&&</span><span class="NAME">this.b2Shape.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.b2Color.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.b2Color.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.b2Settings.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g.b2Mat22.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="NAME">this.b2Mat22.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.b2Mat33.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.b2Mat33.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.b2Math.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f.b2Sweep.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m.b2Transform.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 11</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">m</span><span class="PUNC">&&</span><span class="NAME">this.b2Transform.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">r.b2Vec2.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">r</span><span class="PUNC">&&</span><span class="NAME">this.b2Vec2.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s.b2Vec3.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">s</span><span class="PUNC">&&</span><span class="NAME">this.b2Vec3.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">v.b2Body.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">v</span><span class="PUNC">&&</span><span class="NAME">this.b2Body.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">t.b2BodyDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">t</span><span class="PUNC">&&</span><span class="NAME">this.b2BodyDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">x.b2ContactFilter.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 12</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C.b2ContactImpulse.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">J</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">J.b2ContactListener.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">T</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">T.b2ContactManager.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">T</span><span class="PUNC">&&</span><span class="NAME">this.b2ContactManager.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">P</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">P.b2DebugDraw.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">P</span><span class="PUNC">&&</span><span class="NAME">this.b2DebugDraw.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">X</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">X.b2DestructionListener.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">$.b2FilterData.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ba</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ba.b2Fixture.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 13</span> </span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">ba</span><span class="PUNC">&&</span><span class="NAME">this.b2Fixture.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ca</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ca.b2FixtureDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">ca</span><span class="PUNC">&&</span><span class="NAME">this.b2FixtureDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">da</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">da.b2Island.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">da</span><span class="PUNC">&&</span><span class="NAME">this.b2Island.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Fa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Fa.b2TimeStep.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ea</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ea.b2World.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">ea</span><span class="PUNC">&&</span><span class="NAME">this.b2World.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Ga</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ga.b2CircleContact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">fa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">fa.b2Contact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 14</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">fa</span><span class="PUNC">&&</span><span class="NAME">this.b2Contact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ga</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ga.b2ContactConstraint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">ga</span><span class="PUNC">&&</span><span class="NAME">this.b2ContactConstraint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Ha</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ha.b2ContactConstraintPoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Ia</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ia.b2ContactEdge.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ha</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ha.b2ContactFactory.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">ha</span><span class="PUNC">&&</span><span class="NAME">this.b2ContactFactory.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Ja</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ja.b2ContactRegister.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Ka</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ka.b2ContactResult.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 15</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ia</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ia.b2ContactSolver.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">ia</span><span class="PUNC">&&</span><span class="NAME">this.b2ContactSolver.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">La</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">La.b2EdgeAndCircleContact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ja</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ja.b2NullContact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">ja</span><span class="PUNC">&&</span><span class="NAME">this.b2NullContact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Ma</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ma.b2PolyAndCircleContact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Na</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Na.b2PolyAndEdgeContact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Oa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Oa.b2PolygonContact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ka</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ka.b2PositionSolverManifold.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 16</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">ka</span><span class="PUNC">&&</span><span class="NAME">this.b2PositionSolverManifold.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Pa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Pa.b2BuoyancyController.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Qa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Qa.b2ConstantAccelController.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Ra</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ra.b2ConstantForceController.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Sa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Sa.b2Controller.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Ta</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ta.b2ControllerEdge.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Ua</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ua.b2GravityController.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Va</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Va.b2TensorDampingController.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 17</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">la</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">la.b2DistanceJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">la</span><span class="PUNC">&&</span><span class="NAME">this.b2DistanceJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ma</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ma.b2DistanceJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">ma</span><span class="PUNC">&&</span><span class="NAME">this.b2DistanceJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">na</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">na.b2FrictionJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">na</span><span class="PUNC">&&</span><span class="NAME">this.b2FrictionJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">oa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">oa.b2FrictionJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">oa</span><span class="PUNC">&&</span><span class="NAME">this.b2FrictionJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">pa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">pa.b2GearJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 18</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">pa</span><span class="PUNC">&&</span><span class="NAME">this.b2GearJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">qa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">qa.b2GearJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">qa</span><span class="PUNC">&&</span><span class="NAME">this.b2GearJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Wa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Wa.b2Jacobian.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ra</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ra.b2Joint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">ra</span><span class="PUNC">&&</span><span class="NAME">this.b2Joint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">sa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">sa.b2JointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">sa</span><span class="PUNC">&&</span><span class="NAME">this.b2JointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Xa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Xa.b2JointEdge.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 19</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ta</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ta.b2LineJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">ta</span><span class="PUNC">&&</span><span class="NAME">this.b2LineJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ua</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ua.b2LineJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">ua</span><span class="PUNC">&&</span><span class="NAME">this.b2LineJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">va</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">va.b2MouseJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">va</span><span class="PUNC">&&</span><span class="NAME">this.b2MouseJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">wa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">wa.b2MouseJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">wa</span><span class="PUNC">&&</span><span class="NAME">this.b2MouseJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">xa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">xa.b2PrismaticJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 20</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">xa</span><span class="PUNC">&&</span><span class="NAME">this.b2PrismaticJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">ya</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ya.b2PrismaticJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">ya</span><span class="PUNC">&&</span><span class="NAME">this.b2PrismaticJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">za</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">za.b2PulleyJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">za</span><span class="PUNC">&&</span><span class="NAME">this.b2PulleyJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Aa</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Aa.b2PulleyJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">Aa</span><span class="PUNC">&&</span><span class="NAME">this.b2PulleyJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Ba</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ba.b2RevoluteJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 21</span> </span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">Ba</span><span class="PUNC">&&</span><span class="NAME">this.b2RevoluteJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Ca</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ca.b2RevoluteJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">Ca</span><span class="PUNC">&&</span><span class="NAME">this.b2RevoluteJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Da</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Da.b2WeldJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">Da</span><span class="PUNC">&&</span><span class="NAME">this.b2WeldJoint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Ea</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ea.b2WeldJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constructor</span><span class="PUNC">===</span><span class="NAME">Ea</span><span class="PUNC">&&</span><span class="NAME">this.b2WeldJointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">Box2D.Collision.IBroadPhase</span><span class="PUNC">=</span><span class="STRN">"Box2D.Collision.IBroadPhase"</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2AABB</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 22</span> </span><span class="NAME">F</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Bound</span><span class="PUNC">=</span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2BoundValues</span><span class="PUNC">=</span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2ContactID</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2ContactPoint</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Distance</span><span class="PUNC">=</span><span class="NAME">U</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2DistanceInput</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2DistanceOutput</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2DistanceProxy</span><span class="PUNC">=</span><span class="NAME">Q</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2DynamicTree</span><span class="PUNC">=</span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2DynamicTreeBroadPhase</span><span class="PUNC">=</span><span class="NAME">M</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2DynamicTreeNode</span><span class="PUNC">=</span><span class="NAME">L</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2DynamicTreePair</span><span class="PUNC">=</span><span class="NAME">I</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Manifold</span><span class="PUNC">=</span><span class="NAME">W</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2ManifoldPoint</span><span class="PUNC">=</span><span class="NAME">Y</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Point</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 23</span> </span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2RayCastInput</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2RayCastOutput</span><span class="PUNC">=</span><span class="NAME">u</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Segment</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2SeparationFunction</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Simplex</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2SimplexCache</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2SimplexVertex</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2TimeOfImpact</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2TOIInput</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2WorldManifold</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.ClipVertex</span><span class="PUNC">=</span><span class="NAME">Z</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Features</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Shapes.b2CircleShape</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Shapes.b2EdgeChainDef</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Shapes.b2EdgeShape</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Shapes.b2MassData</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 24</span> </span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Shapes.b2PolygonShape</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Shapes.b2Shape</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2internal</span><span class="PUNC">=</span><span class="STRN">"Box2D.Common.b2internal"</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Color</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.Math.b2Mat22</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.Math.b2Mat33</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.Math.b2Math</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.Math.b2Sweep</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.Math.b2Transform</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.Math.b2Vec2</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.Math.b2Vec3</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2Body</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2BodyDef</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2ContactFilter</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2ContactImpulse</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2ContactListener</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 25</span> </span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2ContactManager</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2DebugDraw</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2DestructionListener</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2FilterData</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2Fixture</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2FixtureDef</span><span class="PUNC">=</span><span class="NAME">ca</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2Island</span><span class="PUNC">=</span><span class="NAME">da</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2TimeStep</span><span class="PUNC">=</span><span class="NAME">Fa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2World</span><span class="PUNC">=</span><span class="NAME">ea</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2CircleContact</span><span class="PUNC">=</span><span class="NAME">Ga</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact</span><span class="PUNC">=</span><span class="NAME">fa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactConstraint</span><span class="PUNC">=</span><span class="NAME">ga</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactConstraintPoint</span><span class="PUNC">=</span><span class="NAME">Ha</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactEdge</span><span class="PUNC">=</span><span class="NAME">Ia</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactFactory</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 26</span> </span><span class="NAME">ha</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactRegister</span><span class="PUNC">=</span><span class="NAME">Ja</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactResult</span><span class="PUNC">=</span><span class="NAME">Ka</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactSolver</span><span class="PUNC">=</span><span class="NAME">ia</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2EdgeAndCircleContact</span><span class="PUNC">=</span><span class="NAME">La</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2NullContact</span><span class="PUNC">=</span><span class="NAME">ja</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2PolyAndCircleContact</span><span class="PUNC">=</span><span class="NAME">Ma</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2PolyAndEdgeContact</span><span class="PUNC">=</span><span class="NAME">Na</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2PolygonContact</span><span class="PUNC">=</span><span class="NAME">Oa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2PositionSolverManifold</span><span class="PUNC">=</span><span class="NAME">ka</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Controllers.b2BuoyancyController</span><span class="PUNC">=</span><span class="NAME">Pa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Controllers.b2ConstantAccelController</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 27</span> </span><span class="NAME">Qa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Controllers.b2ConstantForceController</span><span class="PUNC">=</span><span class="NAME">Ra</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller</span><span class="PUNC">=</span><span class="NAME">Sa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Controllers.b2ControllerEdge</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Controllers.b2GravityController</span><span class="PUNC">=</span><span class="NAME">Ua</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Controllers.b2TensorDampingController</span><span class="PUNC">=</span><span class="NAME">Va</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2DistanceJoint</span><span class="PUNC">=</span><span class="NAME">la</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2DistanceJointDef</span><span class="PUNC">=</span><span class="NAME">ma</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2FrictionJoint</span><span class="PUNC">=</span><span class="NAME">na</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2FrictionJointDef</span><span class="PUNC">=</span><span class="NAME">oa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2GearJoint</span><span class="PUNC">=</span><span class="NAME">pa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2GearJointDef</span><span class="PUNC">=</span><span class="NAME">qa</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 28</span> </span><span class="NAME">Box2D.Dynamics.Joints.b2Jacobian</span><span class="PUNC">=</span><span class="NAME">Wa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint</span><span class="PUNC">=</span><span class="NAME">ra</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef</span><span class="PUNC">=</span><span class="NAME">sa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2JointEdge</span><span class="PUNC">=</span><span class="NAME">Xa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2LineJoint</span><span class="PUNC">=</span><span class="NAME">ta</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2LineJointDef</span><span class="PUNC">=</span><span class="NAME">ua</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2MouseJoint</span><span class="PUNC">=</span><span class="NAME">va</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2MouseJointDef</span><span class="PUNC">=</span><span class="NAME">wa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2PrismaticJoint</span><span class="PUNC">=</span><span class="NAME">xa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2PrismaticJointDef</span><span class="PUNC">=</span><span class="NAME">ya</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2PulleyJoint</span><span class="PUNC">=</span><span class="NAME">za</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2PulleyJointDef</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2RevoluteJoint</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 29</span> </span><span class="NAME">Ba</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2RevoluteJointDef</span><span class="PUNC">=</span><span class="NAME">Ca</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2WeldJoint</span><span class="PUNC">=</span><span class="NAME">Da</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2WeldJointDef</span><span class="PUNC">=</span><span class="NAME">Ea</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 30</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2CircleShape</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2PolygonShape</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2Shape</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.b2Settings</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Math</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Sweep</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Transform</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Vec2</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2AABB</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2Bound</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2BoundValues</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2Collision</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2ContactID</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2ContactPoint</span><span class="PUNC">,</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2Distance</span><span class="PUNC">,</span><span class="NAME">Y</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2DistanceInput</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 31</span> </span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2DistanceOutput</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2DistanceProxy</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2DynamicTree</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2DynamicTreeBroadPhase</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2DynamicTreeNode</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2DynamicTreePair</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2Manifold</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2ManifoldPoint</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2Point</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2RayCastInput</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2RayCastOutput</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2Segment</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2SeparationFunction</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2Simplex</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2SimplexCache</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 32</span> </span><span class="NAME">Box2D.Collision.b2SimplexVertex</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2TimeOfImpact</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2TOIInput</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2WorldManifold</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.ClipVertex</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Features</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.IBroadPhase</span><span class="PUNC">;</span><span class="NAME">B.b2AABB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.lowerBound</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.upperBound</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.IsValid</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.upperBound.y</span><span class="PUNC">-</span><span class="NAME">this.lowerBound.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.upperBound.x</span><span class="PUNC">-</span><span class="NAME">this.lowerBound.x</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.lowerBound.IsValid</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.upperBound.IsValid</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.GetCenter</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.lowerBound.x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'> 33</span> </span><span class="NAME">this.upperBound.x</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">this.lowerBound.y</span><span class="PUNC">+</span><span class="NAME">this.upperBound.y</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.GetExtents</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.upperBound.x</span><span class="PUNC">-</span><span class="NAME">this.lowerBound.x</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">this.upperBound.y</span><span class="PUNC">-</span><span class="NAME">this.lowerBound.y</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.Contains</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">this.lowerBound.x</span><span class="PUNC">&lt;=</span><span class="NAME">b.lowerBound.x</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.lowerBound.y</span><span class="PUNC">&lt;=</span><span class="NAME">b.lowerBound.y</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">b.upperBound.x</span><span class="PUNC">&lt;=</span><span class="NAME">this.upperBound.x</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">b.upperBound.y</span><span class="PUNC">&lt;=</span><span class="NAME">this.upperBound.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.RayCast</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">e.p1.x</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">e.p1.y</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">e.p2.x</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'> 34</span> </span><span class="NAME">e.p1.x</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">e.p2.y</span><span class="PUNC">-</span><span class="NAME">e.p1.y</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">b.normal</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">&lt;</span><span class="NAME">this.lowerBound.x</span><span class="PUNC">||</span><span class="NAME">this.upperBound.x</span><span class="PUNC">&lt;</span><span class="NAME">r</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.lowerBound.x</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.upperBound.x</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">T</span><span class="PUNC">></span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">T</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C.x</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">;</span><span class="NAME">C.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">}</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">></span><span class="NAME">m</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">&lt;</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">&lt;</span><span class="NAME">this.lowerBound.y</span><span class="PUNC">||</span><span class="NAME">this.upperBound.y</span><span class="PUNC">&lt;</span><span class="NAME">s</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.lowerBound.y</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.upperBound.y</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">T</span><span class="PUNC">></span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">T</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C.y</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">;</span><span class="NAME">C.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 35</span> </span><span class="NAME">T</span><span class="PUNC">}</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">></span><span class="NAME">m</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="NAME">b.fraction</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.TestOverlap</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.lowerBound.y</span><span class="PUNC">-</span><span class="NAME">this.upperBound.y</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.lowerBound.y</span><span class="PUNC">-</span><span class="NAME">b.upperBound.y</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.lowerBound.x</span><span class="PUNC">-</span><span class="NAME">this.upperBound.x</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">||</span><span class="NAME">e</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.lowerBound.x</span><span class="PUNC">-</span><span class="NAME">b.upperBound.x</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">||</span><span class="NAME">f</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.Combine</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">f.Combine</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.Combine</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.lowerBound.x</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">b.lowerBound.x</span><span class="PUNC">,</span><span class="NAME">e.lowerBound.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lowerBound.y</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">b.lowerBound.y</span><span class="PUNC">,</span><span class="NAME">e.lowerBound.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 36</span> </span><span class="NAME">this.upperBound.x</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">b.upperBound.x</span><span class="PUNC">,</span><span class="NAME">e.upperBound.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.upperBound.y</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">b.upperBound.y</span><span class="PUNC">,</span><span class="NAME">e.upperBound.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Q.b2Bound</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Q.prototype.IsLower</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.value</span><span class="PUNC">&</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Q.prototype.IsUpper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.value</span><span class="PUNC">&</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Q.prototype.Swap</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.value</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.proxy</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.stabbingCount</span><span class="PUNC">;</span><span class="NAME">this.value</span><span class="PUNC">=</span><span class="NAME">b.value</span><span class="PUNC">;</span><span class="NAME">this.proxy</span><span class="PUNC">=</span><span class="NAME">b.proxy</span><span class="PUNC">;</span><span class="NAME">this.stabbingCount</span><span class="PUNC">=</span><span class="NAME">b.stabbingCount</span><span class="PUNC">;</span><span class="NAME">b.value</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">b.proxy</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">b.stabbingCount</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.b2BoundValues</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.prototype.b2BoundValues</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.lowerValues</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 37</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector_a2j_Number</span><span class="PUNC">;</span><span class="NAME">this.lowerValues</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.lowerValues</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.upperValues</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector_a2j_Number</span><span class="PUNC">;</span><span class="NAME">this.upperValues</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.upperValues</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">M.b2Collision</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">M.ClipSegmentToLine</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">r.v</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">r.v</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">f.x</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">f.y</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">f.x</span><span class="PUNC">*</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">f.y</span><span class="PUNC">*</span><span class="NAME">t.y</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">r.v</span><span class="PUNC">;</span><span class="NAME">r.x</span><span class="PUNC">=</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t.x</span><span class="PUNC">-</span><span class="NAME">v.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.y</span><span class="PUNC">=</span><span class="NAME">v.y</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t.y</span><span class="PUNC">-</span><span class="NAME">v.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">r.id</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">id</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">s</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">M.EdgeSeparation</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 38</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">b.m_vertexCount</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">b.m_vertices</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.m_normals</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">m.m_vertexCount</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">m.m_vertices</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">e.R</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">C.x</span><span class="PUNC">+</span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">C.y</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="NAME">C.x</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">C.y</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">r.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">T</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">X</span><span class="PUNC">&lt;</span><span class="NAME">v</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">X</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">X</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">C.x</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">+</span><span class="NAME">C.y</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">&lt;</span><span class="NAME">P</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">e.R</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">C.x</span><span class="PUNC">+</span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">C.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="NAME">C.x</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">C.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">T</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">r.R</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">r.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">C.x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'> 39</span> </span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">C.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">r.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="NAME">C.x</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">C.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">M.FindMaxSeparation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">e.m_vertexCount</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">e.m_normals</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">r.R</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">m.m_centroid</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">r.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">t.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">r.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">t.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">f.R</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">e.m_centroid</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">f.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">t.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">f.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">t.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">f.R.col1.x</span><span class="PUNC">+</span><span class="NAME">J</span><span class="PUNC">*</span><span class="NAME">f.R.col1.y</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">f.R.col2.x</span><span class="PUNC">+</span><span class="NAME">J</span><span class="PUNC">*</span><span class="NAME">f.R.col2.y</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">T</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">&lt;</span><span class="NAME">s</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">P</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NAME">P</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 40</span> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">t.x</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">t.y</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">></span><span class="NAME">T</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">M.EdgeSeparation</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">M.EdgeSeparation</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">s</span><span class="PUNC">?</span><span class="NAME">C</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">M.EdgeSeparation</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">$</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">></span><span class="NAME">v</span><span class="PUNC">&&</span><span class="NAME">x</span><span class="PUNC">></span><span class="NAME">T</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">$</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">T</span><span class="PUNC">></span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">$</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">==</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NAME">P</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NAME">P</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">P</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">s</span><span class="PUNC">?</span><span class="NAME">P</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">M.EdgeSeparation</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">></span><span class="NAME">X</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">X</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">M.FindIncidentEdge</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">e.m_vertexCount</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">e.m_normals</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">r.m_vertexCount</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 41</span> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">r.m_vertices</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">r.m_normals</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">f.R</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">f.y</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">f.y</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">s.R</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">&lt;</span><span class="NAME">t</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">T</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NAME">T</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">f.y</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">t</span><span class="PUNC">?</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">s.R</span><span class="PUNC">;</span><span class="NAME">t.v.x</span><span class="PUNC">=</span><span class="NAME">s.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.v.y</span><span class="PUNC">=</span><span class="NAME">s.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.id.features.referenceEdge</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">t.id.features.incidentEdge</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">t.id.features.incidentVertex</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">v</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 42</span> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">s.R</span><span class="PUNC">;</span><span class="NAME">t.v.x</span><span class="PUNC">=</span><span class="NAME">s.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.v.y</span><span class="PUNC">=</span><span class="NAME">s.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.id.features.referenceEdge</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">t.id.features.incidentEdge</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">t.id.features.incidentVertex</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">M.MakeClipPointVector</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">M.CollidePolygons</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">b.m_pointCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">e.m_radius</span><span class="PUNC">+</span><span class="NAME">m.m_radius</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">M.s_edgeAO</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">M.FindMaxSeparation</span><span class="PUNC">(</span><span class="NAME">M.s_edgeAO</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">M.s_edgeAO</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">></span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">M.s_edgeBO</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">M.FindMaxSeparation</span><span class="PUNC">(</span><span class="NAME">M.s_edgeBO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 43</span> </span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">M.s_edgeBO</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">></span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">J</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">></span><span class="NUMB">0.98</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NUMB">0.0010</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">b.m_type</span><span class="PUNC">=</span><span class="NAME">E.e_faceB</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">b.m_type</span><span class="PUNC">=</span><span class="NAME">E.e_faceA</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">M.s_incidentEdge</span><span class="PUNC">;</span><span class="NAME">M.FindIncidentEdge</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">t.m_vertexCount</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">t.m_vertices</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NAME">J</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">P</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">x</span><span class="PUNC">?</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">M.s_localTangent</span><span class="PUNC">;</span><span class="NAME">J.Set</span><span class="PUNC">(</span><span class="NAME">P.x</span><span class="PUNC">-</span><span class="NAME">t.x</span><span class="PUNC">,</span><span class="NAME">P.y</span><span class="PUNC">-</span><span class="NAME">t.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">J.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">M.s_localNormal</span><span class="PUNC">;</span><span class="NAME">r.x</span><span class="PUNC">=</span><span class="NAME">J.y</span><span class="PUNC">;</span><span class="NAME">r.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">J.x</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">M.s_planePoint</span><span class="PUNC">;</span><span class="NAME">m.Set</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">P.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t.y</span><span class="PUNC">+</span><span class="NAME">P.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">M.s_tangent</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">e.R</span><span class="PUNC">;</span><span class="NAME">C.x</span><span class="PUNC">=</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">J.x</span><span class="PUNC">+</span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">J.y</span><span class="PUNC">;</span><span class="NAME">C.y</span><span class="PUNC">=</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 44</span> </span><span class="NAME">J.x</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">J.y</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">M.s_tangent2</span><span class="PUNC">;</span><span class="NAME">X.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">C.x</span><span class="PUNC">;</span><span class="NAME">X.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">C.y</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">M.s_normal</span><span class="PUNC">;</span><span class="NAME">J.x</span><span class="PUNC">=</span><span class="NAME">C.y</span><span class="PUNC">;</span><span class="NAME">J.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">C.x</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">=</span><span class="NAME">M.s_v11</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">M.s_v12</span><span class="PUNC">;</span><span class="NAME">$.x</span><span class="PUNC">=</span><span class="NAME">e.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">t.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">$.y</span><span class="PUNC">=</span><span class="NAME">e.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">t.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">ba.x</span><span class="PUNC">=</span><span class="NAME">e.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">P.x</span><span class="PUNC">+</span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">P.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">ba.y</span><span class="PUNC">=</span><span class="NAME">e.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="NAME">P.x</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">P.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">J.x</span><span class="PUNC">*</span><span class="NAME">$.x</span><span class="PUNC">+</span><span class="NAME">J.y</span><span class="PUNC">*</span><span class="NAME">$.y</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">C.x</span><span class="PUNC">*</span><span class="NAME">ba.x</span><span class="PUNC">+</span><span class="NAME">C.y</span><span class="PUNC">*</span><span class="NAME">ba.y</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">M.s_clipPoints1</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">M.s_clipPoints2</span><span class="PUNC">;</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">M.ClipSegmentToLine</span><span class="PUNC">(</span><span class="NAME">P</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">C.x</span><span class="PUNC">*</span><span class="NAME">$.x</span><span class="PUNC">-</span><span class="NAME">C.y</span><span class="PUNC">*</span><span class="NAME">$.y</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">ba</span><span class="PUNC">&lt;</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">M.ClipSegmentToLine</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">ba</span><span class="PUNC">&lt;</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.m_localPlaneNormal.SetV</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 45</span> </span><span class="NAME">b.m_localPoint.SetV</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">y.b2_maxManifoldPoints</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">J.x</span><span class="PUNC">*</span><span class="NAME">s.v.x</span><span class="PUNC">+</span><span class="NAME">J.y</span><span class="PUNC">*</span><span class="NAME">s.v.y</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">&lt;=</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">b.m_points</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">f.R</span><span class="PUNC">;</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">s.v.x</span><span class="PUNC">-</span><span class="NAME">f.position.x</span><span class="PUNC">;</span><span class="NAME">$</span><span class="PUNC">=</span><span class="NAME">s.v.y</span><span class="PUNC">-</span><span class="NAME">f.position.y</span><span class="PUNC">;</span><span class="NAME">C.m_localPoint.x</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">*</span><span class="NAME">x.col1.x</span><span class="PUNC">+</span><span class="NAME">$</span><span class="PUNC">*</span><span class="NAME">x.col1.y</span><span class="PUNC">;</span><span class="NAME">C.m_localPoint.y</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">*</span><span class="NAME">x.col2.x</span><span class="PUNC">+</span><span class="NAME">$</span><span class="PUNC">*</span><span class="NAME">x.col2.y</span><span class="PUNC">;</span><span class="NAME">C.m_id.Set</span><span class="PUNC">(</span><span class="NAME">s.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.m_id.features.flip</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">r</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">b.m_pointCount</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">M.CollideCircles</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.m_pointCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">f.R</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">e.m_p</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">f.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">s.col1.x</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">s.col2.x</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">s.col1.y</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">s.col2.y</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">r.R</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">m.m_p</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">r.position.x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'> 46</span> </span><span class="PUNC">(</span><span class="NAME">s.col1.x</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">s.col2.x</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">r.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">s.col1.y</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">s.col2.y</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">e.m_radius</span><span class="PUNC">+</span><span class="NAME">m.m_radius</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">></span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.m_type</span><span class="PUNC">=</span><span class="NAME">E.e_circles</span><span class="PUNC">;</span><span class="NAME">b.m_localPoint.SetV</span><span class="PUNC">(</span><span class="NAME">e.m_p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.m_localPlaneNormal.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.m_pointCount</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">b.m_points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">m_localPoint.SetV</span><span class="PUNC">(</span><span class="NAME">m.m_p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.m_points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">m_id.key</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">M.CollidePolygonAndCircle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">b.m_pointCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">r.R</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">m.m_p</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">r.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.y</span><span class="PUNC">*</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">x.col2.y</span><span class="PUNC">*</span><span class="NAME">t.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">r.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x.col1.x</span><span class="PUNC">*</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">x.col2.x</span><span class="PUNC">*</span><span class="NAME">t.y</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">f.position.x</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">f.position.y</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">f.R</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 47</span> </span><span class="NAME">x.col1.x</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">x.col1.y</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">x.col2.x</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">x.col2.y</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">J</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">e.m_radius</span><span class="PUNC">+</span><span class="NAME">m.m_radius</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">e.m_vertexCount</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">e.m_vertices</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.m_normals</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">X</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">X</span><span class="PUNC">&lt;</span><span class="NAME">T</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">X</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">X</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">t.x</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">t.y</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">X</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">t.x</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">t.y</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">></span><span class="NAME">r</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">></span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">T</span><span class="PUNC">?</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">v</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">&lt;</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.m_pointCount</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">b.m_type</span><span class="PUNC">=</span><span class="NAME">E.e_faceA</span><span class="PUNC">;</span><span class="NAME">b.m_localPlaneNormal.SetV</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">J</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.m_localPoint.x</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">P.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.m_localPoint.y</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t.y</span><span class="PUNC">+</span><span class="NAME">P.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">C</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">P.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t.x</span><span class="PUNC">-</span><span class="NAME">P.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">P.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t.y</span><span class="PUNC">-</span><span class="NAME">P.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 48</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">t.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">P.x</span><span class="PUNC">-</span><span class="NAME">t.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">t.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">P.y</span><span class="PUNC">-</span><span class="NAME">t.y</span><span class="PUNC">)</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">t.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">t.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">t.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">t.y</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="NAME">b.m_pointCount</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">b.m_type</span><span class="PUNC">=</span><span class="NAME">E.e_faceA</span><span class="PUNC">;</span><span class="NAME">b.m_localPlaneNormal.x</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">t.x</span><span class="PUNC">;</span><span class="NAME">b.m_localPlaneNormal.y</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">t.y</span><span class="PUNC">;</span><span class="NAME">b.m_localPlaneNormal.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.m_localPoint.SetV</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">P.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">P.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">P.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">P.y</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="NAME">b.m_pointCount</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">b.m_type</span><span class="PUNC">=</span><span class="NAME">E.e_faceA</span><span class="PUNC">;</span><span class="NAME">b.m_localPlaneNormal.x</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">P.x</span><span class="PUNC">;</span><span class="NAME">b.m_localPlaneNormal.y</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">P.y</span><span class="PUNC">;</span><span class="NAME">b.m_localPlaneNormal.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.m_localPoint.SetV</span><span class="PUNC">(</span><span class="NAME">P</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">P.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t.y</span><span class="PUNC">+</span><span class="NAME">P.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'> 49</span> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">></span><span class="NAME">r</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="NAME">b.m_pointCount</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">b.m_type</span><span class="PUNC">=</span><span class="NAME">E.e_faceA</span><span class="PUNC">;</span><span class="NAME">b.m_localPlaneNormal.x</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">b.m_localPlaneNormal.y</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">;</span><span class="NAME">b.m_localPlaneNormal.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.m_localPoint.Set</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">b.m_points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">m_localPoint.SetV</span><span class="PUNC">(</span><span class="NAME">m.m_p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.m_points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">m_id.key</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">M.TestOverlap</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.lowerBound</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">b.upperBound</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">f.x</span><span class="PUNC">-</span><span class="NAME">m.x</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">f.y</span><span class="PUNC">-</span><span class="NAME">m.y</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.lowerBound</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e.upperBound</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">f.y</span><span class="PUNC">-</span><span class="NAME">m.y</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">||</span><span class="NAME">s</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">-</span><span class="NAME">m.x</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">||</span><span class="NAME">v</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Collision.b2Collision.s_incidentEdge</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 50</span> </span><span class="NAME">M.MakeClipPointVector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.s_clipPoints1</span><span class="PUNC">=</span><span class="NAME">M.MakeClipPointVector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.s_clipPoints2</span><span class="PUNC">=</span><span class="NAME">M.MakeClipPointVector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.s_edgeAO</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector_a2j_Number</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.s_edgeBO</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector_a2j_Number</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.s_localTangent</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.s_localNormal</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.s_planePoint</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.s_normal</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.s_tangent</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 51</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.s_tangent2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.s_v11</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.s_v12</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.b2CollidePolyTempVec</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Collision.b2_nullFeature</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">L.b2ContactID</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.features</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.prototype.b2ContactID</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.features._m_id</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.key</span><span class="PUNC">=</span><span class="NAME">b._key</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.prototype.Copy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">;</span><span class="NAME">b.key</span><span class="PUNC">=</span><span class="NAME">this.key</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">L.prototype</span><span class="PUNC">,</span><span class="STRN">"key"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 52</span> </span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">get</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._key</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">L.prototype</span><span class="PUNC">,</span><span class="STRN">"key"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._key</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.features._referenceEdge</span><span class="PUNC">=</span><span class="NAME">this._key</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">;</span><span class="NAME">this.features._incidentEdge</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this._key</span><span class="PUNC">&</span><span class="NUMB">65280</span><span class="PUNC">)</span><span class="PUNC">>></span><span class="NUMB">8</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">;</span><span class="NAME">this.features._incidentVertex</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this._key</span><span class="PUNC">&</span><span class="NUMB">16711680</span><span class="PUNC">)</span><span class="PUNC">>></span><span class="NUMB">16</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">;</span><span class="NAME">this.features._flip</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this._key</span><span class="PUNC">&</span><span class="NUMB">4278190080</span><span class="PUNC">)</span><span class="PUNC">>></span><span class="NUMB">24</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">I.b2ContactPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.position</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.velocity</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.normal</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">W.b2Distance</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 53</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">W.Distance</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">++</span><span class="NAME">W.b2_gjkCalls</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">f.proxyA</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">f.proxyB</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">f.transformA</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">f.transformB</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">W.s_simplex</span><span class="PUNC">;</span><span class="NAME">t.ReadCache</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">t.m_vertices</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">W.s_saveA</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">W.s_saveB</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">t.GetClosestPoint</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">LengthSquared</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">P</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">,</span><span class="NAME">$</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">$</span><span class="PUNC">&lt;</span><span class="NUMB">20</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">t.m_count</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">&lt;</span><span class="NAME">T</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">P</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">P</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">indexA</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">[</span><span class="NAME">P</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">P</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">indexB</span><span class="PUNC">}</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">t.m_count</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">:</span><span class="NAME">t.Solve2</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">:</span><span class="NAME">t.Solve3</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t.m_count</span><span class="PUNC">==</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">t.GetClosestPoint</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">X.LengthSquared</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">t.GetSearchDirection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 54</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">P.LengthSquared</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">*</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">[</span><span class="NAME">t.m_count</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">X.indexA</span><span class="PUNC">=</span><span class="NAME">m.GetSupport</span><span class="PUNC">(</span><span class="NAME">w.MulTMV</span><span class="PUNC">(</span><span class="NAME">s.R</span><span class="PUNC">,</span><span class="NAME">P.GetNegative</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">X.wA</span><span class="PUNC">=</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">m.GetVertex</span><span class="PUNC">(</span><span class="NAME">X.indexA</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">X.indexB</span><span class="PUNC">=</span><span class="NAME">r.GetSupport</span><span class="PUNC">(</span><span class="NAME">w.MulTMV</span><span class="PUNC">(</span><span class="NAME">v.R</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">X.wB</span><span class="PUNC">=</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">r.GetVertex</span><span class="PUNC">(</span><span class="NAME">X.indexB</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">X.w</span><span class="PUNC">=</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">X.wB</span><span class="PUNC">,</span><span class="NAME">X.wA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">$</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">W.b2_gjkIters</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ba</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">&lt;</span><span class="NAME">T</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">X.indexA</span><span class="PUNC">==</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">P</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">X.indexB</span><span class="PUNC">==</span><span class="NAME">J</span><span class="PUNC">[</span><span class="NAME">P</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">ba</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">t.m_count</span><span class="PUNC">}</span><span class="NAME">W.b2_gjkMaxIters</span><span class="PUNC">=</span><span class="NAME">w.Max</span><span class="PUNC">(</span><span class="NAME">W.b2_gjkMaxIters</span><span class="PUNC">,</span><span class="NAME">$</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.GetWitnessPoints</span><span class="PUNC">(</span><span class="NAME">b.pointA</span><span class="PUNC">,</span><span class="NAME">b.pointB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.distance</span><span class="PUNC">=</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">b.pointA</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 55</span> </span><span class="NAME">b.pointB</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">Length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.iterations</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">;</span><span class="NAME">t.WriteCache</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f.useRadii</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">m.m_radius</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">r.m_radius</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.distance</span><span class="PUNC">></span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">&&</span><span class="NAME">b.distance</span><span class="PUNC">></span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.distance</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">b.pointB</span><span class="PUNC">,</span><span class="NAME">b.pointA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.pointA.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">f.x</span><span class="PUNC">;</span><span class="NAME">b.pointA.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">f.y</span><span class="PUNC">;</span><span class="NAME">b.pointB.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">f.x</span><span class="PUNC">;</span><span class="NAME">b.pointB.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">f.y</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">X</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">X.x</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b.pointA.x</span><span class="PUNC">+</span><span class="NAME">b.pointB.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">X.y</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b.pointA.y</span><span class="PUNC">+</span><span class="NAME">b.pointB.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.pointA.x</span><span class="PUNC">=</span><span class="NAME">b.pointB.x</span><span class="PUNC">=</span><span class="NAME">X.x</span><span class="PUNC">;</span><span class="NAME">b.pointA.y</span><span class="PUNC">=</span><span class="NAME">b.pointB.y</span><span class="PUNC">=</span><span class="NAME">X.y</span><span class="PUNC">;</span><span class="NAME">b.distance</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Collision.b2Distance.s_simplex</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Distance.s_saveA</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 56</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector_a2j_Number</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Distance.s_saveB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector_a2j_Number</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Y.b2DistanceInput</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.b2DistanceOutput</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.pointA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.pointB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">z.b2DistanceProxy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">z.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">b.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">K.e_circleShape</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b.m_p</span><span class="PUNC">;</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.m_radius</span><span class="PUNC">=</span><span class="NAME">b.m_radius</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">K.e_polygonShape</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">=</span><span class="NAME">b.m_vertices</span><span class="PUNC">;</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 57</span> </span><span class="NAME">b.m_vertexCount</span><span class="PUNC">;</span><span class="NAME">this.m_radius</span><span class="PUNC">=</span><span class="NAME">b.m_radius</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">z.prototype.GetSupport</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">this.m_count</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">z.prototype.GetSupportVertex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">this.m_count</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 58</span> </span><span class="NAME">z.prototype.GetVertexCount</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_count</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">z.prototype.GetVertex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.m_count</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.b2DynamicTree</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.b2DynamicTree</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_freeList</span><span class="PUNC">=</span><span class="NAME">this.m_root</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_insertionCount</span><span class="PUNC">=</span><span class="NAME">this.m_path</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.CreateProxy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.AllocateNode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">y.b2_aabbExtension</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">y.b2_aabbExtension</span><span class="PUNC">;</span><span class="NAME">f.aabb.lowerBound.x</span><span class="PUNC">=</span><span class="NAME">b.lowerBound.x</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">f.aabb.lowerBound.y</span><span class="PUNC">=</span><span class="NAME">b.lowerBound.y</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">f.aabb.upperBound.x</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 59</span> </span><span class="NAME">b.upperBound.x</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">f.aabb.upperBound.y</span><span class="PUNC">=</span><span class="NAME">b.upperBound.y</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">f.userData</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.InsertLeaf</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.DestroyProxy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.RemoveLeaf</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.FreeNode</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.MoveProxy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="NAME">b.IsLeaf</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.aabb.Contains</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.RemoveLeaf</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">y.b2_aabbExtension</span><span class="PUNC">+</span><span class="NAME">y.b2_aabbMultiplier</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NAME">f.x</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NAME">f.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">y.b2_aabbExtension</span><span class="PUNC">+</span><span class="NAME">y.b2_aabbMultiplier</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NAME">f.y</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.aabb.lowerBound.x</span><span class="PUNC">=</span><span class="NAME">e.lowerBound.x</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">b.aabb.lowerBound.y</span><span class="PUNC">=</span><span class="NAME">e.lowerBound.y</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">b.aabb.upperBound.x</span><span class="PUNC">=</span><span class="NAME">e.upperBound.x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'> 60</span> </span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">b.aabb.upperBound.y</span><span class="PUNC">=</span><span class="NAME">e.upperBound.y</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">this.InsertLeaf</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.Rebalance</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_root</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_root</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f.IsLeaf</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_path</span><span class="PUNC">>></span><span class="NAME">m</span><span class="PUNC">&</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NAME">f.child2</span><span class="PUNC">:</span><span class="NAME">f.child1</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">&</span><span class="NUMB">31</span><span class="PUNC">}</span><span class="PUNC">++</span><span class="NAME">this.m_path</span><span class="PUNC">;</span><span class="NAME">this.RemoveLeaf</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.InsertLeaf</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.GetFatAABB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b.aabb</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.GetUserData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b.userData</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.Query</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_root</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 61</span> </span><span class="NAME">this.m_root</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="PUNC">--</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r.aabb.TestOverlap</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r.IsLeaf</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">r.child1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">r.child2</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.RayCast</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_root</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.p1</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e.p2</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">w.CrossFV</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">w.AbsV</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">e.maxFraction</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m.x</span><span class="PUNC">-</span><span class="NAME">f.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">f.y</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m.y</span><span class="PUNC">-</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.lowerBound.x</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.lowerBound.y</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.upperBound.x</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.upperBound.y</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">J</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">[</span><span class="NAME">T</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.m_root</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">></span><span class="WHIT">
<span class='line'> 62</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">[</span><span class="PUNC">--</span><span class="NAME">T</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v.aabb.TestOverlap</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">v.aabb.GetCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">v.aabb.GetExtents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">r.x</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">-</span><span class="NAME">x.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">r.y</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="PUNC">-</span><span class="NAME">x.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">s.x</span><span class="PUNC">*</span><span class="NAME">C.x</span><span class="PUNC">-</span><span class="NAME">s.y</span><span class="PUNC">*</span><span class="NAME">C.y</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v.IsLeaf</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">;</span><span class="NAME">x.p1</span><span class="PUNC">=</span><span class="NAME">e.p1</span><span class="PUNC">;</span><span class="NAME">x.p2</span><span class="PUNC">=</span><span class="NAME">e.p2</span><span class="PUNC">;</span><span class="NAME">x.maxFraction</span><span class="PUNC">=</span><span class="NAME">e.maxFraction</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m.x</span><span class="PUNC">-</span><span class="NAME">f.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">f.y</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m.y</span><span class="PUNC">-</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.lowerBound.x</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.lowerBound.y</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.upperBound.x</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.upperBound.y</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">J</span><span class="PUNC">[</span><span class="NAME">T</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">v.child1</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">[</span><span class="NAME">T</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">v.child2</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.AllocateNode</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_freeList</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 63</span> </span><span class="NAME">this.m_freeList</span><span class="PUNC">;</span><span class="NAME">this.m_freeList</span><span class="PUNC">=</span><span class="NAME">b.parent</span><span class="PUNC">;</span><span class="NAME">b.parent</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">b.child1</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">b.child2</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.FreeNode</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.parent</span><span class="PUNC">=</span><span class="NAME">this.m_freeList</span><span class="PUNC">;</span><span class="NAME">this.m_freeList</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.InsertLeaf</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">++</span><span class="NAME">this.m_insertionCount</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_root</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_root</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_root.parent</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.aabb.GetCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_root</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f.IsLeaf</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">do</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">f.child1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f.child2</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">m.aabb.lowerBound.x</span><span class="PUNC">+</span><span class="NAME">m.aabb.upperBound.x</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">-</span><span class="NAME">e.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">m.aabb.lowerBound.y</span><span class="PUNC">+</span><span class="NAME">m.aabb.upperBound.y</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'> 64</span> </span><span class="NUMB">2</span><span class="PUNC">-</span><span class="NAME">e.y</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">f.aabb.lowerBound.x</span><span class="PUNC">+</span><span class="NAME">f.aabb.upperBound.x</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">-</span><span class="NAME">e.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">f.aabb.lowerBound.y</span><span class="PUNC">+</span><span class="NAME">f.aabb.upperBound.y</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">-</span><span class="NAME">e.y</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">m</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">}</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">f.IsLeaf</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">f.parent</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.AllocateNode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.parent</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">m.userData</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">m.aabb.Combine</span><span class="PUNC">(</span><span class="NAME">b.aabb</span><span class="PUNC">,</span><span class="NAME">f.aabb</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f.parent.child1</span><span class="PUNC">==</span><span class="NAME">f</span><span class="PUNC">)</span><span class="NAME">e.child1</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">e.child2</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">m.child1</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">m.child2</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">f.parent</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">b.parent</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="KEYW">do</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.aabb.Contains</span><span class="PUNC">(</span><span class="NAME">m.aabb</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="NAME">e.aabb.Combine</span><span class="PUNC">(</span><span class="NAME">e.child1.aabb</span><span class="PUNC">,</span><span class="NAME">e.child2.aabb</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.parent</span><span class="PUNC">}</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">m.child1</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">m.child2</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">f.parent</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">this.m_root</span><span class="PUNC">=</span><span class="NAME">b.parent</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 65</span> </span><span class="NAME">m</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.RemoveLeaf</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">==</span><span class="NAME">this.m_root</span><span class="PUNC">)</span><span class="NAME">this.m_root</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.parent</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.parent</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">e.child1</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">e.child2</span><span class="PUNC">:</span><span class="NAME">e.child1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f.child1</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">)</span><span class="NAME">f.child1</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.child2</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b.parent</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">this.FreeNode</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">f.aabb</span><span class="PUNC">;</span><span class="NAME">f.aabb</span><span class="PUNC">=</span><span class="NAME">B.Combine</span><span class="PUNC">(</span><span class="NAME">f.child1.aabb</span><span class="PUNC">,</span><span class="NAME">f.child2.aabb</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.Contains</span><span class="PUNC">(</span><span class="NAME">f.aabb</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f.parent</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_root</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b.parent</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.FreeNode</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.b2DynamicTreeBroadPhase</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_tree</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">;</span><span class="NAME">this.m_moveBuffer</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">;</span><span class="NAME">this.m_pairBuffer</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">;</span><span class="NAME">this.m_pairCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 66</span> </span><span class="NAME">D.prototype.CreateProxy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_tree.CreateProxy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">this.m_proxyCount</span><span class="PUNC">;</span><span class="NAME">this.BufferMove</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.DestroyProxy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.UnBufferMove</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">this.m_proxyCount</span><span class="PUNC">;</span><span class="NAME">this.m_tree.DestroyProxy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.MoveProxy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_tree.MoveProxy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.BufferMove</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.TestOverlap</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_tree.GetFatAABB</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.m_tree.GetFatAABB</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f.TestOverlap</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.GetUserData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_tree.GetUserData</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 67</span> </span><span class="NAME">D.prototype.GetFatAABB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_tree.GetFatAABB</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.GetProxyCount</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_proxyCount</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.UpdatePairs</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.m_pairCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">e.m_moveBuffer.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e.m_moveBuffer</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">e.m_tree.GetFatAABB</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.m_tree.Query</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">==</span><span class="NAME">m</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.m_pairCount</span><span class="PUNC">==</span><span class="NAME">e.m_pairBuffer.length</span><span class="PUNC">)</span><span class="NAME">e.m_pairBuffer</span><span class="PUNC">[</span><span class="NAME">e.m_pairCount</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">O</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">e.m_pairBuffer</span><span class="PUNC">[</span><span class="NAME">e.m_pairCount</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">x.proxyA</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">?</span><span class="NAME">t</span><span class="PUNC">:</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">x.proxyB</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">>=</span><span class="NAME">m</span><span class="PUNC">?</span><span class="NAME">t</span><span class="PUNC">:</span><span class="NAME">m</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e.m_pairCount</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 68</span> </span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.m_moveBuffer.length</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">e.m_pairCount</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">e.m_pairBuffer</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">e.m_tree.GetUserData</span><span class="PUNC">(</span><span class="NAME">r.proxyA</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">e.m_tree.GetUserData</span><span class="PUNC">(</span><span class="NAME">r.proxyB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">++</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">e.m_pairCount</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">e.m_pairBuffer</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s.proxyA</span><span class="PUNC">!=</span><span class="NAME">r.proxyA</span><span class="PUNC">||</span><span class="NAME">s.proxyB</span><span class="PUNC">!=</span><span class="NAME">r.proxyB</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.Query</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_tree.Query</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.RayCast</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_tree.RayCast</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.Validate</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.Rebalance</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_tree.Rebalance</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.BufferMove</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 69</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_moveBuffer</span><span class="PUNC">[</span><span class="NAME">this.m_moveBuffer.length</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.UnBufferMove</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_moveBuffer.splice</span><span class="PUNC">(</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.m_moveBuffer.indexOf</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.ComparePairs</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.__implements</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.__implements</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">H.b2DynamicTreeNode</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.aabb</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.IsLeaf</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.child1</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">O.b2DynamicTreePair</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.b2Manifold</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_pointCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.b2Manifold</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_points</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">(</span><span class="NAME">y.b2_maxManifoldPoints</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 70</span> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">y.b2_maxManifoldPoints</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">R</span><span class="PUNC">;</span><span class="NAME">this.m_localPlaneNormal</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.m_localPoint</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.Reset</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">y.b2_maxManifoldPoints</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">R</span><span class="PUNC">?</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">Reset</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localPlaneNormal.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localPoint.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_pointCount</span><span class="PUNC">=</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_pointCount</span><span class="PUNC">=</span><span class="NAME">b.m_pointCount</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">y.b2_maxManifoldPoints</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">R</span><span class="PUNC">?</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NAME">b.m_points</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 71</span> </span><span class="NAME">this.m_localPlaneNormal.SetV</span><span class="PUNC">(</span><span class="NAME">b.m_localPlaneNormal</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localPoint.SetV</span><span class="PUNC">(</span><span class="NAME">b.m_localPoint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NAME">b.m_type</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.Copy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">E</span><span class="PUNC">;</span><span class="NAME">b.Set</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Collision.b2Manifold.e_circles</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Manifold.e_faceA</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2Manifold.e_faceB</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">R.b2ManifoldPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_localPoint</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.m_id</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">R.prototype.b2ManifoldPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.Reset</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">R.prototype.Reset</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_localPoint.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_tangentImpulse</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 72</span> </span><span class="NAME">this.m_normalImpulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_id.key</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">R.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_localPoint.SetV</span><span class="PUNC">(</span><span class="NAME">b.m_localPoint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normalImpulse</span><span class="PUNC">=</span><span class="NAME">b.m_normalImpulse</span><span class="PUNC">;</span><span class="NAME">this.m_tangentImpulse</span><span class="PUNC">=</span><span class="NAME">b.m_tangentImpulse</span><span class="PUNC">;</span><span class="NAME">this.m_id.Set</span><span class="PUNC">(</span><span class="NAME">b.m_id</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.b2Point</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.Support</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.GetFirstVertex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.b2RayCastInput</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.p1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.p2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.b2RayCastInput</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 73</span> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.p1.SetV</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">this.p2.SetV</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.maxFraction</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">aa.b2RayCastOutput</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.normal</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.b2Segment</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.p1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.p2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.TestSegment</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">f.p1</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">f.p2.x</span><span class="PUNC">-</span><span class="NAME">r.x</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">f.p2.y</span><span class="PUNC">-</span><span class="NAME">r.y</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.p2.y</span><span class="PUNC">-</span><span class="NAME">this.p1.y</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.p2.x</span><span class="PUNC">-</span><span class="NAME">this.p1.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">></span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">r.x</span><span class="PUNC">-</span><span class="NAME">this.p1.x</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">r.y</span><span class="PUNC">-</span><span class="NAME">this.p1.y</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">T</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">r</span><span class="PUNC">&&</span><span class="NAME">r</span><span class="PUNC">&lt;=</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">T</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">&lt;=</span><span class="NAME">m</span><span class="PUNC">&&</span><span class="NAME">m</span><span class="PUNC">&lt;=</span><span class="NAME">C</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">r</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">e.Set</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 74</span> </span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.Extend</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ExtendForward</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ExtendBackward</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.ExtendForward</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.p2.x</span><span class="PUNC">-</span><span class="NAME">this.p1.x</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.p2.y</span><span class="PUNC">-</span><span class="NAME">this.p1.y</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b.upperBound.x</span><span class="PUNC">-</span><span class="NAME">this.p1.x</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b.lowerBound.x</span><span class="PUNC">-</span><span class="NAME">this.p1.x</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NAME">Number.POSITIVE_INFINITY</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b.upperBound.y</span><span class="PUNC">-</span><span class="NAME">this.p1.y</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b.lowerBound.y</span><span class="PUNC">-</span><span class="NAME">this.p1.y</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NAME">Number.POSITIVE_INFINITY</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.p2.x</span><span class="PUNC">=</span><span class="NAME">this.p1.x</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.p2.y</span><span class="PUNC">=</span><span class="NAME">this.p1.y</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.ExtendBackward</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.p2.x</span><span class="PUNC">+</span><span class="NAME">this.p1.x</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 75</span> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.p2.y</span><span class="PUNC">+</span><span class="NAME">this.p1.y</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b.upperBound.x</span><span class="PUNC">-</span><span class="NAME">this.p2.x</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b.lowerBound.x</span><span class="PUNC">-</span><span class="NAME">this.p2.x</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NAME">Number.POSITIVE_INFINITY</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b.upperBound.y</span><span class="PUNC">-</span><span class="NAME">this.p2.y</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b.lowerBound.y</span><span class="PUNC">-</span><span class="NAME">this.p2.y</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NAME">Number.POSITIVE_INFINITY</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.p1.x</span><span class="PUNC">=</span><span class="NAME">this.p2.x</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.p1.y</span><span class="PUNC">=</span><span class="NAME">this.p2.y</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">d.b2SeparationFunction</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_localPoint</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.m_axis</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">d.prototype.Initialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_proxyA</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.m_proxyB</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">b.count</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">s</span><span class="PUNC">&&</span><span class="NAME">s</span><span class="PUNC">&lt;</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'> 76</span> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NAME">d.e_points</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">this.m_proxyA.GetVertex</span><span class="PUNC">(</span><span class="NAME">b.indexA</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">this.m_proxyB.GetVertex</span><span class="PUNC">(</span><span class="NAME">b.indexB</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">f.R</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">f.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">b.col1.x</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.x</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">f.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">b.col1.y</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.y</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">r.R</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">r.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">b.col1.x</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.x</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">r.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">b.col1.y</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.y</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_axis.x</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.m_axis.y</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">this.m_axis.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.indexB</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">b.indexB</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NAME">d.e_faceA</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_proxyA.GetVertex</span><span class="PUNC">(</span><span class="NAME">b.indexA</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.m_proxyA.GetVertex</span><span class="PUNC">(</span><span class="NAME">b.indexA</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">this.m_proxyB.GetVertex</span><span class="PUNC">(</span><span class="NAME">b.indexB</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 77</span> </span><span class="NAME">this.m_localPoint.x</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">e.x</span><span class="PUNC">+</span><span class="NAME">m.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localPoint.y</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">e.y</span><span class="PUNC">+</span><span class="NAME">m.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_axis</span><span class="PUNC">=</span><span class="NAME">w.CrossVF</span><span class="PUNC">(</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_axis.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">this.m_axis</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">f.R</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">b.col1.x</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.x</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">b.col1.y</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.y</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">this.m_localPoint</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">f.R</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">f.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">b.col1.x</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.x</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">f.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">b.col1.y</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.y</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">r.R</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">r.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">b.col1.x</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.x</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">r.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">b.col1.y</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.y</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">T</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.indexA</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">b.indexA</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NAME">d.e_faceB</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">this.m_proxyB.GetVertex</span><span class="PUNC">(</span><span class="NAME">b.indexB</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 78</span> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">this.m_proxyB.GetVertex</span><span class="PUNC">(</span><span class="NAME">b.indexB</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">this.m_proxyA.GetVertex</span><span class="PUNC">(</span><span class="NAME">b.indexA</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localPoint.x</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">x.x</span><span class="PUNC">+</span><span class="NAME">C.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localPoint.y</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">x.y</span><span class="PUNC">+</span><span class="NAME">C.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_axis</span><span class="PUNC">=</span><span class="NAME">w.CrossVF</span><span class="PUNC">(</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_axis.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">this.m_axis</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">r.R</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">b.col1.x</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.x</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">b.col1.y</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.y</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">this.m_localPoint</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">r.R</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">r.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">b.col1.x</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.x</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">r.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">b.col1.y</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.y</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">f.R</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">f.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">b.col1.x</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.x</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">f.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">b.col1.y</span><span class="PUNC">*</span><span class="NAME">s.x</span><span class="PUNC">+</span><span class="NAME">b.col2.y</span><span class="PUNC">*</span><span class="NAME">s.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'> 79</span> </span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">-</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">T</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_proxyA.GetVertex</span><span class="PUNC">(</span><span class="NAME">b.indexA</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.m_proxyA.GetVertex</span><span class="PUNC">(</span><span class="NAME">b.indexA</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">this.m_proxyB.GetVertex</span><span class="PUNC">(</span><span class="NAME">b.indexB</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">this.m_proxyB.GetVertex</span><span class="PUNC">(</span><span class="NAME">b.indexB</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">w.MulMV</span><span class="PUNC">(</span><span class="NAME">f.R</span><span class="PUNC">,</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">w.MulMV</span><span class="PUNC">(</span><span class="NAME">r.R</span><span class="PUNC">,</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">v.x</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">v.y</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">J.x</span><span class="PUNC">*</span><span class="NAME">J.x</span><span class="PUNC">+</span><span class="NAME">J.y</span><span class="PUNC">*</span><span class="NAME">J.y</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">v.x</span><span class="PUNC">*</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="NAME">v.y</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">J.x</span><span class="PUNC">*</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="NAME">J.y</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">v.x</span><span class="PUNC">*</span><span class="NAME">J.x</span><span class="PUNC">+</span><span class="NAME">v.y</span><span class="PUNC">*</span><span class="NAME">J.y</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">T</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">w.Clamp</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">t</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">w.Clamp</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">v.x</span><span class="PUNC">=</span><span class="NAME">e.x</span><span class="PUNC">+</span><span class="NAME">J</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m.x</span><span class="PUNC">-</span><span class="NAME">e.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v.y</span><span class="PUNC">=</span><span class="NAME">e.y</span><span class="PUNC">+</span><span class="NAME">J</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m.y</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'> 80</span> </span><span class="NAME">e.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">t.x</span><span class="PUNC">=</span><span class="NAME">x.x</span><span class="PUNC">+</span><span class="NAME">J</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">C.x</span><span class="PUNC">-</span><span class="NAME">x.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.y</span><span class="PUNC">=</span><span class="NAME">x.y</span><span class="PUNC">+</span><span class="NAME">J</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">C.y</span><span class="PUNC">-</span><span class="NAME">x.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">||</span><span class="NAME">J</span><span class="PUNC">==</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NAME">d.e_faceB</span><span class="PUNC">;</span><span class="NAME">this.m_axis</span><span class="PUNC">=</span><span class="NAME">w.CrossVF</span><span class="PUNC">(</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_axis.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localPoint</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NAME">d.e_faceA</span><span class="PUNC">;</span><span class="NAME">this.m_axis</span><span class="PUNC">=</span><span class="NAME">w.CrossVF</span><span class="PUNC">(</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localPoint</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">J</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">this.m_axis.NegativeSelf</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">d.prototype.Evaluate</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">this.m_type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">d.e_points</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">w.MulTMV</span><span class="PUNC">(</span><span class="NAME">b.R</span><span class="PUNC">,</span><span class="NAME">this.m_axis</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">w.MulTMV</span><span class="PUNC">(</span><span class="NAME">e.R</span><span class="PUNC">,</span><span class="NAME">this.m_axis.GetNegative</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_proxyA.GetSupportVertex</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.m_proxyB.GetSupportVertex</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 81</span> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">m.x</span><span class="PUNC">-</span><span class="NAME">f.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">m.y</span><span class="PUNC">-</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">d.e_faceA</span><span class="PUNC">:</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">w.MulMV</span><span class="PUNC">(</span><span class="NAME">b.R</span><span class="PUNC">,</span><span class="NAME">this.m_axis</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.m_localPoint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">w.MulTMV</span><span class="PUNC">(</span><span class="NAME">e.R</span><span class="PUNC">,</span><span class="NAME">r.GetNegative</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.m_proxyB.GetSupportVertex</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">m.x</span><span class="PUNC">-</span><span class="NAME">f.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">m.y</span><span class="PUNC">-</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r.y</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">d.e_faceB</span><span class="PUNC">:</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">w.MulMV</span><span class="PUNC">(</span><span class="NAME">e.R</span><span class="PUNC">,</span><span class="NAME">this.m_axis</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">this.m_localPoint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">w.MulTMV</span><span class="PUNC">(</span><span class="NAME">b.R</span><span class="PUNC">,</span><span class="NAME">r.GetNegative</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_proxyA.GetSupportVertex</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">-</span><span class="NAME">m.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="PUNC">-</span><span class="NAME">m.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r.y</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 82</span> </span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Collision.b2SeparationFunction.e_points</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2SeparationFunction.e_faceA</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2SeparationFunction.e_faceB</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.b2Simplex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_v1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.m_v2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.m_v3</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.b2Simplex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.m_v1</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.m_v2</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.m_v3</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.ReadCache</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">b.count</span><span class="PUNC">&&</span><span class="NAME">b.count</span><span class="PUNC">&lt;=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="NAME">b.count</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 83</span> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">&lt;</span><span class="NAME">this.m_count</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">C.indexA</span><span class="PUNC">=</span><span class="NAME">b.indexA</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">C.indexB</span><span class="PUNC">=</span><span class="NAME">b.indexB</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">e.GetVertex</span><span class="PUNC">(</span><span class="NAME">C.indexA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">m.GetVertex</span><span class="PUNC">(</span><span class="NAME">C.indexB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.wA</span><span class="PUNC">=</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.wB</span><span class="PUNC">=</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.w</span><span class="PUNC">=</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">C.wB</span><span class="PUNC">,</span><span class="NAME">C.wA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_count</span><span class="PUNC">></span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.metric</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">this.GetMetric</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">&lt;</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">s</span><span class="PUNC">||</span><span class="NAME">s</span><span class="PUNC">&lt;</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_count</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">C.indexA</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">C.indexB</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">e.GetVertex</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">m.GetVertex</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.wA</span><span class="PUNC">=</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.wB</span><span class="PUNC">=</span><span class="NAME">w.MulX</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.w</span><span class="PUNC">=</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">C.wB</span><span class="PUNC">,</span><span class="NAME">C.wA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.WriteCache</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 84</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.metric</span><span class="PUNC">=</span><span class="NAME">this.GetMetric</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.count</span><span class="PUNC">=</span><span class="NAME">Box2D.parseUInt</span><span class="PUNC">(</span><span class="NAME">this.m_count</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">this.m_count</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.indexA</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Box2D.parseUInt</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">indexA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.indexB</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Box2D.parseUInt</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">indexB</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.GetSearchDirection</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">this.m_count</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_v1.w.GetNegative</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">:</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">this.m_v2.w</span><span class="PUNC">,</span><span class="NAME">this.m_v1.w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">w.CrossVV</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.m_v1.w.GetNegative</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NAME">w.CrossFV</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">w.CrossVF</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.GetClosestPoint</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 85</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">this.m_count</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_v1.w</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">(</span><span class="NAME">this.m_v1.a</span><span class="PUNC">*</span><span class="NAME">this.m_v1.w.x</span><span class="PUNC">+</span><span class="NAME">this.m_v2.a</span><span class="PUNC">*</span><span class="NAME">this.m_v2.w.x</span><span class="PUNC">,</span><span class="NAME">this.m_v1.a</span><span class="PUNC">*</span><span class="NAME">this.m_v1.w.y</span><span class="PUNC">+</span><span class="NAME">this.m_v2.a</span><span class="PUNC">*</span><span class="NAME">this.m_v2.w.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.GetWitnessPoints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">this.m_count</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">b.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_v1.wA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_v1.wB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">:</span><span class="NAME">b.x</span><span class="PUNC">=</span><span class="NAME">this.m_v1.a</span><span class="PUNC">*</span><span class="NAME">this.m_v1.wA.x</span><span class="PUNC">+</span><span class="NAME">this.m_v2.a</span><span class="PUNC">*</span><span class="NAME">this.m_v2.wA.x</span><span class="PUNC">;</span><span class="NAME">b.y</span><span class="PUNC">=</span><span class="NAME">this.m_v1.a</span><span class="PUNC">*</span><span class="NAME">this.m_v1.wA.y</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'> 86</span> </span><span class="NAME">this.m_v2.a</span><span class="PUNC">*</span><span class="NAME">this.m_v2.wA.y</span><span class="PUNC">;</span><span class="NAME">e.x</span><span class="PUNC">=</span><span class="NAME">this.m_v1.a</span><span class="PUNC">*</span><span class="NAME">this.m_v1.wB.x</span><span class="PUNC">+</span><span class="NAME">this.m_v2.a</span><span class="PUNC">*</span><span class="NAME">this.m_v2.wB.x</span><span class="PUNC">;</span><span class="NAME">e.y</span><span class="PUNC">=</span><span class="NAME">this.m_v1.a</span><span class="PUNC">*</span><span class="NAME">this.m_v1.wB.y</span><span class="PUNC">+</span><span class="NAME">this.m_v2.a</span><span class="PUNC">*</span><span class="NAME">this.m_v2.wB.y</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">:</span><span class="NAME">e.x</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">=</span><span class="NAME">this.m_v1.a</span><span class="PUNC">*</span><span class="NAME">this.m_v1.wA.x</span><span class="PUNC">+</span><span class="NAME">this.m_v2.a</span><span class="PUNC">*</span><span class="NAME">this.m_v2.wA.x</span><span class="PUNC">+</span><span class="NAME">this.m_v3.a</span><span class="PUNC">*</span><span class="NAME">this.m_v3.wA.x</span><span class="PUNC">;</span><span class="NAME">e.y</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">=</span><span class="NAME">this.m_v1.a</span><span class="PUNC">*</span><span class="NAME">this.m_v1.wA.y</span><span class="PUNC">+</span><span class="NAME">this.m_v2.a</span><span class="PUNC">*</span><span class="NAME">this.m_v2.wA.y</span><span class="PUNC">+</span><span class="NAME">this.m_v3.a</span><span class="PUNC">*</span><span class="NAME">this.m_v3.wA.y</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.GetMetric</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">this.m_count</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">this.m_v1.w</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 87</span> </span><span class="NAME">this.m_v2.w</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">Length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">w.CrossVV</span><span class="PUNC">(</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">this.m_v2.w</span><span class="PUNC">,</span><span class="NAME">this.m_v1.w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">this.m_v3.w</span><span class="PUNC">,</span><span class="NAME">this.m_v1.w</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.Solve2</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_v1.w</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_v2.w</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">*</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="NAME">b.y</span><span class="PUNC">*</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="NAME">this.m_v1.a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.x</span><span class="PUNC">*</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="NAME">e.y</span><span class="PUNC">*</span><span class="NAME">f.y</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="NAME">this.m_v2.a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.m_v1.Set</span><span class="PUNC">(</span><span class="NAME">this.m_v2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_v1.a</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">this.m_v2.a</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.Solve3</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_v1.w</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_v2.w</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 88</span> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_v3.w</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">w.Dot</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">w.Dot</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">w.Dot</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">w.Dot</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">w.SubtractVV</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">w.Dot</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">w.Dot</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">w.CrossVV</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">w.CrossVV</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">w.CrossVV</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">w.CrossVV</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">t</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="NAME">this.m_v1.a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">r</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_v1.a</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">this.m_v2.a</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">t</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">f</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_v1.a</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">this.m_v3.a</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.m_v2.Set</span><span class="PUNC">(</span><span class="NAME">this.m_v3</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">J</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 89</span> </span><span class="NAME">this.m_v2.a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.m_v1.Set</span><span class="PUNC">(</span><span class="NAME">this.m_v2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">C</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="NAME">this.m_v3.a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.m_v1.Set</span><span class="PUNC">(</span><span class="NAME">this.m_v3</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">J</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">m</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">+</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_v2.a</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">this.m_v3.a</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.m_v1.Set</span><span class="PUNC">(</span><span class="NAME">this.m_v3</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_v1.a</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">this.m_v2.a</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">this.m_v3.a</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">this.m_count</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">l.b2SimplexCache</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.indexA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector_a2j_Number</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.indexB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector_a2j_Number</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">j.b2SimplexVertex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">j.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.wA.SetV</span><span class="PUNC">(</span><span class="NAME">b.wA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.wB.SetV</span><span class="PUNC">(</span><span class="NAME">b.wB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.w.SetV</span><span class="PUNC">(</span><span class="NAME">b.w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 90</span> </span><span class="NAME">this.a</span><span class="PUNC">=</span><span class="NAME">b.a</span><span class="PUNC">;</span><span class="NAME">this.indexA</span><span class="PUNC">=</span><span class="NAME">b.indexA</span><span class="PUNC">;</span><span class="NAME">this.indexB</span><span class="PUNC">=</span><span class="NAME">b.indexB</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">o.b2TimeOfImpact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">o.TimeOfImpact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">++</span><span class="NAME">o.b2_toiCalls</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.proxyA</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.proxyB</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">b.sweepA</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">b.sweepB</span><span class="PUNC">;</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="NAME">m.t0</span><span class="PUNC">==</span><span class="NAME">r.t0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.b2Assert</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">m.t0</span><span class="PUNC">></span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">e.m_radius</span><span class="PUNC">+</span><span class="NAME">f.m_radius</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.tolerance</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">o.s_cache.count</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">o.s_distanceInput.useRadii</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m.GetTransform</span><span class="PUNC">(</span><span class="NAME">o.s_xfA</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.GetTransform</span><span class="PUNC">(</span><span class="NAME">o.s_xfB</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o.s_distanceInput.proxyA</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">o.s_distanceInput.proxyB</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">o.s_distanceInput.transformA</span><span class="PUNC">=</span><span class="NAME">o.s_xfA</span><span class="PUNC">;</span><span class="NAME">o.s_distanceInput.transformB</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 91</span> </span><span class="NAME">o.s_xfB</span><span class="PUNC">;</span><span class="NAME">W.Distance</span><span class="PUNC">(</span><span class="NAME">o.s_distanceOutput</span><span class="PUNC">,</span><span class="NAME">o.s_cache</span><span class="PUNC">,</span><span class="NAME">o.s_distanceInput</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">o.s_distanceOutput.distance</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">o.s_fcn.Initialize</span><span class="PUNC">(</span><span class="NAME">o.s_cache</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">o.s_xfA</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">o.s_xfB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">o.s_fcn.Evaluate</span><span class="PUNC">(</span><span class="NAME">o.s_xfA</span><span class="PUNC">,</span><span class="NAME">o.s_xfB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">></span><span class="NAME">s</span><span class="PUNC">?</span><span class="NAME">w.Max</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">0.75</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">w.Max</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">0.02</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">x</span><span class="PUNC">&lt;</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">m.GetTransform</span><span class="PUNC">(</span><span class="NAME">o.s_xfA</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.GetTransform</span><span class="PUNC">(</span><span class="NAME">o.s_xfB</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">o.s_fcn.Evaluate</span><span class="PUNC">(</span><span class="NAME">o.s_xfA</span><span class="PUNC">,</span><span class="NAME">o.s_xfB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">X</span><span class="PUNC">>=</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">&</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NAME">T</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">P</span><span class="PUNC">-</span><span class="NAME">T</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">X</span><span class="PUNC">-</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">T</span><span class="PUNC">+</span><span class="NAME">P</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 92</span> </span><span class="NAME">m.GetTransform</span><span class="PUNC">(</span><span class="NAME">o.s_xfA</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.GetTransform</span><span class="PUNC">(</span><span class="NAME">o.s_xfB</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ca</span><span class="PUNC">=</span><span class="NAME">o.s_fcn.Evaluate</span><span class="PUNC">(</span><span class="NAME">o.s_xfA</span><span class="PUNC">,</span><span class="NAME">o.s_xfB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">w.Abs</span><span class="PUNC">(</span><span class="NAME">ca</span><span class="PUNC">-</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">0.025</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">ca</span><span class="PUNC">></span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">ca</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">;</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">ca</span><span class="PUNC">}</span><span class="PUNC">++</span><span class="NAME">$</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">o.b2_toiRootIters</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">==</span><span class="NUMB">50</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">o.b2_toiMaxRootIters</span><span class="PUNC">=</span><span class="NAME">w.Max</span><span class="PUNC">(</span><span class="NAME">o.b2_toiMaxRootIters</span><span class="PUNC">,</span><span class="NAME">$</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">&lt;</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">o.b2_toiIters</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">==</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">o.b2_toiMaxIters</span><span class="PUNC">=</span><span class="NAME">w.Max</span><span class="PUNC">(</span><span class="NAME">o.b2_toiMaxIters</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Collision.b2TimeOfImpact.b2_toiCalls</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2TimeOfImpact.b2_toiIters</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 93</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2TimeOfImpact.b2_toiRootIters</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2TimeOfImpact.s_cache</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2TimeOfImpact.s_distanceInput</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Y</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2TimeOfImpact.s_xfA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2TimeOfImpact.s_xfB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2TimeOfImpact.s_fcn</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.b2TimeOfImpact.s_distanceOutput</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q.b2TOIInput</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.proxyA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">this.proxyB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">this.sweepA</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 94</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.sweepB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">n.b2WorldManifold</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_normal</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">n.prototype.b2WorldManifold</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_points</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">(</span><span class="NAME">y.b2_maxManifoldPoints</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">y.b2_maxManifoldPoints</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">n.prototype.Initialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.m_pointCount</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">b.m_type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">E.e_circles</span><span class="PUNC">:</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">e.R</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">b.m_localPoint</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">e.position.x</span><span class="PUNC">+</span><span class="NAME">t.col1.x</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.x</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.position.y</span><span class="PUNC">+</span><span class="NAME">t.col1.y</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.y</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 95</span> </span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">m.R</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">b.m_points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">m_localPoint</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">m.position.x</span><span class="PUNC">+</span><span class="NAME">t.col1.x</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.x</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">m.position.y</span><span class="PUNC">+</span><span class="NAME">t.col1.y</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.y</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">></span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">*</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normal.x</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">/</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">this.m_normal.y</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">/</span><span class="NAME">x</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_normal.x</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.m_normal.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">this.m_normal.y</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">this.m_normal.y</span><span class="PUNC">;</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">this.m_normal.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">this.m_normal.x</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">E.e_faceA</span><span class="PUNC">:</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">e.R</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">b.m_localPlaneNormal</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">t.col1.x</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.x</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">t.col1.y</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 96</span> </span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.y</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">e.R</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">b.m_localPoint</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">e.position.x</span><span class="PUNC">+</span><span class="NAME">t.col1.x</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.x</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">e.position.y</span><span class="PUNC">+</span><span class="NAME">t.col1.y</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.y</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">this.m_normal.x</span><span class="PUNC">=</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">this.m_normal.y</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">&lt;</span><span class="NAME">b.m_pointCount</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">m.R</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">b.m_points</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">m_localPoint</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">m.position.x</span><span class="PUNC">+</span><span class="NAME">t.col1.x</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.x</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">m.position.y</span><span class="PUNC">+</span><span class="NAME">t.col1.y</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.y</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">+</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">P</span><span class="PUNC">-</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">T</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">P</span><span class="PUNC">-</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">T</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">}</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">E.e_faceB</span><span class="PUNC">:</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">m.R</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">b.m_localPlaneNormal</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">t.col1.x</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.x</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">t.col1.y</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.y</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 97</span> </span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">m.R</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">b.m_localPoint</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">m.position.x</span><span class="PUNC">+</span><span class="NAME">t.col1.x</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.x</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">m.position.y</span><span class="PUNC">+</span><span class="NAME">t.col1.y</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.y</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">this.m_normal.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">this.m_normal.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">C</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">&lt;</span><span class="NAME">b.m_pointCount</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">e.R</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">b.m_points</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">m_localPoint</span><span class="PUNC">;</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">e.position.x</span><span class="PUNC">+</span><span class="NAME">t.col1.x</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.x</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">e.position.y</span><span class="PUNC">+</span><span class="NAME">t.col1.y</span><span class="PUNC">*</span><span class="NAME">v.x</span><span class="PUNC">+</span><span class="NAME">t.col2.y</span><span class="PUNC">*</span><span class="NAME">v.y</span><span class="PUNC">;</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">+</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">P</span><span class="PUNC">-</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">T</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">P</span><span class="PUNC">-</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">T</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.ClipVertex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.v</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.v.SetV</span><span class="PUNC">(</span><span class="NAME">b.v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.id.Set</span><span class="PUNC">(</span><span class="NAME">b.id</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 98</span> </span><span class="NAME">c.Features</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">c.prototype</span><span class="PUNC">,</span><span class="STRN">"referenceEdge"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">get</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._referenceEdge</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">c.prototype</span><span class="PUNC">,</span><span class="STRN">"referenceEdge"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._referenceEdge</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this._m_id._key</span><span class="PUNC">=</span><span class="NAME">this._m_id._key</span><span class="PUNC">&</span><span class="NUMB">4294967040</span><span class="PUNC">|</span><span class="NAME">this._referenceEdge</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">c.prototype</span><span class="PUNC">,</span><span class="STRN">"incidentEdge"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">get</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._incidentEdge</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">c.prototype</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 99</span> </span><span class="STRN">"incidentEdge"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._incidentEdge</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this._m_id._key</span><span class="PUNC">=</span><span class="NAME">this._m_id._key</span><span class="PUNC">&</span><span class="NUMB">4294902015</span><span class="PUNC">|</span><span class="NAME">this._incidentEdge</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">8</span><span class="PUNC">&</span><span class="NUMB">65280</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">c.prototype</span><span class="PUNC">,</span><span class="STRN">"incidentVertex"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">get</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._incidentVertex</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">c.prototype</span><span class="PUNC">,</span><span class="STRN">"incidentVertex"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._incidentVertex</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this._m_id._key</span><span class="PUNC">=</span><span class="NAME">this._m_id._key</span><span class="PUNC">&</span><span class="NUMB">4278255615</span><span class="PUNC">|</span><span class="WHIT">
<span class='line'>100</span> </span><span class="NAME">this._incidentVertex</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">16</span><span class="PUNC">&</span><span class="NUMB">16711680</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">c.prototype</span><span class="PUNC">,</span><span class="STRN">"flip"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">get</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._flip</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">c.prototype</span><span class="PUNC">,</span><span class="STRN">"flip"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._flip</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this._m_id._key</span><span class="PUNC">=</span><span class="NAME">this._m_id._key</span><span class="PUNC">&</span><span class="NUMB">16777215</span><span class="PUNC">|</span><span class="NAME">this._flip</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">24</span><span class="PUNC">&</span><span class="NUMB">4278190080</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>101</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.b2Settings</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2CircleShape</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2EdgeChainDef</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2EdgeShape</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2MassData</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2PolygonShape</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2Shape</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Mat22</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Math</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Transform</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Vec2</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2Distance</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2DistanceInput</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2DistanceOutput</span><span class="PUNC">,</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2DistanceProxy</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>102</span> </span><span class="NAME">Y</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2SimplexCache</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">Box2D.Collision.Shapes.b2Shape</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">G.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.prototype</span><span class="PUNC">;</span><span class="NAME">G.b2CircleShape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.b2Shape.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.Copy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">k.Set</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.Set.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Box2D.is</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.m_p.SetV</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">k</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">?</span><span class="NAME">k</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">m_p</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.TestPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">k.R</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">k.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">u.col1.x</span><span class="PUNC">*</span><span class="NAME">this.m_p.x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>103</span> </span><span class="NAME">u.col2.x</span><span class="PUNC">*</span><span class="NAME">this.m_p.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">k.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">u.col1.y</span><span class="PUNC">*</span><span class="NAME">this.m_p.x</span><span class="PUNC">+</span><span class="NAME">u.col2.y</span><span class="PUNC">*</span><span class="NAME">this.m_p.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">z.x</span><span class="PUNC">-</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">z.y</span><span class="PUNC">-</span><span class="NAME">u</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">*</span><span class="NAME">D</span><span class="PUNC">+</span><span class="NAME">u</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">&lt;=</span><span class="NAME">this.m_radius</span><span class="PUNC">*</span><span class="NAME">this.m_radius</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.RayCast</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">u.R</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">z.p1.x</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">u.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">D.col1.x</span><span class="PUNC">*</span><span class="NAME">this.m_p.x</span><span class="PUNC">+</span><span class="NAME">D.col2.x</span><span class="PUNC">*</span><span class="NAME">this.m_p.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">z.p1.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">u.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">D.col1.y</span><span class="PUNC">*</span><span class="NAME">this.m_p.x</span><span class="PUNC">+</span><span class="NAME">D.col2.y</span><span class="PUNC">*</span><span class="NAME">this.m_p.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">z.p2.x</span><span class="PUNC">-</span><span class="NAME">z.p1.x</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">z.p2.y</span><span class="PUNC">-</span><span class="NAME">z.p1.y</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">D</span><span class="PUNC">+</span><span class="NAME">u</span><span class="PUNC">*</span><span class="NAME">O</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">*</span><span class="NAME">D</span><span class="PUNC">+</span><span class="NAME">O</span><span class="PUNC">*</span><span class="NAME">O</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">*</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NAME">R</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">+</span><span class="NAME">u</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">-</span><span class="NAME">this.m_radius</span><span class="PUNC">*</span><span class="NAME">this.m_radius</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">||</span><span class="NAME">R</span><span class="PUNC">&lt;</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">+</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">E</span><span class="PUNC">&&</span><span class="NAME">E</span><span class="PUNC">&lt;=</span><span class="NAME">z.maxFraction</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>104</span> </span><span class="NAME">R</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">;</span><span class="NAME">k.fraction</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">;</span><span class="NAME">k.normal.x</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">+</span><span class="NAME">E</span><span class="PUNC">*</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">k.normal.y</span><span class="PUNC">=</span><span class="NAME">u</span><span class="PUNC">+</span><span class="NAME">E</span><span class="PUNC">*</span><span class="NAME">O</span><span class="PUNC">;</span><span class="NAME">k.normal.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.ComputeAABB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">z.R</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">z.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">u.col1.x</span><span class="PUNC">*</span><span class="NAME">this.m_p.x</span><span class="PUNC">+</span><span class="NAME">u.col2.x</span><span class="PUNC">*</span><span class="NAME">this.m_p.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">z.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">u.col1.y</span><span class="PUNC">*</span><span class="NAME">this.m_p.x</span><span class="PUNC">+</span><span class="NAME">u.col2.y</span><span class="PUNC">*</span><span class="NAME">this.m_p.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.lowerBound.Set</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">-</span><span class="NAME">this.m_radius</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">-</span><span class="NAME">this.m_radius</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.upperBound.Set</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">+</span><span class="NAME">this.m_radius</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">+</span><span class="NAME">this.m_radius</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.ComputeMass</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">k.mass</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">F.b2_pi</span><span class="PUNC">*</span><span class="NAME">this.m_radius</span><span class="PUNC">*</span><span class="NAME">this.m_radius</span><span class="PUNC">;</span><span class="NAME">k.center.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.I</span><span class="PUNC">=</span><span class="NAME">k.mass</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>105</span> </span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">this.m_radius</span><span class="PUNC">*</span><span class="NAME">this.m_radius</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_p.x</span><span class="PUNC">*</span><span class="NAME">this.m_p.x</span><span class="PUNC">+</span><span class="NAME">this.m_p.y</span><span class="PUNC">*</span><span class="NAME">this.m_p.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.ComputeSubmergedArea</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">B.MulX</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">this.m_p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">B.Dot</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">&lt;</span><span class="PUNC">-</span><span class="NAME">this.m_radius</span><span class="PUNC">+</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">></span><span class="NAME">this.m_radius</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">D.SetV</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.PI</span><span class="PUNC">*</span><span class="NAME">this.m_radius</span><span class="PUNC">*</span><span class="NAME">this.m_radius</span><span class="PUNC">}</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">this.m_radius</span><span class="PUNC">*</span><span class="NAME">this.m_radius</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">/</span><span class="NAME">this.m_radius</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">-</span><span class="NAME">O</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">-</span><span class="NAME">O</span><span class="PUNC">,</span><span class="NUMB">1.5</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">D.x</span><span class="PUNC">=</span><span class="NAME">u.x</span><span class="PUNC">+</span><span class="NAME">k.x</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">D.y</span><span class="PUNC">=</span><span class="NAME">u.y</span><span class="PUNC">+</span><span class="NAME">k.y</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.GetLocalPosition</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>106</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.SetLocalPosition</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_p.SetV</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.GetRadius</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_radius</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.SetRadius</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_radius</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.b2CircleShape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.__super.b2Shape.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NAME">U.e_circleShape</span><span class="PUNC">;</span><span class="NAME">this.m_radius</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.b2EdgeChainDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.prototype.b2EdgeChainDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.vertexCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.isALoop</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">this.vertices</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">Box2D.Collision.Shapes.b2Shape</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>107</span> </span><span class="NAME">y.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.prototype</span><span class="PUNC">;</span><span class="NAME">y.b2EdgeShape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.b2Shape.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.s_supportVec</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">this.m_v1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">this.m_v2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">this.m_coreV1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">this.m_coreV2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">this.m_normal</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">this.m_direction</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">this.m_cornerDir1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">this.m_cornerDir2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.TestPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.RayCast</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">z.p2.x</span><span class="PUNC">-</span><span class="NAME">z.p1.x</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">z.p2.y</span><span class="PUNC">-</span><span class="NAME">z.p1.y</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">u.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">u.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">D.col1.x</span><span class="PUNC">*</span><span class="NAME">this.m_v1.x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>108</span> </span><span class="NAME">D.col2.x</span><span class="PUNC">*</span><span class="NAME">this.m_v1.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">u.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">D.col1.y</span><span class="PUNC">*</span><span class="NAME">this.m_v1.x</span><span class="PUNC">+</span><span class="NAME">D.col2.y</span><span class="PUNC">*</span><span class="NAME">this.m_v1.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">u.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">D.col1.y</span><span class="PUNC">*</span><span class="NAME">this.m_v2.x</span><span class="PUNC">+</span><span class="NAME">D.col2.y</span><span class="PUNC">*</span><span class="NAME">this.m_v2.y</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">R</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">u.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">D.col1.x</span><span class="PUNC">*</span><span class="NAME">this.m_v2.x</span><span class="PUNC">+</span><span class="NAME">D.col2.x</span><span class="PUNC">*</span><span class="NAME">this.m_v2.y</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">E</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NAME">O</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">S</span><span class="PUNC">></span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">z.p1.x</span><span class="PUNC">-</span><span class="NAME">E</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">z.p1.y</span><span class="PUNC">-</span><span class="NAME">R</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NAME">aa</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">R</span><span class="PUNC">&&</span><span class="NAME">R</span><span class="PUNC">&lt;=</span><span class="NAME">z.maxFraction</span><span class="PUNC">*</span><span class="NAME">S</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">z</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">aa</span><span class="PUNC">+</span><span class="NAME">O</span><span class="PUNC">*</span><span class="NAME">E</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">D</span><span class="PUNC">*</span><span class="NAME">S</span><span class="PUNC">&lt;=</span><span class="NAME">z</span><span class="PUNC">&&</span><span class="NAME">z</span><span class="PUNC">&lt;=</span><span class="NAME">S</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">R</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">;</span><span class="NAME">k.fraction</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NAME">u</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.normal.x</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">/</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">k.normal.y</span><span class="PUNC">=</span><span class="NAME">u</span><span class="PUNC">/</span><span class="NAME">z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.ComputeAABB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">z.R</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>109</span> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">z.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">u.col1.x</span><span class="PUNC">*</span><span class="NAME">this.m_v1.x</span><span class="PUNC">+</span><span class="NAME">u.col2.x</span><span class="PUNC">*</span><span class="NAME">this.m_v1.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">z.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">u.col1.y</span><span class="PUNC">*</span><span class="NAME">this.m_v1.x</span><span class="PUNC">+</span><span class="NAME">u.col2.y</span><span class="PUNC">*</span><span class="NAME">this.m_v1.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">z.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">u.col1.x</span><span class="PUNC">*</span><span class="NAME">this.m_v2.x</span><span class="PUNC">+</span><span class="NAME">u.col2.x</span><span class="PUNC">*</span><span class="NAME">this.m_v2.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">z.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">u.col1.y</span><span class="PUNC">*</span><span class="NAME">this.m_v2.x</span><span class="PUNC">+</span><span class="NAME">u.col2.y</span><span class="PUNC">*</span><span class="NAME">this.m_v2.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">&lt;</span><span class="NAME">O</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k.lowerBound.x</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">k.upperBound.x</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">k.lowerBound.x</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">;</span><span class="NAME">k.upperBound.x</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">&lt;</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k.lowerBound.y</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">k.upperBound.y</span><span class="PUNC">=</span><span class="NAME">u</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">k.lowerBound.y</span><span class="PUNC">=</span><span class="NAME">u</span><span class="PUNC">;</span><span class="NAME">k.upperBound.y</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.ComputeMass</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k.mass</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">k.center.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_v1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.I</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.ComputeSubmergedArea</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>110</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">(</span><span class="NAME">k.x</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">k.y</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">B.MulX</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">this.m_v1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">B.MulX</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">this.m_v2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">B.Dot</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">B.Dot</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">O.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">O.x</span><span class="PUNC">+</span><span class="NAME">E</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">u.x</span><span class="PUNC">;</span><span class="NAME">O.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">O.y</span><span class="PUNC">+</span><span class="NAME">E</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">u.y</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">u.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">O.x</span><span class="PUNC">+</span><span class="NAME">E</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">u.x</span><span class="PUNC">;</span><span class="NAME">u.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">O.y</span><span class="PUNC">+</span><span class="NAME">E</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">u.y</span><span class="PUNC">}</span><span class="NAME">D.x</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">H.x</span><span class="PUNC">+</span><span class="NAME">O.x</span><span class="PUNC">+</span><span class="NAME">u.x</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">D.y</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">H.y</span><span class="PUNC">+</span><span class="NAME">O.y</span><span class="PUNC">+</span><span class="NAME">u.y</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">O.x</span><span class="PUNC">-</span><span class="NAME">H.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">u.y</span><span class="PUNC">-</span><span class="NAME">H.y</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">O.y</span><span class="PUNC">-</span><span class="NAME">H.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">u.x</span><span class="PUNC">-</span><span class="NAME">H.x</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.GetLength</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_length</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.GetVertex1</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_v1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.GetVertex2</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>111</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_v2</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.GetCoreVertex1</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_coreV1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.GetCoreVertex2</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_coreV2</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.GetNormalVector</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_normal</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.GetDirectionVector</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_direction</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.GetCorner1Vector</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_cornerDir1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.GetCorner2Vector</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_cornerDir2</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.Corner1IsConvex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_cornerConvex1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.Corner2IsConvex</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>112</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_cornerConvex2</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.GetFirstVertex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">k.R</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">(</span><span class="NAME">k.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">z.col1.x</span><span class="PUNC">*</span><span class="NAME">this.m_coreV1.x</span><span class="PUNC">+</span><span class="NAME">z.col2.x</span><span class="PUNC">*</span><span class="NAME">this.m_coreV1.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">z.col1.y</span><span class="PUNC">*</span><span class="NAME">this.m_coreV1.x</span><span class="PUNC">+</span><span class="NAME">z.col2.y</span><span class="PUNC">*</span><span class="NAME">this.m_coreV1.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.GetNextEdge</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_nextEdge</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.GetPrevEdge</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_prevEdge</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.Support</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">k.R</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">k.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">D.col1.x</span><span class="PUNC">*</span><span class="NAME">this.m_coreV1.x</span><span class="PUNC">+</span><span class="NAME">D.col2.x</span><span class="PUNC">*</span><span class="NAME">this.m_coreV1.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>113</span> </span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">k.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">D.col1.y</span><span class="PUNC">*</span><span class="NAME">this.m_coreV1.x</span><span class="PUNC">+</span><span class="NAME">D.col2.y</span><span class="PUNC">*</span><span class="NAME">this.m_coreV1.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">k.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">D.col1.x</span><span class="PUNC">*</span><span class="NAME">this.m_coreV2.x</span><span class="PUNC">+</span><span class="NAME">D.col2.x</span><span class="PUNC">*</span><span class="NAME">this.m_coreV2.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">k.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">D.col1.y</span><span class="PUNC">*</span><span class="NAME">this.m_coreV2.x</span><span class="PUNC">+</span><span class="NAME">D.col2.y</span><span class="PUNC">*</span><span class="NAME">this.m_coreV2.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">+</span><span class="NAME">O</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">></span><span class="NAME">E</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">+</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.s_supportVec.x</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">this.s_supportVec.y</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.s_supportVec.x</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">;</span><span class="NAME">this.s_supportVec.y</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.s_supportVec</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.b2EdgeShape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2Shape.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NAME">U.e_edgeShape</span><span class="PUNC">;</span><span class="NAME">this.m_nextEdge</span><span class="PUNC">=</span><span class="NAME">this.m_prevEdge</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_v1</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">this.m_v2</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">this.m_direction.Set</span><span class="PUNC">(</span><span class="NAME">this.m_v2.x</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>114</span> </span><span class="NAME">this.m_v1.x</span><span class="PUNC">,</span><span class="NAME">this.m_v2.y</span><span class="PUNC">-</span><span class="NAME">this.m_v1.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_length</span><span class="PUNC">=</span><span class="NAME">this.m_direction.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normal.Set</span><span class="PUNC">(</span><span class="NAME">this.m_direction.y</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">this.m_direction.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_coreV1.Set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">F.b2_toiSlop</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_normal.x</span><span class="PUNC">-</span><span class="NAME">this.m_direction.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_v1.x</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">F.b2_toiSlop</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_normal.y</span><span class="PUNC">-</span><span class="NAME">this.m_direction.y</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_v1.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_coreV2.Set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">F.b2_toiSlop</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_normal.x</span><span class="PUNC">+</span><span class="NAME">this.m_direction.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_v2.x</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">F.b2_toiSlop</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_normal.y</span><span class="PUNC">+</span><span class="NAME">this.m_direction.y</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_v2.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_cornerDir1</span><span class="PUNC">=</span><span class="NAME">this.m_normal</span><span class="PUNC">;</span><span class="NAME">this.m_cornerDir2.Set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">this.m_normal.x</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">this.m_normal.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>115</span> </span><span class="NAME">y.prototype.SetPrevEdge</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_prevEdge</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">this.m_coreV1</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">this.m_cornerDir1</span><span class="PUNC">=</span><span class="NAME">u</span><span class="PUNC">;</span><span class="NAME">this.m_cornerConvex1</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.SetNextEdge</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_nextEdge</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">this.m_coreV2</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">this.m_cornerDir2</span><span class="PUNC">=</span><span class="NAME">u</span><span class="PUNC">;</span><span class="NAME">this.m_cornerConvex2</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.b2MassData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.mass</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.center</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.I</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">Box2D.Collision.Shapes.b2Shape</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.prototype</span><span class="PUNC">;</span><span class="NAME">A.b2PolygonShape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.b2Shape.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>116</span> </span><span class="NAME">A.prototype.Copy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">k.Set</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.Set.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Box2D.is</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">k</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">?</span><span class="NAME">k</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_centroid.SetV</span><span class="PUNC">(</span><span class="NAME">k.m_centroid</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">=</span><span class="NAME">k.m_vertexCount</span><span class="PUNC">;</span><span class="NAME">this.Reserve</span><span class="PUNC">(</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">&lt;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">SetV</span><span class="PUNC">(</span><span class="NAME">k.m_vertices</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">SetV</span><span class="PUNC">(</span><span class="NAME">k.m_normals</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.SetAsArray</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">&lt;</span><span class="NAME">k.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">[</span><span class="NAME">D</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">u.push</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.SetAsVector</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>117</span> </span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.AsArray</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">u.SetAsArray</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.SetAsVector</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">k.length</span><span class="PUNC">;</span><span class="NAME">F.b2Assert</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">&lt;=</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">this.Reserve</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">&lt;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">u</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">SetV</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">[</span><span class="NAME">u</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">&lt;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">?</span><span class="NAME">u</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">B.SubtractVV</span><span class="PUNC">(</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">H</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">D</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">F.b2Assert</span><span class="PUNC">(</span><span class="NAME">D.LengthSquared</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NAME">u</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">SetV</span><span class="PUNC">(</span><span class="NAME">B.CrossVF</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>118</span> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NAME">u</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.m_centroid</span><span class="PUNC">=</span><span class="NAME">A.ComputeCentroid</span><span class="PUNC">(</span><span class="NAME">this.m_vertices</span><span class="PUNC">,</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.AsVector</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">u.SetAsVector</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.SetAsBox</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">this.Reserve</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>119</span> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_centroid.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.AsBox</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">u.SetAsBox</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.SetAsOrientedBox</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">this.Reserve</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>120</span> </span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_centroid</span><span class="PUNC">=</span><span class="NAME">u</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">;</span><span class="NAME">k.position</span><span class="PUNC">=</span><span class="NAME">u</span><span class="PUNC">;</span><span class="NAME">k.R.Set</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">&lt;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">u</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">B.MulX</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">u</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NAME">u</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">B.MulMV</span><span class="PUNC">(</span><span class="NAME">k.R</span><span class="PUNC">,</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NAME">u</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.AsOrientedBox</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">H.SetAsOrientedBox</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.SetAsEdge</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.Reserve</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">SetV</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>121</span> </span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">SetV</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_centroid.x</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">k.x</span><span class="PUNC">+</span><span class="NAME">z.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_centroid.y</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">k.y</span><span class="PUNC">+</span><span class="NAME">z.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">B.CrossVF</span><span class="PUNC">(</span><span class="NAME">B.SubtractVV</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.AsEdge</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">u.SetAsEdge</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.TestPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">k.R</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">z.x</span><span class="PUNC">-</span><span class="NAME">k.position.x</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">z.y</span><span class="PUNC">-</span><span class="NAME">k.position.y</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">*</span><span class="NAME">u.col1.x</span><span class="PUNC">+</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">u.col1.y</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">*</span><span class="NAME">u.col2.x</span><span class="PUNC">+</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">u.col2.y</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">&lt;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">R</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">R</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>122</span> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">-</span><span class="NAME">u.x</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NAME">u.y</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NAME">R</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">u.x</span><span class="PUNC">*</span><span class="NAME">D</span><span class="PUNC">+</span><span class="NAME">u.y</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.RayCast</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">z.maxFraction</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">z.p1.x</span><span class="PUNC">-</span><span class="NAME">u.position.x</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">z.p1.y</span><span class="PUNC">-</span><span class="NAME">u.position.y</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">u.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">*</span><span class="NAME">R.col1.x</span><span class="PUNC">+</span><span class="NAME">E</span><span class="PUNC">*</span><span class="NAME">R.col1.y</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">*</span><span class="NAME">R.col2.x</span><span class="PUNC">+</span><span class="NAME">E</span><span class="PUNC">*</span><span class="NAME">R.col2.y</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">z.p2.x</span><span class="PUNC">-</span><span class="NAME">u.position.x</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">z.p2.y</span><span class="PUNC">-</span><span class="NAME">u.position.y</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">u.R</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">*</span><span class="NAME">R.col1.x</span><span class="PUNC">+</span><span class="NAME">E</span><span class="PUNC">*</span><span class="NAME">R.col1.y</span><span class="PUNC">-</span><span class="NAME">S</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">*</span><span class="NAME">R.col2.x</span><span class="PUNC">+</span><span class="NAME">E</span><span class="PUNC">*</span><span class="NAME">R.col2.y</span><span class="PUNC">-</span><span class="NAME">aa</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">N.x</span><span class="PUNC">-</span><span class="NAME">S</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">N.y</span><span class="PUNC">-</span><span class="NAME">aa</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">N.x</span><span class="PUNC">*</span><span class="NAME">O</span><span class="PUNC">+</span><span class="NAME">N.y</span><span class="PUNC">*</span><span class="NAME">E</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">N.x</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">+</span><span class="NAME">N.y</span><span class="PUNC">*</span><span class="NAME">R</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>123</span> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">*</span><span class="NAME">E</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">/</span><span class="NAME">E</span><span class="PUNC">;</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">E</span><span class="PUNC">)</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">/</span><span class="NAME">E</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">-</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Z</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k.fraction</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">u.R</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NAME">Z</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">k.normal.x</span><span class="PUNC">=</span><span class="NAME">R.col1.x</span><span class="PUNC">*</span><span class="NAME">N.x</span><span class="PUNC">+</span><span class="NAME">R.col2.x</span><span class="PUNC">*</span><span class="NAME">N.y</span><span class="PUNC">;</span><span class="NAME">k.normal.y</span><span class="PUNC">=</span><span class="NAME">R.col1.y</span><span class="PUNC">*</span><span class="NAME">N.x</span><span class="PUNC">+</span><span class="NAME">R.col2.y</span><span class="PUNC">*</span><span class="NAME">N.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.ComputeAABB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">z.R</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">z.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">u.col1.x</span><span class="PUNC">*</span><span class="NAME">D.x</span><span class="PUNC">+</span><span class="NAME">u.col2.x</span><span class="PUNC">*</span><span class="NAME">D.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">z.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">u.col1.y</span><span class="PUNC">*</span><span class="NAME">D.x</span><span class="PUNC">+</span><span class="NAME">u.col2.y</span><span class="PUNC">*</span><span class="NAME">D.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">&lt;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">z.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">u.col1.x</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>124</span> </span><span class="NAME">D.x</span><span class="PUNC">+</span><span class="NAME">u.col2.x</span><span class="PUNC">*</span><span class="NAME">D.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">z.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">u.col1.y</span><span class="PUNC">*</span><span class="NAME">D.x</span><span class="PUNC">+</span><span class="NAME">u.col2.y</span><span class="PUNC">*</span><span class="NAME">D.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">&lt;</span><span class="NAME">S</span><span class="PUNC">?</span><span class="NAME">H</span><span class="PUNC">:</span><span class="NAME">S</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">?</span><span class="NAME">O</span><span class="PUNC">:</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">></span><span class="NAME">S</span><span class="PUNC">?</span><span class="NAME">E</span><span class="PUNC">:</span><span class="NAME">S</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">></span><span class="NAME">D</span><span class="PUNC">?</span><span class="NAME">R</span><span class="PUNC">:</span><span class="NAME">D</span><span class="PUNC">}</span><span class="NAME">k.lowerBound.x</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">-</span><span class="NAME">this.m_radius</span><span class="PUNC">;</span><span class="NAME">k.lowerBound.y</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">-</span><span class="NAME">this.m_radius</span><span class="PUNC">;</span><span class="NAME">k.upperBound.x</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">+</span><span class="NAME">this.m_radius</span><span class="PUNC">;</span><span class="NAME">k.upperBound.y</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">+</span><span class="NAME">this.m_radius</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.ComputeMass</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">==</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k.center.x</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.center.y</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.mass</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">k.I</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">&lt;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">R</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>125</span> </span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">R</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">?</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">R</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">N.x</span><span class="PUNC">-</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">N.y</span><span class="PUNC">-</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">-</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">-</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">Z</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">E</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">+</span><span class="NAME">N.x</span><span class="PUNC">+</span><span class="NAME">S.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">E</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">+</span><span class="NAME">N.y</span><span class="PUNC">+</span><span class="NAME">S.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">;</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">Z</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">0.25</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NUMB">0</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">0</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">0.25</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Z</span><span class="PUNC">*</span><span class="NAME">Z</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">Z</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">*</span><span class="NAME">Z</span><span class="PUNC">+</span><span class="NUMB">0</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">k.mass</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">k.center.Set</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.I</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">O</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.ComputeSubmergedArea</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">B.MulTMV</span><span class="PUNC">(</span><span class="NAME">u.R</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">-</span><span class="NAME">B.Dot</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">u.position</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector_a2j_Number</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>126</span> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">&lt;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">B.Dot</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">O</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">&lt;</span><span class="PUNC">-</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">aa</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">S</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">S</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">}</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">R</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">:</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">S</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.ComputeMass</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.SetV</span><span class="PUNC">(</span><span class="NAME">B.MulX</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">k.center</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.mass</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">==</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">-</span><span class="NAME">E</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">E</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">-</span><span class="NAME">E</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">[</span><span class="NAME">H</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">E</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">(</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>127</span> </span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">O</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">O</span><span class="PUNC">,</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">O</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">O</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">(</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">E</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">H</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">E</span><span class="PUNC">,</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">E</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">H</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">E</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">!=</span><span class="NAME">H</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">;</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">==</span><span class="NAME">H</span><span class="PUNC">?</span><span class="NAME">z</span><span class="PUNC">:</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">R.x</span><span class="PUNC">-</span><span class="NAME">N.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">S.y</span><span class="PUNC">-</span><span class="NAME">N.y</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">R.y</span><span class="PUNC">-</span><span class="NAME">N.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">S.x</span><span class="PUNC">-</span><span class="NAME">N.x</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">;</span><span class="NAME">O.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">N.x</span><span class="PUNC">+</span><span class="NAME">R.x</span><span class="PUNC">+</span><span class="NAME">S.x</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">O.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">N.y</span><span class="PUNC">+</span><span class="NAME">R.y</span><span class="PUNC">+</span><span class="NAME">S.y</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">}</span><span class="NAME">O.Multiply</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">E</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.SetV</span><span class="PUNC">(</span><span class="NAME">B.MulX</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">E</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.GetVertexCount</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_vertexCount</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>128</span> </span><span class="NAME">A.prototype.GetVertices</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_vertices</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.GetNormals</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_normals</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.GetSupport</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">k.x</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">k.y</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">&lt;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">D</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">k.x</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">D</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">k.y</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">></span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.GetSupportVertex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">k.x</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">k.y</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">&lt;</span><span class="NAME">this.m_vertexCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">D</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">k.x</span><span class="PUNC">+</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">D</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>129</span> </span><span class="NAME">k.y</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">></span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Validate</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.b2PolygonShape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2Shape.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NAME">U.e_polygonShape</span><span class="PUNC">;</span><span class="NAME">this.m_centroid</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">this.m_vertices</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Reserve</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.m_vertices.length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">&lt;</span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_vertices</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">this.m_normals</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.ComputeCentroid</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>130</span> </span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">z</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">O</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">z</span><span class="PUNC">?</span><span class="NAME">k</span><span class="PUNC">[</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">O</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">k</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">E.x</span><span class="PUNC">-</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">R.y</span><span class="PUNC">-</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">E.y</span><span class="PUNC">-</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">R.x</span><span class="PUNC">-</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">u.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">+</span><span class="NAME">E.x</span><span class="PUNC">+</span><span class="NAME">R.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">u.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">+</span><span class="NAME">E.y</span><span class="PUNC">+</span><span class="NAME">R.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">u.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">u.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">D</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.ComputeOBB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">&lt;</span><span class="NAME">u</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">D</span><span class="PUNC">)</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">D</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">D</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">u</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">&lt;=</span><span class="NAME">u</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">D</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">O.x</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">D</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">-</span><span class="NAME">O.y</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">*</span><span class="NAME">E</span><span class="PUNC">+</span><span class="NAME">R</span><span class="PUNC">*</span><span class="NAME">R</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">R</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">u</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>131</span> </span><span class="NAME">O.x</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">-</span><span class="NAME">O.y</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">R</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">aa</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">&lt;</span><span class="NAME">N</span><span class="PUNC">)</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">Z</span><span class="PUNC">)</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">></span><span class="NAME">h</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">}</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">Z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NUMB">0.95</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">k.R.col1.x</span><span class="PUNC">=</span><span class="NAME">E</span><span class="PUNC">;</span><span class="NAME">k.R.col1.y</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">;</span><span class="NAME">k.R.col2.x</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">;</span><span class="NAME">k.R.col2.y</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Z</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">k.R</span><span class="PUNC">;</span><span class="NAME">k.center.x</span><span class="PUNC">=</span><span class="NAME">O.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">S.col1.x</span><span class="PUNC">*</span><span class="NAME">E</span><span class="PUNC">+</span><span class="NAME">S.col2.x</span><span class="PUNC">*</span><span class="NAME">R</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.center.y</span><span class="PUNC">=</span><span class="NAME">O.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">S.col1.y</span><span class="PUNC">*</span><span class="NAME">E</span><span class="PUNC">+</span><span class="NAME">S.col2.y</span><span class="PUNC">*</span><span class="NAME">R</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.extents.x</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.extents.y</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">Z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Collision.Shapes.b2PolygonShape.s_mat</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">U.b2Shape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.Copy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_radius</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>132</span> </span><span class="NAME">k.m_radius</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.GetType</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_type</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.TestPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.RayCast</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.ComputeAABB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.ComputeMass</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.ComputeSubmergedArea</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.TestOverlap</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">;</span><span class="NAME">H.proxyA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">W</span><span class="PUNC">;</span><span class="NAME">H.proxyA.Set</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">H.proxyB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">W</span><span class="PUNC">;</span><span class="NAME">H.proxyB.Set</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">H.transformA</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">H.transformB</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">H.useRadii</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Y</span><span class="PUNC">;</span><span class="NAME">k.count</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">I</span><span class="PUNC">;</span><span class="NAME">M.Distance</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">z.distance</span><span class="PUNC">&lt;</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>133</span> </span><span class="NAME">U.prototype.b2Shape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NAME">U.e_unknownShape</span><span class="PUNC">;</span><span class="NAME">this.m_radius</span><span class="PUNC">=</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.e_unknownShape</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.e_circleShape</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.e_polygonShape</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.e_edgeShape</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.e_hitCollide</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.e_missCollide</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>134</span> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>135</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.b2Color</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.b2Settings</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Math</span><span class="PUNC">;</span><span class="NAME">F.b2Color</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._b</span><span class="PUNC">=</span><span class="NAME">this._g</span><span class="PUNC">=</span><span class="NAME">this._r</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.b2Color</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._r</span><span class="PUNC">=</span><span class="NAME">Box2D.parseUInt</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">K.Clamp</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._g</span><span class="PUNC">=</span><span class="NAME">Box2D.parseUInt</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">K.Clamp</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._b</span><span class="PUNC">=</span><span class="NAME">Box2D.parseUInt</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">K.Clamp</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._r</span><span class="PUNC">=</span><span class="NAME">Box2D.parseUInt</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">K.Clamp</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>136</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._g</span><span class="PUNC">=</span><span class="NAME">Box2D.parseUInt</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">K.Clamp</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._b</span><span class="PUNC">=</span><span class="NAME">Box2D.parseUInt</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">K.Clamp</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">F.prototype</span><span class="PUNC">,</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._r</span><span class="PUNC">=</span><span class="NAME">Box2D.parseUInt</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">K.Clamp</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">F.prototype</span><span class="PUNC">,</span><span class="STRN">"g"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._g</span><span class="PUNC">=</span><span class="NAME">Box2D.parseUInt</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">K.Clamp</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">F.prototype</span><span class="PUNC">,</span><span class="STRN">"b"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>137</span> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._b</span><span class="PUNC">=</span><span class="NAME">Box2D.parseUInt</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">K.Clamp</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">F.prototype</span><span class="PUNC">,</span><span class="STRN">"color"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enumerable</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">configurable</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="NAME">get</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._r</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">16</span><span class="PUNC">|</span><span class="NAME">this._g</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">8</span><span class="PUNC">|</span><span class="NAME">this._b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">G.b2Settings</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.b2MixFriction</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.b2MixRestitution</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">></span><span class="NAME">w</span><span class="PUNC">?</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.b2Assert</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">y</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="STRN">"Assertion Failed"</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Common.b2Settings.VERSION</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>138</span> </span><span class="STRN">"2.1alpha"</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.USHRT_MAX</span><span class="PUNC">=</span><span class="NUMB">65535</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_pi</span><span class="PUNC">=</span><span class="NAME">Math.PI</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_maxManifoldPoints</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_aabbExtension</span><span class="PUNC">=</span><span class="NUMB">0.1</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_aabbMultiplier</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_polygonRadius</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">G.b2_linearSlop</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_linearSlop</span><span class="PUNC">=</span><span class="NUMB">0.0050</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_angularSlop</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="PUNC">*</span><span class="NAME">G.b2_pi</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_toiSlop</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">*</span><span class="NAME">G.b2_linearSlop</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland</span><span class="PUNC">=</span><span class="NUMB">32</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>139</span> </span><span class="NUMB">32</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_velocityThreshold</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_maxLinearCorrection</span><span class="PUNC">=</span><span class="NUMB">0.2</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_maxAngularCorrection</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="PUNC">*</span><span class="NAME">G.b2_pi</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_maxTranslation</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_maxTranslationSquared</span><span class="PUNC">=</span><span class="NAME">G.b2_maxTranslation</span><span class="PUNC">*</span><span class="NAME">G.b2_maxTranslation</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_maxRotation</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">G.b2_pi</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_maxRotationSquared</span><span class="PUNC">=</span><span class="NAME">G.b2_maxRotation</span><span class="PUNC">*</span><span class="NAME">G.b2_maxRotation</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_contactBaumgarte</span><span class="PUNC">=</span><span class="NUMB">0.2</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_timeToSleep</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>140</span> </span><span class="NUMB">0.5</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_linearSleepTolerance</span><span class="PUNC">=</span><span class="NUMB">0.01</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.b2Settings.b2_angularSleepTolerance</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="PUNC">*</span><span class="NAME">G.b2_pi</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>141</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Mat22</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Mat33</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Math</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Sweep</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Transform</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Vec2</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Vec3</span><span class="PUNC">;</span><span class="NAME">F.b2Mat22</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.col2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.b2Mat22</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.SetIdentity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.FromAngle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">;</span><span class="NAME">B.Set</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.FromVV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">;</span><span class="NAME">Q.SetVV</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>142</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.col1.x</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">this.col2.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.col1.y</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.col2.y</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.SetVV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1.SetV</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.col2.SetV</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.Copy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">;</span><span class="NAME">p.SetM</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.SetM</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1.SetV</span><span class="PUNC">(</span><span class="NAME">p.col1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.col2.SetV</span><span class="PUNC">(</span><span class="NAME">p.col2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.AddM</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.col1.x</span><span class="PUNC">;</span><span class="NAME">this.col1.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.col1.y</span><span class="PUNC">;</span><span class="NAME">this.col2.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.col2.x</span><span class="PUNC">;</span><span class="NAME">this.col2.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.col2.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.SetIdentity</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1.x</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.col2.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col1.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col2.y</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>143</span> </span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.SetZero</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col2.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col1.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col2.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.GetAngle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">this.col1.y</span><span class="PUNC">,</span><span class="NAME">this.col1.x</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.GetInverse</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.col1.x</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">this.col2.x</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">this.col1.y</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">this.col2.y</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">*</span><span class="NAME">M</span><span class="PUNC">-</span><span class="NAME">Q</span><span class="PUNC">*</span><span class="NAME">V</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">L</span><span class="PUNC">;</span><span class="NAME">p.col1.x</span><span class="PUNC">=</span><span class="NAME">L</span><span class="PUNC">*</span><span class="NAME">M</span><span class="PUNC">;</span><span class="NAME">p.col2.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">L</span><span class="PUNC">*</span><span class="NAME">Q</span><span class="PUNC">;</span><span class="NAME">p.col1.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">L</span><span class="PUNC">*</span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">p.col2.y</span><span class="PUNC">=</span><span class="NAME">L</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.Solve</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">this.col1.x</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">this.col2.x</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">this.col1.y</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">this.col2.y</span><span class="PUNC">,</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NAME">V</span><span class="PUNC">*</span><span class="NAME">I</span><span class="PUNC">-</span><span class="NAME">M</span><span class="PUNC">*</span><span class="NAME">L</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">W</span><span class="PUNC">!=</span><span class="WHIT">
<span class='line'>144</span> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">W</span><span class="PUNC">;</span><span class="NAME">p.x</span><span class="PUNC">=</span><span class="NAME">W</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">I</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">-</span><span class="NAME">M</span><span class="PUNC">*</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.y</span><span class="PUNC">=</span><span class="NAME">W</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">*</span><span class="NAME">Q</span><span class="PUNC">-</span><span class="NAME">L</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.Abs</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1.Abs</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.col2.Abs</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.b2Mat33</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">;</span><span class="NAME">this.col2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">;</span><span class="NAME">this.col3</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.b2Mat33</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">p</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">B</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.col2.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.col3.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.col1.SetV</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.col2.SetV</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.col3.SetV</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.SetVVV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1.SetV</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.col2.SetV</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.col3.SetV</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>145</span> </span><span class="NAME">G.prototype.Copy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">(</span><span class="NAME">this.col1</span><span class="PUNC">,</span><span class="NAME">this.col2</span><span class="PUNC">,</span><span class="NAME">this.col3</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.SetM</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1.SetV</span><span class="PUNC">(</span><span class="NAME">p.col1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.col2.SetV</span><span class="PUNC">(</span><span class="NAME">p.col2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.col3.SetV</span><span class="PUNC">(</span><span class="NAME">p.col3</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.AddM</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.col1.x</span><span class="PUNC">;</span><span class="NAME">this.col1.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.col1.y</span><span class="PUNC">;</span><span class="NAME">this.col1.z</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.col1.z</span><span class="PUNC">;</span><span class="NAME">this.col2.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.col2.x</span><span class="PUNC">;</span><span class="NAME">this.col2.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.col2.y</span><span class="PUNC">;</span><span class="NAME">this.col2.z</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.col2.z</span><span class="PUNC">;</span><span class="NAME">this.col3.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.col3.x</span><span class="PUNC">;</span><span class="NAME">this.col3.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.col3.y</span><span class="PUNC">;</span><span class="NAME">this.col3.z</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.col3.z</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.SetIdentity</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1.x</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.col2.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col3.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col1.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col2.y</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>146</span> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.col3.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col1.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col2.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col3.z</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.SetZero</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.col1.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col2.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col3.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col1.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col2.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col3.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col1.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col2.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.col3.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.Solve22</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">this.col1.x</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">this.col2.x</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">this.col1.y</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">this.col2.y</span><span class="PUNC">,</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NAME">V</span><span class="PUNC">*</span><span class="NAME">I</span><span class="PUNC">-</span><span class="NAME">M</span><span class="PUNC">*</span><span class="NAME">L</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">W</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">W</span><span class="PUNC">;</span><span class="NAME">p.x</span><span class="PUNC">=</span><span class="NAME">W</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">I</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">-</span><span class="NAME">M</span><span class="PUNC">*</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.y</span><span class="PUNC">=</span><span class="NAME">W</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">*</span><span class="NAME">Q</span><span class="PUNC">-</span><span class="NAME">L</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">G.prototype.Solve33</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>147</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">this.col1.x</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">this.col1.y</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">this.col1.z</span><span class="PUNC">,</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NAME">this.col2.x</span><span class="PUNC">,</span><span class="NAME">Y</span><span class="PUNC">=</span><span class="NAME">this.col2.y</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">this.col2.z</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">this.col3.x</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">this.col3.y</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">this.col3.z</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">M</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Y</span><span class="PUNC">*</span><span class="NAME">D</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">L</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">-</span><span class="NAME">W</span><span class="PUNC">*</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">I</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">W</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">-</span><span class="NAME">Y</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">p.x</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Y</span><span class="PUNC">*</span><span class="NAME">D</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Q</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">-</span><span class="NAME">W</span><span class="PUNC">*</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">V</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">W</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">-</span><span class="NAME">Y</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.y</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">*</span><span class="NAME">D</span><span class="PUNC">-</span><span class="NAME">V</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">L</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">-</span><span class="NAME">B</span><span class="PUNC">*</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">I</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">-</span><span class="NAME">Q</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.z</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Y</span><span class="PUNC">*</span><span class="NAME">V</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">L</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">-</span><span class="NAME">W</span><span class="PUNC">*</span><span class="NAME">V</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">I</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">W</span><span class="PUNC">*</span><span class="NAME">Q</span><span class="PUNC">-</span><span class="NAME">Y</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.b2Math</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.IsValid</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">isFinite</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.Dot</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p.x</span><span class="PUNC">*</span><span class="NAME">B.x</span><span class="PUNC">+</span><span class="NAME">p.y</span><span class="PUNC">*</span><span class="NAME">B.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.CrossVV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p.x</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>148</span> </span><span class="NAME">B.y</span><span class="PUNC">-</span><span class="NAME">p.y</span><span class="PUNC">*</span><span class="NAME">B.x</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.CrossVF</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">*</span><span class="NAME">p.y</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">B</span><span class="PUNC">*</span><span class="NAME">p.x</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.CrossFV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">B.y</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">B.x</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.MulMV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">p.col1.x</span><span class="PUNC">*</span><span class="NAME">B.x</span><span class="PUNC">+</span><span class="NAME">p.col2.x</span><span class="PUNC">*</span><span class="NAME">B.y</span><span class="PUNC">,</span><span class="NAME">p.col1.y</span><span class="PUNC">*</span><span class="NAME">B.x</span><span class="PUNC">+</span><span class="NAME">p.col2.y</span><span class="PUNC">*</span><span class="NAME">B.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.MulTMV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">K.Dot</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">p.col1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.Dot</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">p.col2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.MulX</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">K.MulMV</span><span class="PUNC">(</span><span class="NAME">p.R</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Q.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.position.x</span><span class="PUNC">;</span><span class="NAME">Q.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.position.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.MulXT</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">K.SubtractVV</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">p.position</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">Q.x</span><span class="PUNC">*</span><span class="NAME">p.R.col1.x</span><span class="PUNC">+</span><span class="NAME">Q.y</span><span class="PUNC">*</span><span class="NAME">p.R.col1.y</span><span class="PUNC">;</span><span class="NAME">Q.y</span><span class="PUNC">=</span><span class="NAME">Q.x</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>149</span> </span><span class="NAME">p.R.col2.x</span><span class="PUNC">+</span><span class="NAME">Q.y</span><span class="PUNC">*</span><span class="NAME">p.R.col2.y</span><span class="PUNC">;</span><span class="NAME">Q.x</span><span class="PUNC">=</span><span class="NAME">V</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.AddVV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">p.x</span><span class="PUNC">+</span><span class="NAME">B.x</span><span class="PUNC">,</span><span class="NAME">p.y</span><span class="PUNC">+</span><span class="NAME">B.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.SubtractVV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">p.x</span><span class="PUNC">-</span><span class="NAME">B.x</span><span class="PUNC">,</span><span class="NAME">p.y</span><span class="PUNC">-</span><span class="NAME">B.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.Distance</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">p.x</span><span class="PUNC">-</span><span class="NAME">B.x</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">p.y</span><span class="PUNC">-</span><span class="NAME">B.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">*</span><span class="NAME">Q</span><span class="PUNC">+</span><span class="NAME">V</span><span class="PUNC">*</span><span class="NAME">V</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.DistanceSquared</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">p.x</span><span class="PUNC">-</span><span class="NAME">B.x</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">p.y</span><span class="PUNC">-</span><span class="NAME">B.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">*</span><span class="NAME">Q</span><span class="PUNC">+</span><span class="NAME">V</span><span class="PUNC">*</span><span class="NAME">V</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.MulFV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">B.x</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">B.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.AddMM</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">F.FromVV</span><span class="PUNC">(</span><span class="NAME">K.AddVV</span><span class="PUNC">(</span><span class="NAME">p.col1</span><span class="PUNC">,</span><span class="NAME">B.col1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.AddVV</span><span class="PUNC">(</span><span class="NAME">p.col2</span><span class="PUNC">,</span><span class="NAME">B.col2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.MulMM</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">F.FromVV</span><span class="PUNC">(</span><span class="NAME">K.MulMV</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>150</span> </span><span class="NAME">B.col1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.MulMV</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B.col2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.MulTMM</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">K.Dot</span><span class="PUNC">(</span><span class="NAME">p.col1</span><span class="PUNC">,</span><span class="NAME">B.col1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.Dot</span><span class="PUNC">(</span><span class="NAME">p.col2</span><span class="PUNC">,</span><span class="NAME">B.col1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">K.Dot</span><span class="PUNC">(</span><span class="NAME">p.col1</span><span class="PUNC">,</span><span class="NAME">B.col2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.Dot</span><span class="PUNC">(</span><span class="NAME">p.col2</span><span class="PUNC">,</span><span class="NAME">B.col2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">F.FromVV</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.Abs</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NAME">p</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.AbsV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">K.Abs</span><span class="PUNC">(</span><span class="NAME">p.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.Abs</span><span class="PUNC">(</span><span class="NAME">p.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.AbsM</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">F.FromVV</span><span class="PUNC">(</span><span class="NAME">K.AbsV</span><span class="PUNC">(</span><span class="NAME">p.col1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.AbsV</span><span class="PUNC">(</span><span class="NAME">p.col2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.Min</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">&lt;</span><span class="NAME">B</span><span class="PUNC">?</span><span class="NAME">p</span><span class="PUNC">:</span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.MinV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">K.Min</span><span class="PUNC">(</span><span class="NAME">p.x</span><span class="PUNC">,</span><span class="NAME">B.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.Min</span><span class="PUNC">(</span><span class="NAME">p.y</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>151</span> </span><span class="NAME">K.Max</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">></span><span class="NAME">B</span><span class="PUNC">?</span><span class="NAME">p</span><span class="PUNC">:</span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.MaxV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">K.Max</span><span class="PUNC">(</span><span class="NAME">p.x</span><span class="PUNC">,</span><span class="NAME">B.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.Max</span><span class="PUNC">(</span><span class="NAME">p.y</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.Clamp</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">&lt;</span><span class="NAME">B</span><span class="PUNC">?</span><span class="NAME">B</span><span class="PUNC">:</span><span class="NAME">p</span><span class="PUNC">></span><span class="NAME">Q</span><span class="PUNC">?</span><span class="NAME">Q</span><span class="PUNC">:</span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.ClampV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">K.MaxV</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">K.MinV</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.Swap</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Q</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.Random</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NUMB">2</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.RandomRange</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>152</span> </span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Q</span><span class="PUNC">+</span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.NextPowerOfTwo</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">>></span><span class="NUMB">1</span><span class="PUNC">&</span><span class="NUMB">2147483647</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">>></span><span class="NUMB">2</span><span class="PUNC">&</span><span class="NUMB">1073741823</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">>></span><span class="NUMB">4</span><span class="PUNC">&</span><span class="NUMB">268435455</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">>></span><span class="NUMB">8</span><span class="PUNC">&</span><span class="NUMB">16777215</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">>></span><span class="NUMB">16</span><span class="PUNC">&</span><span class="NUMB">65535</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">K.IsPowerOfTwo</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">&</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Common.Math.b2Math.b2Vec2_zero</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.Math.b2Math.b2Mat22_identity</span><span class="PUNC">=</span><span class="NAME">F.FromVV</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.Common.Math.b2Math.b2Transform_identity</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">K.b2Vec2_zero</span><span class="PUNC">,</span><span class="NAME">K.b2Mat22_identity</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.b2Sweep</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.localCenter</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>153</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.c0</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.localCenter.SetV</span><span class="PUNC">(</span><span class="NAME">p.localCenter</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.c0.SetV</span><span class="PUNC">(</span><span class="NAME">p.c0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.c.SetV</span><span class="PUNC">(</span><span class="NAME">p.c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.a0</span><span class="PUNC">=</span><span class="NAME">p.a0</span><span class="PUNC">;</span><span class="NAME">this.a</span><span class="PUNC">=</span><span class="NAME">p.a</span><span class="PUNC">;</span><span class="NAME">this.t0</span><span class="PUNC">=</span><span class="NAME">p.t0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.Copy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="NAME">p.localCenter.SetV</span><span class="PUNC">(</span><span class="NAME">this.localCenter</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.c0.SetV</span><span class="PUNC">(</span><span class="NAME">this.c0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.c.SetV</span><span class="PUNC">(</span><span class="NAME">this.c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.a0</span><span class="PUNC">=</span><span class="NAME">this.a0</span><span class="PUNC">;</span><span class="NAME">p.a</span><span class="PUNC">=</span><span class="NAME">this.a</span><span class="PUNC">;</span><span class="NAME">p.t0</span><span class="PUNC">=</span><span class="NAME">this.t0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.GetTransform</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">p.position.x</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.c0.x</span><span class="PUNC">+</span><span class="NAME">B</span><span class="PUNC">*</span><span class="NAME">this.c.x</span><span class="PUNC">;</span><span class="NAME">p.position.y</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.c0.y</span><span class="PUNC">+</span><span class="NAME">B</span><span class="PUNC">*</span><span class="NAME">this.c.y</span><span class="PUNC">;</span><span class="NAME">p.R.Set</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.a0</span><span class="PUNC">+</span><span class="NAME">B</span><span class="PUNC">*</span><span class="NAME">this.a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>154</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">p.R</span><span class="PUNC">;</span><span class="NAME">p.position.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">Q.col1.x</span><span class="PUNC">*</span><span class="NAME">this.localCenter.x</span><span class="PUNC">+</span><span class="NAME">Q.col2.x</span><span class="PUNC">*</span><span class="NAME">this.localCenter.y</span><span class="PUNC">;</span><span class="NAME">p.position.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">Q.col1.y</span><span class="PUNC">*</span><span class="NAME">this.localCenter.x</span><span class="PUNC">+</span><span class="NAME">Q.col2.y</span><span class="PUNC">*</span><span class="NAME">this.localCenter.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">y.prototype.Advance</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.t0</span><span class="PUNC">&lt;</span><span class="NAME">p</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">this.t0</span><span class="PUNC">></span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">this.t0</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">this.t0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.c0.x</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.c0.x</span><span class="PUNC">+</span><span class="NAME">B</span><span class="PUNC">*</span><span class="NAME">this.c.x</span><span class="PUNC">;</span><span class="NAME">this.c0.y</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.c0.y</span><span class="PUNC">+</span><span class="NAME">B</span><span class="PUNC">*</span><span class="NAME">this.c.y</span><span class="PUNC">;</span><span class="NAME">this.a0</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.a0</span><span class="PUNC">+</span><span class="NAME">B</span><span class="PUNC">*</span><span class="NAME">this.a</span><span class="PUNC">;</span><span class="NAME">this.t0</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.b2Transform</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.position</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.R</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.prototype.b2Transform</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>155</span> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.position.SetV</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.R.SetM</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.prototype.Initialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.position.SetV</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.R.SetM</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.prototype.SetIdentity</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.position.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.R.SetIdentity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.position.SetV</span><span class="PUNC">(</span><span class="NAME">p.position</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.R.SetM</span><span class="PUNC">(</span><span class="NAME">p.R</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.prototype.GetAngle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">this.R.col1.y</span><span class="PUNC">,</span><span class="NAME">this.R.col1.x</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.b2Vec2</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.b2Vec2</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>156</span> </span><span class="NAME">A.prototype.SetZero</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.SetV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">p.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">p.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.GetNegative</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.NegativeSelf</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.Make</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Copy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Add</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>157</span> </span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Subtract</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">p.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">p.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Multiply</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.MulM</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">p.col1.x</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">+</span><span class="NAME">p.col2.x</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">p.col1.y</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">+</span><span class="NAME">p.col2.y</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.MulTM</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">K.Dot</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">p.col1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">K.Dot</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">p.col2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.CrossVF</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.CrossFV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>158</span> </span><span class="NAME">this.x</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.MinV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">&lt;</span><span class="NAME">p.x</span><span class="PUNC">?</span><span class="NAME">this.x</span><span class="PUNC">:</span><span class="NAME">p.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">&lt;</span><span class="NAME">p.y</span><span class="PUNC">?</span><span class="NAME">this.y</span><span class="PUNC">:</span><span class="NAME">p.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.MaxV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">></span><span class="NAME">p.x</span><span class="PUNC">?</span><span class="NAME">this.x</span><span class="PUNC">:</span><span class="NAME">p.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">></span><span class="NAME">p.y</span><span class="PUNC">?</span><span class="NAME">this.y</span><span class="PUNC">:</span><span class="NAME">p.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Abs</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.x</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Length</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.LengthSquared</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Normalize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>159</span> </span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">&lt;</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.IsValid</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">K.IsValid</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">K.IsValid</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.b2Vec3</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.b2Vec3</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">Q</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.SetZero</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">Q</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.SetV</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>160</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">p.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">p.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">p.z</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.GetNegative</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">this.z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.NegativeSelf</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.z</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.Copy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">this.z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.Add</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.z</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.Subtract</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">p.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">p.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">p.z</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.Multiply</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>161</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Math</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Sweep</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Transform</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Vec2</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.b2Color</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.b2Settings</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2AABB</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2ContactPoint</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2DynamicTreeBroadPhase</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2RayCastInput</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2RayCastOutput</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2CircleShape</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2EdgeShape</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2MassData</span><span class="PUNC">,</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2PolygonShape</span><span class="PUNC">,</span><span class="NAME">Y</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2Shape</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>162</span> </span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2Body</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2BodyDef</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2ContactFilter</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2ContactImpulse</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2ContactListener</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2ContactManager</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2DebugDraw</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2DestructionListener</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2FilterData</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2Fixture</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2FixtureDef</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2Island</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2TimeStep</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2World</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactFactory</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>163</span> </span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactSolver</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2PulleyJoint</span><span class="PUNC">;</span><span class="NAME">k.b2Body</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_xf</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">this.m_sweep</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">this.m_linearVelocity</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="NAME">this.m_force</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.connectEdges</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">c.GetDirectionVector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">c.GetDirectionVector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">F.MulFV</span><span class="PUNC">(</span><span class="NAME">Math.tan</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.GetDirectionVector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">F.SubtractVV</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">c.GetNormalVector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">F.MulFV</span><span class="PUNC">(</span><span class="NAME">A.b2_toiSlop</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">F.AddVV</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">c.GetVertex1</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">F.AddVV</span><span class="PUNC">(</span><span class="NAME">a.GetDirectionVector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>164</span> </span><span class="NAME">c.GetDirectionVector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">F.Dot</span><span class="PUNC">(</span><span class="NAME">a.GetDirectionVector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.GetNormalVector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a.SetNextEdge</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.SetPrevEdge</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.CreateFixture</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_world.IsLocked</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">;</span><span class="NAME">c.Create</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.m_xf</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_activeFlag</span><span class="PUNC">&&</span><span class="NAME">c.CreateProxy</span><span class="PUNC">(</span><span class="NAME">this.m_world.m_contactManager.m_broadPhase</span><span class="PUNC">,</span><span class="NAME">this.m_xf</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.m_next</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureList</span><span class="PUNC">;</span><span class="NAME">this.m_fixtureList</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">this.m_fixtureCount</span><span class="PUNC">;</span><span class="NAME">c.m_body</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">c.m_density</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">this.ResetMassData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_world.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>165</span> </span><span class="NAME">h.e_newFixture</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.CreateFixture2</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">aa</span><span class="PUNC">;</span><span class="NAME">g.shape</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">g.density</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.CreateFixture</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.DestroyFixture</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_world.IsLocked</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureList</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="NAME">g.m_next</span><span class="PUNC">=</span><span class="NAME">a.m_next</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_fixtureList</span><span class="PUNC">=</span><span class="NAME">a.m_next</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_next</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_contactList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c.contact</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.next</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">g.GetFixtureA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g.GetFixtureB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">)</span><span class="NAME">this.m_world.m_contactManager.Destroy</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="WHIT">
<span class='line'>166</span> </span><span class="NAME">k.e_activeFlag</span><span class="PUNC">&&</span><span class="NAME">a.DestroyProxy</span><span class="PUNC">(</span><span class="NAME">this.m_world.m_contactManager.m_broadPhase</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.Destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.m_body</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a.m_next</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">this.m_fixtureCount</span><span class="PUNC">;</span><span class="NAME">this.ResetMassData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetPositionAndAngle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_world.IsLocked</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_xf.R.Set</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_xf.position.SetV</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_sweep.localCenter</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c.x</span><span class="PUNC">=</span><span class="NAME">g.col1.x</span><span class="PUNC">*</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="NAME">g.col2.x</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c.y</span><span class="PUNC">=</span><span class="NAME">g.col1.y</span><span class="PUNC">*</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="NAME">g.col2.y</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_xf.position.x</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>167</span> </span><span class="NAME">this.m_xf.position.y</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c0.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_sweep.c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.a0</span><span class="PUNC">=</span><span class="NAME">this.m_sweep.a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_world.m_contactManager.m_broadPhase</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureList</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g.m_next</span><span class="PUNC">)</span><span class="NAME">g.Synchronize</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.m_xf</span><span class="PUNC">,</span><span class="NAME">this.m_xf</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_world.m_contactManager.FindNewContacts</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetTransform</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.SetPositionAndAngle</span><span class="PUNC">(</span><span class="NAME">a.position</span><span class="PUNC">,</span><span class="NAME">a.GetAngle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetTransform</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_xf</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetPosition</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_xf.position</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetPosition</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.SetPositionAndAngle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>168</span> </span><span class="NAME">this.GetAngle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetAngle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_sweep.a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetAngle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.SetPositionAndAngle</span><span class="PUNC">(</span><span class="NAME">this.GetPosition</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetWorldCenter</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_sweep.c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetLocalCenter</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_sweep.localCenter</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetLinearVelocity</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_type</span><span class="PUNC">!=</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">&&</span><span class="NAME">this.m_linearVelocity.SetV</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetLinearVelocity</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_linearVelocity</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetAngularVelocity</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>169</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_type</span><span class="PUNC">!=</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">)</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetAngularVelocity</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetDefinition</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">a.type</span><span class="PUNC">=</span><span class="NAME">this.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.allowSleep</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_allowSleepFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.e_allowSleepFlag</span><span class="PUNC">;</span><span class="NAME">a.angle</span><span class="PUNC">=</span><span class="NAME">this.GetAngle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.angularDamping</span><span class="PUNC">=</span><span class="NAME">this.m_angularDamping</span><span class="PUNC">;</span><span class="NAME">a.angularVelocity</span><span class="PUNC">=</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">;</span><span class="NAME">a.fixedRotation</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_fixedRotationFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.e_fixedRotationFlag</span><span class="PUNC">;</span><span class="NAME">a.bullet</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="WHIT">
<span class='line'>170</span> </span><span class="NAME">k.e_bulletFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.e_bulletFlag</span><span class="PUNC">;</span><span class="NAME">a.awake</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_awakeFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.e_awakeFlag</span><span class="PUNC">;</span><span class="NAME">a.linearDamping</span><span class="PUNC">=</span><span class="NAME">this.m_linearDamping</span><span class="PUNC">;</span><span class="NAME">a.linearVelocity.SetV</span><span class="PUNC">(</span><span class="NAME">this.GetLinearVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.position</span><span class="PUNC">=</span><span class="NAME">this.GetPosition</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.userData</span><span class="PUNC">=</span><span class="NAME">this.GetUserData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.ApplyForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_type</span><span class="PUNC">==</span><span class="NAME">k.b2_dynamicBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">&&</span><span class="NAME">this.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_force.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.m_force.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">this.m_torque</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">-</span><span class="NAME">this.m_sweep.c.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">c.y</span><span class="PUNC">-</span><span class="NAME">this.m_sweep.c.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.ApplyTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>171</span> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_type</span><span class="PUNC">==</span><span class="NAME">k.b2_dynamicBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">&&</span><span class="NAME">this.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_torque</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.ApplyImpulse</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_type</span><span class="PUNC">==</span><span class="NAME">k.b2_dynamicBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">&&</span><span class="NAME">this.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMass</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMass</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">-</span><span class="NAME">this.m_sweep.c.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">c.y</span><span class="PUNC">-</span><span class="NAME">this.m_sweep.c.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.Split</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.GetLinearVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.GetAngularVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>172</span> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.GetWorldCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_world.CreateBody</span><span class="PUNC">(</span><span class="NAME">this.GetDefinition</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureList</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">m.m_next</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="NAME">f.m_next</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_fixtureList</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">this.m_fixtureCount</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="NAME">m.m_next</span><span class="PUNC">=</span><span class="NAME">e.m_fixtureList</span><span class="PUNC">;</span><span class="NAME">e.m_fixtureList</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">e.m_fixtureCount</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">m.m_body</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">m.m_next</span><span class="PUNC">}</span><span class="NAME">this.ResetMassData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.ResetMassData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.GetWorldCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">e.GetWorldCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">F.AddVV</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">F.CrossFV</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">F.SubtractVV</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">F.AddVV</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">F.CrossFV</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">F.SubtractVV</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.SetLinearVelocity</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.SetLinearVelocity</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>173</span> </span><span class="NAME">this.SetAngularVelocity</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.SetAngularVelocity</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.SynchronizeFixtures</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.SynchronizeFixtures</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.Merge</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.m_fixtureList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c.m_next</span><span class="PUNC">;</span><span class="NAME">a.m_fixtureCount</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="NAME">c.m_next</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureList</span><span class="PUNC">;</span><span class="NAME">this.m_fixtureList</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.m_fixtureCount</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">c.m_body</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">}</span><span class="NAME">b.m_fixtureCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b.GetWorldCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.GetWorldCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.GetLinearVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.GetLinearVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.GetAngularVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.GetAngularVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.ResetMassData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.SynchronizeFixtures</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>174</span> </span><span class="NAME">k.prototype.GetMass</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_mass</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetInertia</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_I</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetMassData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.mass</span><span class="PUNC">=</span><span class="NAME">this.m_mass</span><span class="PUNC">;</span><span class="NAME">a.I</span><span class="PUNC">=</span><span class="NAME">this.m_I</span><span class="PUNC">;</span><span class="NAME">a.center.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_sweep.localCenter</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetMassData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.b2Assert</span><span class="PUNC">(</span><span class="NAME">this.m_world.IsLocked</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_world.IsLocked</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_type</span><span class="PUNC">==</span><span class="NAME">k.b2_dynamicBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_invI</span><span class="PUNC">=</span><span class="NAME">this.m_I</span><span class="PUNC">=</span><span class="NAME">this.m_invMass</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="NAME">a.mass</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_mass</span><span class="PUNC">&lt;=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.m_invMass</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.m_mass</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.I</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_fixedRotationFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>175</span> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_I</span><span class="PUNC">=</span><span class="NAME">a.I</span><span class="PUNC">-</span><span class="NAME">this.m_mass</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.center.x</span><span class="PUNC">*</span><span class="NAME">a.center.x</span><span class="PUNC">+</span><span class="NAME">a.center.y</span><span class="PUNC">*</span><span class="NAME">a.center.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_invI</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.m_I</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_sweep.c.Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.localCenter.SetV</span><span class="PUNC">(</span><span class="NAME">a.center</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c0.SetV</span><span class="PUNC">(</span><span class="NAME">F.MulX</span><span class="PUNC">(</span><span class="NAME">this.m_xf</span><span class="PUNC">,</span><span class="NAME">this.m_sweep.localCenter</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_sweep.c0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_sweep.c.y</span><span class="PUNC">-</span><span class="NAME">c.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">*</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_sweep.c.x</span><span class="PUNC">-</span><span class="NAME">c.x</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.ResetMassData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_invI</span><span class="PUNC">=</span><span class="NAME">this.m_I</span><span class="PUNC">=</span><span class="NAME">this.m_invMass</span><span class="PUNC">=</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.localCenter.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>176</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">this.m_type</span><span class="PUNC">==</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">||</span><span class="NAME">this.m_type</span><span class="PUNC">==</span><span class="NAME">k.b2_kinematicBody</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">y.Make</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_next</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.m_density</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c.GetMassData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_mass</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">g.mass</span><span class="PUNC">;</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">g.center.x</span><span class="PUNC">*</span><span class="NAME">g.mass</span><span class="PUNC">;</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">g.center.y</span><span class="PUNC">*</span><span class="NAME">g.mass</span><span class="PUNC">;</span><span class="NAME">this.m_I</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">g.I</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_mass</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_invMass</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.m_mass</span><span class="PUNC">;</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">this.m_invMass</span><span class="PUNC">;</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">this.m_invMass</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_invMass</span><span class="PUNC">=</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_I</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_fixedRotationFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_I</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_mass</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_I</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">this.m_inertiaScale</span><span class="PUNC">;</span><span class="NAME">A.b2Assert</span><span class="PUNC">(</span><span class="NAME">this.m_I</span><span class="PUNC">></span><span class="WHIT">
<span class='line'>177</span> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_invI</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.m_I</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_invI</span><span class="PUNC">=</span><span class="NAME">this.m_I</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_sweep.c.Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.localCenter.SetV</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c0.SetV</span><span class="PUNC">(</span><span class="NAME">F.MulX</span><span class="PUNC">(</span><span class="NAME">this.m_xf</span><span class="PUNC">,</span><span class="NAME">this.m_sweep.localCenter</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_sweep.c0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_sweep.c.y</span><span class="PUNC">-</span><span class="NAME">c.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">*</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_sweep.c.x</span><span class="PUNC">-</span><span class="NAME">c.x</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetWorldPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_xf.R</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">(</span><span class="NAME">c.col1.x</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">c.col2.x</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">c.col1.y</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">c.col2.y</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_xf.position.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>178</span> </span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_xf.position.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetWorldVector</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">F.MulMV</span><span class="PUNC">(</span><span class="NAME">this.m_xf.R</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetLocalPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">F.MulXT</span><span class="PUNC">(</span><span class="NAME">this.m_xf</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetLocalVector</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">F.MulTMV</span><span class="PUNC">(</span><span class="NAME">this.m_xf.R</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetLinearVelocityFromWorldPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">(</span><span class="NAME">this.m_linearVelocity.x</span><span class="PUNC">-</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">this.m_sweep.c.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.m_linearVelocity.y</span><span class="PUNC">+</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">this.m_sweep.c.x</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetLinearVelocityFromLocalPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>179</span> </span><span class="NAME">this.m_xf.R</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">(</span><span class="NAME">c.col1.x</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">c.col2.x</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">c.col1.y</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">c.col2.y</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_xf.position.x</span><span class="PUNC">;</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_xf.position.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">(</span><span class="NAME">this.m_linearVelocity.x</span><span class="PUNC">-</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">this.m_sweep.c.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.m_linearVelocity.y</span><span class="PUNC">+</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">this.m_sweep.c.x</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetLinearDamping</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_linearDamping</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetLinearDamping</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_linearDamping</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetAngularDamping</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_angularDamping</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>180</span> </span><span class="NAME">k.prototype.SetAngularDamping</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_angularDamping</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetType</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_type</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.ResetMassData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_type</span><span class="PUNC">==</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_linearVelocity.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="NAME">this.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_force.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_torque</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_contactList</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.next</span><span class="PUNC">)</span><span class="NAME">a.contact.FlagForFiltering</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetType</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_type</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetBullet</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>181</span> </span><span class="NAME">k.e_bulletFlag</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">k.e_bulletFlag</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.IsBullet</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_bulletFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.e_bulletFlag</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetSleepingAllowed</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_allowSleepFlag</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">k.e_allowSleepFlag</span><span class="PUNC">;</span><span class="NAME">this.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetAwake</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_awakeFlag</span><span class="PUNC">;</span><span class="NAME">this.m_sleepTime</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">k.e_awakeFlag</span><span class="PUNC">;</span><span class="NAME">this.m_sleepTime</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_linearVelocity.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_force.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_torque</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>182</span> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.IsAwake</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_awakeFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.e_awakeFlag</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetFixedRotation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_fixedRotationFlag</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">k.e_fixedRotationFlag</span><span class="PUNC">;</span><span class="NAME">this.ResetMassData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.IsFixedRotation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_fixedRotationFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.e_fixedRotationFlag</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetActive</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">!=</span><span class="NAME">this.IsActive</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_activeFlag</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_world.m_contactManager.m_broadPhase</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>183</span> </span><span class="NAME">c.m_next</span><span class="PUNC">)</span><span class="NAME">c.CreateProxy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.m_xf</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">k.e_activeFlag</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_world.m_contactManager.m_broadPhase</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_next</span><span class="PUNC">)</span><span class="NAME">c.DestroyProxy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_contactList</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.next</span><span class="PUNC">;</span><span class="NAME">this.m_world.m_contactManager.Destroy</span><span class="PUNC">(</span><span class="NAME">c.contact</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.m_contactList</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.IsActive</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_activeFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.e_activeFlag</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.IsSleepingAllowed</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_allowSleepFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.e_allowSleepFlag</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetFixtureList</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>184</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_fixtureList</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetJointList</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_jointList</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetControllerList</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_controllerList</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetContactList</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_contactList</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetNext</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_next</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetUserData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_userData</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetUserData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_userData</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetWorld</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_world</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.b2Body</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_flags</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>185</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.bullet</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_bulletFlag</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.fixedRotation</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_fixedRotationFlag</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.allowSleep</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_allowSleepFlag</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.awake</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_awakeFlag</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.active</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_activeFlag</span><span class="PUNC">;</span><span class="NAME">this.m_world</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.m_xf.position.SetV</span><span class="PUNC">(</span><span class="NAME">a.position</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_xf.R.Set</span><span class="PUNC">(</span><span class="NAME">a.angle</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.localCenter.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.t0</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.a0</span><span class="PUNC">=</span><span class="NAME">this.m_sweep.a</span><span class="PUNC">=</span><span class="NAME">a.angle</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_xf.R</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_sweep.localCenter</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c.x</span><span class="PUNC">=</span><span class="NAME">g.col1.x</span><span class="PUNC">*</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="NAME">g.col2.x</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c.y</span><span class="PUNC">=</span><span class="NAME">g.col1.y</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>186</span> </span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="NAME">g.col2.y</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_xf.position.x</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_xf.position.y</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c0.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_sweep.c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_contactList</span><span class="PUNC">=</span><span class="NAME">this.m_controllerList</span><span class="PUNC">=</span><span class="NAME">this.m_jointList</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_controllerCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_next</span><span class="PUNC">=</span><span class="NAME">this.m_prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_linearVelocity.SetV</span><span class="PUNC">(</span><span class="NAME">a.linearVelocity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">a.angularVelocity</span><span class="PUNC">;</span><span class="NAME">this.m_linearDamping</span><span class="PUNC">=</span><span class="NAME">a.linearDamping</span><span class="PUNC">;</span><span class="NAME">this.m_angularDamping</span><span class="PUNC">=</span><span class="NAME">a.angularDamping</span><span class="PUNC">;</span><span class="NAME">this.m_force.Set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_sleepTime</span><span class="PUNC">=</span><span class="NAME">this.m_torque</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NAME">a.type</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_type</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>187</span> </span><span class="NAME">k.b2_dynamicBody</span><span class="PUNC">)</span><span class="NAME">this.m_invMass</span><span class="PUNC">=</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_invMass</span><span class="PUNC">=</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_invI</span><span class="PUNC">=</span><span class="NAME">this.m_I</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_inertiaScale</span><span class="PUNC">=</span><span class="NAME">a.inertiaScale</span><span class="PUNC">;</span><span class="NAME">this.m_userData</span><span class="PUNC">=</span><span class="NAME">a.userData</span><span class="PUNC">;</span><span class="NAME">this.m_fixtureList</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_fixtureCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SynchronizeFixtures</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">k.s_xf1</span><span class="PUNC">;</span><span class="NAME">a.R.Set</span><span class="PUNC">(</span><span class="NAME">this.m_sweep.a0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.R</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_sweep.localCenter</span><span class="PUNC">;</span><span class="NAME">a.position.x</span><span class="PUNC">=</span><span class="NAME">this.m_sweep.c0.x</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">c.col1.x</span><span class="PUNC">*</span><span class="NAME">g.x</span><span class="PUNC">+</span><span class="NAME">c.col2.x</span><span class="PUNC">*</span><span class="NAME">g.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.position.y</span><span class="PUNC">=</span><span class="NAME">this.m_sweep.c0.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">c.col1.y</span><span class="PUNC">*</span><span class="NAME">g.x</span><span class="PUNC">+</span><span class="NAME">c.col2.y</span><span class="PUNC">*</span><span class="NAME">g.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_world.m_contactManager.m_broadPhase</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>188</span> </span><span class="NAME">c.m_next</span><span class="PUNC">)</span><span class="NAME">c.Synchronize</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.m_xf</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SynchronizeTransform</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_xf.R.Set</span><span class="PUNC">(</span><span class="NAME">this.m_sweep.a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_xf.R</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_sweep.localCenter</span><span class="PUNC">;</span><span class="NAME">this.m_xf.position.x</span><span class="PUNC">=</span><span class="NAME">this.m_sweep.c.x</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a.col1.x</span><span class="PUNC">*</span><span class="NAME">c.x</span><span class="PUNC">+</span><span class="NAME">a.col2.x</span><span class="PUNC">*</span><span class="NAME">c.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_xf.position.y</span><span class="PUNC">=</span><span class="NAME">this.m_sweep.c.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a.col1.y</span><span class="PUNC">*</span><span class="NAME">c.x</span><span class="PUNC">+</span><span class="NAME">a.col2.y</span><span class="PUNC">*</span><span class="NAME">c.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.ShouldCollide</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_type</span><span class="PUNC">!=</span><span class="NAME">k.b2_dynamicBody</span><span class="PUNC">&&</span><span class="NAME">a.m_type</span><span class="PUNC">!=</span><span class="NAME">k.b2_dynamicBody</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_jointList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.next</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.other</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.joint.m_collideConnected</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>189</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.Advance</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.Advance</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.c.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_sweep.c0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_sweep.a</span><span class="PUNC">=</span><span class="NAME">this.m_sweep.a0</span><span class="PUNC">;</span><span class="NAME">this.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.b2Body.s_xf1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2Body.e_islandFlag</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2Body.e_awakeFlag</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2Body.e_allowSleepFlag</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2Body.e_bulletFlag</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2Body.e_fixedRotationFlag</span><span class="PUNC">=</span><span class="NUMB">16</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2Body.e_activeFlag</span><span class="PUNC">=</span><span class="NUMB">32</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2Body.b2_staticBody</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>190</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2Body.b2_kinematicBody</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2Body.b2_dynamicBody</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">z.b2BodyDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.position</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="NAME">this.linearVelocity</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">z.prototype.b2BodyDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.userData</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.position.Set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.angle</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.linearVelocity.Set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.angularDamping</span><span class="PUNC">=</span><span class="NAME">this.linearDamping</span><span class="PUNC">=</span><span class="NAME">this.angularVelocity</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.awake</span><span class="PUNC">=</span><span class="NAME">this.allowSleep</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">this.bullet</span><span class="PUNC">=</span><span class="NAME">this.fixedRotation</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">;</span><span class="NAME">this.active</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">this.inertiaScale</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.b2ContactFilter</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.ShouldCollide</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>191</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.GetFilterData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c.GetFilterData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g.groupIndex</span><span class="PUNC">==</span><span class="NAME">b.groupIndex</span><span class="PUNC">&&</span><span class="NAME">g.groupIndex</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">g.groupIndex</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">g.maskBits</span><span class="PUNC">&</span><span class="NAME">b.categoryBits</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.categoryBits</span><span class="PUNC">&</span><span class="NAME">b.maskBits</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.RayCollide</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ShouldCollide</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.b2ContactFilter.b2_defaultFilter</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.b2ContactImpulse</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.normalImpulses</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector_a2j_Number</span><span class="PUNC">(</span><span class="NAME">A.b2_maxManifoldPoints</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.tangentImpulses</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>192</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector_a2j_Number</span><span class="PUNC">(</span><span class="NAME">A.b2_maxManifoldPoints</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.b2ContactListener</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.BeginContact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.EndContact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.PreSolve</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.PostSolve</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.b2ContactListener.b2_defaultListener</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">O.b2ContactManager</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">O.prototype.b2ContactManager</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_world</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_contactCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_contactFilter</span><span class="PUNC">=</span><span class="NAME">u.b2_defaultFilter</span><span class="PUNC">;</span><span class="NAME">this.m_contactListener</span><span class="PUNC">=</span><span class="NAME">H.b2_defaultListener</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>193</span> </span><span class="NAME">this.m_contactFactory</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">(</span><span class="NAME">this.m_allocator</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_broadPhase</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">O.prototype.AddPair</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">!=</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">f.GetContactList</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m.other</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">m.contact.GetFixtureA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">m.contact.GetFixtureB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">==</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="NAME">s</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">s</span><span class="PUNC">==</span><span class="NAME">g</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">m.next</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f.ShouldCollide</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_contactFilter.ShouldCollide</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.m_contactFactory.Create</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">m.GetFixtureA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">m.GetFixtureB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>194</span> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g.m_body</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.m_body</span><span class="PUNC">;</span><span class="NAME">m.m_prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">m.m_next</span><span class="PUNC">=</span><span class="NAME">this.m_world.m_contactList</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_world.m_contactList</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="NAME">this.m_world.m_contactList.m_prev</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">this.m_world.m_contactList</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">m.m_nodeA.contact</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">m.m_nodeA.other</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">m.m_nodeA.prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">m.m_nodeA.next</span><span class="PUNC">=</span><span class="NAME">e.m_contactList</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.m_contactList</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="NAME">e.m_contactList.prev</span><span class="PUNC">=</span><span class="NAME">m.m_nodeA</span><span class="PUNC">;</span><span class="NAME">e.m_contactList</span><span class="PUNC">=</span><span class="NAME">m.m_nodeA</span><span class="PUNC">;</span><span class="NAME">m.m_nodeB.contact</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">m.m_nodeB.other</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">m.m_nodeB.prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">m.m_nodeB.next</span><span class="PUNC">=</span><span class="NAME">f.m_contactList</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f.m_contactList</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="NAME">f.m_contactList.prev</span><span class="PUNC">=</span><span class="NAME">m.m_nodeB</span><span class="PUNC">;</span><span class="NAME">f.m_contactList</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>195</span> </span><span class="NAME">m.m_nodeB</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">this.m_world.m_contactCount</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">O.prototype.FindNewContacts</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_broadPhase.UpdatePairs</span><span class="PUNC">(</span><span class="NAME">Box2D.generateCallback</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.AddPair</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">O.prototype.Destroy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.GetFixtureA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.GetFixtureB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.IsTouching</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.m_contactListener.EndContact</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_prev</span><span class="PUNC">)</span><span class="NAME">a.m_prev.m_next</span><span class="PUNC">=</span><span class="NAME">a.m_next</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_next</span><span class="PUNC">)</span><span class="NAME">a.m_next.m_prev</span><span class="PUNC">=</span><span class="NAME">a.m_prev</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">this.m_world.m_contactList</span><span class="PUNC">)</span><span class="NAME">this.m_world.m_contactList</span><span class="PUNC">=</span><span class="NAME">a.m_next</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_nodeA.prev</span><span class="PUNC">)</span><span class="NAME">a.m_nodeA.prev.next</span><span class="PUNC">=</span><span class="NAME">a.m_nodeA.next</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>196</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_nodeA.next</span><span class="PUNC">)</span><span class="NAME">a.m_nodeA.next.prev</span><span class="PUNC">=</span><span class="NAME">a.m_nodeA.prev</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_nodeA</span><span class="PUNC">==</span><span class="NAME">c.m_contactList</span><span class="PUNC">)</span><span class="NAME">c.m_contactList</span><span class="PUNC">=</span><span class="NAME">a.m_nodeA.next</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_nodeB.prev</span><span class="PUNC">)</span><span class="NAME">a.m_nodeB.prev.next</span><span class="PUNC">=</span><span class="NAME">a.m_nodeB.next</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_nodeB.next</span><span class="PUNC">)</span><span class="NAME">a.m_nodeB.next.prev</span><span class="PUNC">=</span><span class="NAME">a.m_nodeB.prev</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_nodeB</span><span class="PUNC">==</span><span class="NAME">g.m_contactList</span><span class="PUNC">)</span><span class="NAME">g.m_contactList</span><span class="PUNC">=</span><span class="NAME">a.m_nodeB.next</span><span class="PUNC">;</span><span class="NAME">this.m_contactFactory.Destroy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">this.m_contactCount</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">O.prototype.Collide</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_world.m_contactList</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.GetFixtureA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.GetFixtureB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">&&</span><span class="NAME">e.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>197</span> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.GetNext</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_flags</span><span class="PUNC">&</span><span class="NAME">l.e_filterFlag</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.ShouldCollide</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c.GetNext</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.Destroy</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">continue</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_contactFilter.ShouldCollide</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c.GetNext</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.Destroy</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">continue</span><span class="PUNC">}</span><span class="NAME">a.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">l.e_filterFlag</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_broadPhase.TestOverlap</span><span class="PUNC">(</span><span class="NAME">c.m_proxy</span><span class="PUNC">,</span><span class="NAME">g.m_proxy</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c.GetNext</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.Destroy</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">a.Update</span><span class="PUNC">(</span><span class="NAME">this.m_contactListener</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.GetNext</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.b2ContactManager.s_evalCP</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">E.b2DebugDraw</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>198</span> </span><span class="NAME">E.prototype.b2DebugDraw</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.SetFlags</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetFlags</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.AppendFlags</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.ClearFlags</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.SetSprite</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetSprite</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.SetDrawScale</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetDrawScale</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.SetLineThickness</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetLineThickness</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.SetAlpha</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetAlpha</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.SetFillAlpha</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>199</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetFillAlpha</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.SetXFormScale</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetXFormScale</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.DrawPolygon</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.DrawSolidPolygon</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.DrawCircle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.DrawSolidCircle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.DrawSegment</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.DrawTransform</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.b2DebugDraw.e_shapeBit</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2DebugDraw.e_jointBit</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2DebugDraw.e_aabbBit</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>200</span> </span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2DebugDraw.e_pairBit</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit</span><span class="PUNC">=</span><span class="NUMB">16</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2DebugDraw.e_controllerBit</span><span class="PUNC">=</span><span class="NUMB">32</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">R.b2DestructionListener</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">R.prototype.SayGoodbyeJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">R.prototype.SayGoodbyeFixture</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.b2FilterData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.categoryBits</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.maskBits</span><span class="PUNC">=</span><span class="NUMB">65535</span><span class="PUNC">;</span><span class="NAME">this.groupIndex</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.Copy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">a.categoryBits</span><span class="PUNC">=</span><span class="NAME">this.categoryBits</span><span class="PUNC">;</span><span class="NAME">a.maskBits</span><span class="PUNC">=</span><span class="NAME">this.maskBits</span><span class="PUNC">;</span><span class="NAME">a.groupIndex</span><span class="PUNC">=</span><span class="NAME">this.groupIndex</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.b2Fixture</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_filter</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>201</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.GetType</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_shape.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.GetShape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_shape</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.SetSensor</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_isSensor</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_isSensor</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_body</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_body.GetContactList</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.contact</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c.GetFixtureA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c.GetFixtureB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">==</span><span class="KEYW">this</span><span class="PUNC">||</span><span class="NAME">b</span><span class="PUNC">==</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="NAME">c.SetSensor</span><span class="PUNC">(</span><span class="NAME">g.IsSensor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">b.IsSensor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.next</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.IsSensor</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_isSensor</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.SetFilterData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_filter</span><span class="PUNC">=</span><span class="NAME">a.Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.m_body</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>202</span> </span><span class="NAME">this.m_body.GetContactList</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.contact</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c.GetFixtureA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c.GetFixtureB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">==</span><span class="KEYW">this</span><span class="PUNC">||</span><span class="NAME">b</span><span class="PUNC">==</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="NAME">c.FlagForFiltering</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.next</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.GetFilterData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_filter.Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.GetBody</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_body</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.GetNext</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_next</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.GetUserData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_userData</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.SetUserData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_userData</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.TestPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_shape.TestPoint</span><span class="PUNC">(</span><span class="NAME">this.m_body.GetTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>203</span> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.RayCast</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_shape.RayCast</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this.m_body.GetTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.GetMassData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">I</span><span class="PUNC">;</span><span class="NAME">this.m_shape.ComputeMass</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.m_density</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.SetDensity</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_density</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.GetDensity</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_density</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.GetFriction</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_friction</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.SetFriction</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_friction</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.GetRestitution</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>204</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_restitution</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.SetRestitution</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_restitution</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.GetAABB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_aabb</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.b2Fixture</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_aabb</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">;</span><span class="NAME">this.m_shape</span><span class="PUNC">=</span><span class="NAME">this.m_next</span><span class="PUNC">=</span><span class="NAME">this.m_body</span><span class="PUNC">=</span><span class="NAME">this.m_userData</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_restitution</span><span class="PUNC">=</span><span class="NAME">this.m_friction</span><span class="PUNC">=</span><span class="NAME">this.m_density</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.Create</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_userData</span><span class="PUNC">=</span><span class="NAME">g.userData</span><span class="PUNC">;</span><span class="NAME">this.m_friction</span><span class="PUNC">=</span><span class="NAME">g.friction</span><span class="PUNC">;</span><span class="NAME">this.m_restitution</span><span class="PUNC">=</span><span class="NAME">g.restitution</span><span class="PUNC">;</span><span class="NAME">this.m_body</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.m_next</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_filter</span><span class="PUNC">=</span><span class="NAME">g.filter.Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>205</span> </span><span class="NAME">this.m_isSensor</span><span class="PUNC">=</span><span class="NAME">g.isSensor</span><span class="PUNC">;</span><span class="NAME">this.m_shape</span><span class="PUNC">=</span><span class="NAME">g.shape.Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_density</span><span class="PUNC">=</span><span class="NAME">g.density</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.Destroy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_shape</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.CreateProxy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_shape.ComputeAABB</span><span class="PUNC">(</span><span class="NAME">this.m_aabb</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_proxy</span><span class="PUNC">=</span><span class="NAME">a.CreateProxy</span><span class="PUNC">(</span><span class="NAME">this.m_aabb</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.DestroyProxy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_proxy</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.DestroyProxy</span><span class="PUNC">(</span><span class="NAME">this.m_proxy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_proxy</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.Synchronize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_proxy</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">;</span><span class="NAME">this.m_shape.ComputeAABB</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_shape.ComputeAABB</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>206</span> </span><span class="NAME">this.m_aabb.Combine</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">F.SubtractVV</span><span class="PUNC">(</span><span class="NAME">g.position</span><span class="PUNC">,</span><span class="NAME">c.position</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.MoveProxy</span><span class="PUNC">(</span><span class="NAME">this.m_proxy</span><span class="PUNC">,</span><span class="NAME">this.m_aabb</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">aa.b2FixtureDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.filter</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">aa.prototype.b2FixtureDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.userData</span><span class="PUNC">=</span><span class="NAME">this.shape</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.friction</span><span class="PUNC">=</span><span class="NUMB">0.2</span><span class="PUNC">;</span><span class="NAME">this.density</span><span class="PUNC">=</span><span class="NAME">this.restitution</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.filter.categoryBits</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.filter.maskBits</span><span class="PUNC">=</span><span class="NUMB">65535</span><span class="PUNC">;</span><span class="NAME">this.filter.groupIndex</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.isSensor</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.b2Island</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.b2Island</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_bodies</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">;</span><span class="NAME">this.m_contacts</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">;</span><span class="NAME">this.m_joints</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>207</span> </span><span class="NAME">Z.prototype.Initialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_bodyCapacity</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.m_contactCapacity</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.m_jointCapacity</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this.m_jointCount</span><span class="PUNC">=</span><span class="NAME">this.m_contactCount</span><span class="PUNC">=</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_allocator</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_listener</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.m_contactSolver</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.m_bodies.length</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.m_bodies</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.m_contacts.length</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.m_contacts</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.m_joints.length</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.m_joints</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.Clear</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_jointCount</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>208</span> </span><span class="NAME">this.m_contactCount</span><span class="PUNC">=</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.Solve</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_bodies</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.b2_dynamicBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">+</span><span class="NAME">e.m_invMass</span><span class="PUNC">*</span><span class="NAME">e.m_force.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c.y</span><span class="PUNC">+</span><span class="NAME">e.m_invMass</span><span class="PUNC">*</span><span class="NAME">e.m_force.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">e.m_invI</span><span class="PUNC">*</span><span class="NAME">e.m_torque</span><span class="PUNC">;</span><span class="NAME">e.m_linearVelocity.Multiply</span><span class="PUNC">(</span><span class="NAME">F.Clamp</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">e.m_linearDamping</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.m_angularVelocity</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">F.Clamp</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">e.m_angularDamping</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.m_contactSolver.Initialize</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.m_contacts</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>209</span> </span><span class="NAME">this.m_contactCount</span><span class="PUNC">,</span><span class="NAME">this.m_allocator</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_contactSolver</span><span class="PUNC">;</span><span class="NAME">c.InitVelocityConstraints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.m_jointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_joints</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f.InitVelocityConstraints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">a.velocityIterations</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">this.m_jointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_joints</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f.SolveVelocityConstraints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c.SolveVelocityConstraints</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.m_jointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_joints</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f.FinalizeVelocityConstraints</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c.FinalizeVelocityConstraints</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_bodies</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="WHIT">
<span class='line'>210</span> </span><span class="NAME">k.b2_staticBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">e.m_linearVelocity.x</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">e.m_linearVelocity.y</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">></span><span class="NAME">A.b2_maxTranslationSquared</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.m_linearVelocity.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.m_linearVelocity.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">A.b2_maxTranslation</span><span class="PUNC">*</span><span class="NAME">a.inv_dt</span><span class="PUNC">;</span><span class="NAME">e.m_linearVelocity.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">A.b2_maxTranslation</span><span class="PUNC">*</span><span class="NAME">a.inv_dt</span><span class="PUNC">}</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">e.m_angularVelocity</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">></span><span class="NAME">A.b2_maxRotationSquared</span><span class="PUNC">)</span><span class="NAME">e.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">e.m_angularVelocity</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NAME">A.b2_maxRotation</span><span class="PUNC">*</span><span class="NAME">a.inv_dt</span><span class="PUNC">:</span><span class="NAME">A.b2_maxRotation</span><span class="PUNC">*</span><span class="NAME">a.inv_dt</span><span class="PUNC">;</span><span class="NAME">e.m_sweep.c0.SetV</span><span class="PUNC">(</span><span class="NAME">e.m_sweep.c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.m_sweep.a0</span><span class="PUNC">=</span><span class="NAME">e.m_sweep.a</span><span class="PUNC">;</span><span class="NAME">e.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">e.m_linearVelocity.x</span><span class="PUNC">;</span><span class="NAME">e.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>211</span> </span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">e.m_linearVelocity.y</span><span class="PUNC">;</span><span class="NAME">e.m_sweep.a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">e.m_angularVelocity</span><span class="PUNC">;</span><span class="NAME">e.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">a.positionIterations</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">c.SolvePositionConstraints</span><span class="PUNC">(</span><span class="NAME">A.b2_contactBaumgarte</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">this.m_jointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_joints</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f.SolvePositionConstraints</span><span class="PUNC">(</span><span class="NAME">A.b2_contactBaumgarte</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">&&</span><span class="NAME">f</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">&&</span><span class="NAME">r</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">this.Report</span><span class="PUNC">(</span><span class="NAME">c.m_constraints</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">A.b2_linearSleepTolerance</span><span class="PUNC">*</span><span class="NAME">A.b2_linearSleepTolerance</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">A.b2_angularSleepTolerance</span><span class="PUNC">*</span><span class="NAME">A.b2_angularSleepTolerance</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>212</span> </span><span class="NAME">this.m_bodies</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">e.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_allowSleepFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e.m_sleepTime</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">e.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_allowSleepFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">||</span><span class="NAME">e.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">e.m_angularVelocity</span><span class="PUNC">></span><span class="NAME">m</span><span class="PUNC">||</span><span class="NAME">F.Dot</span><span class="PUNC">(</span><span class="NAME">e.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">e.m_linearVelocity</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e.m_sleepTime</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">e.m_sleepTime</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">F.Min</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">e.m_sleepTime</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">>=</span><span class="NAME">A.b2_timeToSleep</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_bodies</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e.SetAwake</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.SolveTOI</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_contactSolver.Initialize</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.m_contacts</span><span class="PUNC">,</span><span class="NAME">this.m_contactCount</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>213</span> </span><span class="NAME">this.m_allocator</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_contactSolver</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">this.m_jointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">this.m_joints</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">InitVelocityConstraints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">a.velocityIterations</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.SolveVelocityConstraints</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">this.m_jointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">g</span><span class="PUNC">)</span><span class="NAME">this.m_joints</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">SolveVelocityConstraints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_bodies</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">g.m_linearVelocity.x</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">g.m_linearVelocity.y</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">></span><span class="NAME">A.b2_maxTranslationSquared</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g.m_linearVelocity.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.m_linearVelocity.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">A.b2_maxTranslation</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>214</span> </span><span class="NAME">a.inv_dt</span><span class="PUNC">;</span><span class="NAME">g.m_linearVelocity.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">A.b2_maxTranslation</span><span class="PUNC">*</span><span class="NAME">a.inv_dt</span><span class="PUNC">}</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">g.m_angularVelocity</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">></span><span class="NAME">A.b2_maxRotationSquared</span><span class="PUNC">)</span><span class="NAME">g.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">g.m_angularVelocity</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NAME">A.b2_maxRotation</span><span class="PUNC">*</span><span class="NAME">a.inv_dt</span><span class="PUNC">:</span><span class="NAME">A.b2_maxRotation</span><span class="PUNC">*</span><span class="NAME">a.inv_dt</span><span class="PUNC">;</span><span class="NAME">g.m_sweep.c0.SetV</span><span class="PUNC">(</span><span class="NAME">g.m_sweep.c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.m_sweep.a0</span><span class="PUNC">=</span><span class="NAME">g.m_sweep.a</span><span class="PUNC">;</span><span class="NAME">g.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">g.m_linearVelocity.x</span><span class="PUNC">;</span><span class="NAME">g.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">g.m_linearVelocity.y</span><span class="PUNC">;</span><span class="NAME">g.m_sweep.a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">*</span><span class="NAME">g.m_angularVelocity</span><span class="PUNC">;</span><span class="NAME">g.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">a.positionIterations</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.SolvePositionConstraints</span><span class="PUNC">(</span><span class="NUMB">0.75</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>215</span> </span><span class="NAME">this.m_jointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.m_joints</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">SolvePositionConstraints</span><span class="PUNC">(</span><span class="NAME">A.b2_contactBaumgarte</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">m</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">f</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">this.Report</span><span class="PUNC">(</span><span class="NAME">b.m_constraints</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.Report</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_listener</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">this.m_contactCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_contacts</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">b.pointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Z.s_impulse.normalImpulses</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b.points</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">normalImpulse</span><span class="PUNC">;</span><span class="NAME">Z.s_impulse.tangentImpulses</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b.points</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">tangentImpulse</span><span class="PUNC">}</span><span class="NAME">this.m_listener.PostSolve</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">Z.s_impulse</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.AddBody</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.m_islandIndex</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>216</span> </span><span class="NAME">this.m_bodyCount</span><span class="PUNC">;</span><span class="NAME">this.m_bodies</span><span class="PUNC">[</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.AddContact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_contacts</span><span class="PUNC">[</span><span class="NAME">this.m_contactCount</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.AddJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_joints</span><span class="PUNC">[</span><span class="NAME">this.m_jointCount</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.b2Island.s_impulse</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.b2TimeStep</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">d.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.dt</span><span class="PUNC">=</span><span class="NAME">a.dt</span><span class="PUNC">;</span><span class="NAME">this.inv_dt</span><span class="PUNC">=</span><span class="NAME">a.inv_dt</span><span class="PUNC">;</span><span class="NAME">this.positionIterations</span><span class="PUNC">=</span><span class="NAME">a.positionIterations</span><span class="PUNC">;</span><span class="NAME">this.velocityIterations</span><span class="PUNC">=</span><span class="NAME">a.velocityIterations</span><span class="PUNC">;</span><span class="NAME">this.warmStarting</span><span class="PUNC">=</span><span class="NAME">a.warmStarting</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.b2World</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.s_stack</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>217</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">;</span><span class="NAME">this.m_contactManager</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">O</span><span class="PUNC">;</span><span class="NAME">this.m_contactSolver</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">this.m_island</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Z</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.b2World</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_controllerList</span><span class="PUNC">=</span><span class="NAME">this.m_jointList</span><span class="PUNC">=</span><span class="NAME">this.m_contactList</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">=</span><span class="NAME">this.m_debugDraw</span><span class="PUNC">=</span><span class="NAME">this.m_destructionListener</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_controllerCount</span><span class="PUNC">=</span><span class="NAME">this.m_jointCount</span><span class="PUNC">=</span><span class="NAME">this.m_contactCount</span><span class="PUNC">=</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h.m_warmStarting</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">h.m_continuousPhysics</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">this.m_allowSleep</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.m_gravity</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.m_inv_dt0</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_contactManager.m_world</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this.m_groundBody</span><span class="PUNC">=</span><span class="NAME">this.CreateBody</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>218</span> </span><span class="NAME">h.prototype.SetDestructionListener</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_destructionListener</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.SetContactFilter</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_contactManager.m_contactFilter</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.SetContactListener</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_contactManager.m_contactListener</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.SetDebugDraw</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_debugDraw</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.SetBroadPhase</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_contactManager.m_broadPhase</span><span class="PUNC">;</span><span class="NAME">this.m_contactManager.m_broadPhase</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g.m_next</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">g.m_fixtureList</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.m_next</span><span class="PUNC">)</span><span class="NAME">b.m_proxy</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>219</span> </span><span class="NAME">a.CreateProxy</span><span class="PUNC">(</span><span class="NAME">c.GetFatAABB</span><span class="PUNC">(</span><span class="NAME">b.m_proxy</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.Validate</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_contactManager.m_broadPhase.Validate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.GetProxyCount</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_contactManager.m_broadPhase.GetProxyCount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.CreateBody</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.IsLocked</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.m_prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_next</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">)</span><span class="NAME">this.m_bodyList.m_prev</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.m_bodyList</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.DestroyBody</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.IsLocked</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.m_jointList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>220</span> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.next</span><span class="PUNC">;</span><span class="NAME">this.m_destructionListener</span><span class="PUNC">&&</span><span class="NAME">this.m_destructionListener.SayGoodbyeJoint</span><span class="PUNC">(</span><span class="NAME">g.joint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.DestroyJoint</span><span class="PUNC">(</span><span class="NAME">g.joint</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.m_controllerList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.nextController</span><span class="PUNC">;</span><span class="NAME">g.controller.RemoveBody</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.m_contactList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.next</span><span class="PUNC">;</span><span class="NAME">this.m_contactManager.Destroy</span><span class="PUNC">(</span><span class="NAME">g.contact</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a.m_contactList</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.m_fixtureList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_next</span><span class="PUNC">;</span><span class="NAME">this.m_destructionListener</span><span class="PUNC">&&</span><span class="NAME">this.m_destructionListener.SayGoodbyeFixture</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.DestroyProxy</span><span class="PUNC">(</span><span class="NAME">this.m_contactManager.m_broadPhase</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.Destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a.m_fixtureList</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a.m_fixtureCount</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>221</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_prev</span><span class="PUNC">)</span><span class="NAME">a.m_prev.m_next</span><span class="PUNC">=</span><span class="NAME">a.m_next</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_next</span><span class="PUNC">)</span><span class="NAME">a.m_next.m_prev</span><span class="PUNC">=</span><span class="NAME">a.m_prev</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">this.m_bodyList</span><span class="PUNC">)</span><span class="NAME">this.m_bodyList</span><span class="PUNC">=</span><span class="NAME">a.m_next</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.CreateJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">q.Create</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.m_prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.m_next</span><span class="PUNC">=</span><span class="NAME">this.m_jointList</span><span class="PUNC">)</span><span class="NAME">this.m_jointList.m_prev</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.m_jointList</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">this.m_jointCount</span><span class="PUNC">;</span><span class="NAME">c.m_edgeA.joint</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c.m_edgeA.other</span><span class="PUNC">=</span><span class="NAME">c.m_bodyB</span><span class="PUNC">;</span><span class="NAME">c.m_edgeA.prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.m_edgeA.next</span><span class="PUNC">=</span><span class="NAME">c.m_bodyA.m_jointList</span><span class="PUNC">)</span><span class="NAME">c.m_bodyA.m_jointList.prev</span><span class="PUNC">=</span><span class="NAME">c.m_edgeA</span><span class="PUNC">;</span><span class="NAME">c.m_bodyA.m_jointList</span><span class="PUNC">=</span><span class="NAME">c.m_edgeA</span><span class="PUNC">;</span><span class="NAME">c.m_edgeB.joint</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>222</span> </span><span class="NAME">c.m_edgeB.other</span><span class="PUNC">=</span><span class="NAME">c.m_bodyA</span><span class="PUNC">;</span><span class="NAME">c.m_edgeB.prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.m_edgeB.next</span><span class="PUNC">=</span><span class="NAME">c.m_bodyB.m_jointList</span><span class="PUNC">)</span><span class="NAME">c.m_bodyB.m_jointList.prev</span><span class="PUNC">=</span><span class="NAME">c.m_edgeB</span><span class="PUNC">;</span><span class="NAME">c.m_bodyB.m_jointList</span><span class="PUNC">=</span><span class="NAME">c.m_edgeB</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.bodyA</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.bodyB</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.collideConnected</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b.GetContactList</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.other</span><span class="PUNC">==</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="NAME">a.contact.FlagForFiltering</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.next</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.DestroyJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.m_collideConnected</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_prev</span><span class="PUNC">)</span><span class="NAME">a.m_prev.m_next</span><span class="PUNC">=</span><span class="NAME">a.m_next</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_next</span><span class="PUNC">)</span><span class="NAME">a.m_next.m_prev</span><span class="PUNC">=</span><span class="NAME">a.m_prev</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">this.m_jointList</span><span class="PUNC">)</span><span class="NAME">this.m_jointList</span><span class="PUNC">=</span><span class="NAME">a.m_next</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.m_bodyA</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>223</span> </span><span class="NAME">a.m_bodyB</span><span class="PUNC">;</span><span class="NAME">g.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_edgeA.prev</span><span class="PUNC">)</span><span class="NAME">a.m_edgeA.prev.next</span><span class="PUNC">=</span><span class="NAME">a.m_edgeA.next</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_edgeA.next</span><span class="PUNC">)</span><span class="NAME">a.m_edgeA.next.prev</span><span class="PUNC">=</span><span class="NAME">a.m_edgeA.prev</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_edgeA</span><span class="PUNC">==</span><span class="NAME">g.m_jointList</span><span class="PUNC">)</span><span class="NAME">g.m_jointList</span><span class="PUNC">=</span><span class="NAME">a.m_edgeA.next</span><span class="PUNC">;</span><span class="NAME">a.m_edgeA.prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a.m_edgeA.next</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_edgeB.prev</span><span class="PUNC">)</span><span class="NAME">a.m_edgeB.prev.next</span><span class="PUNC">=</span><span class="NAME">a.m_edgeB.next</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_edgeB.next</span><span class="PUNC">)</span><span class="NAME">a.m_edgeB.next.prev</span><span class="PUNC">=</span><span class="NAME">a.m_edgeB.prev</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_edgeB</span><span class="PUNC">==</span><span class="NAME">b.m_jointList</span><span class="PUNC">)</span><span class="NAME">b.m_jointList</span><span class="PUNC">=</span><span class="NAME">a.m_edgeB.next</span><span class="PUNC">;</span><span class="NAME">a.m_edgeB.prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a.m_edgeB.next</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">q.Destroy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">this.m_jointCount</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>224</span> </span><span class="NAME">b.GetContactList</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.other</span><span class="PUNC">==</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="NAME">a.contact.FlagForFiltering</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.next</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.AddController</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.m_next</span><span class="PUNC">=</span><span class="NAME">this.m_controllerList</span><span class="PUNC">;</span><span class="NAME">a.m_prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_controllerList</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a.m_world</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this.m_controllerCount</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.RemoveController</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_prev</span><span class="PUNC">)</span><span class="NAME">a.m_prev.m_next</span><span class="PUNC">=</span><span class="NAME">a.m_next</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_next</span><span class="PUNC">)</span><span class="NAME">a.m_next.m_prev</span><span class="PUNC">=</span><span class="NAME">a.m_prev</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_controllerList</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.m_controllerList</span><span class="PUNC">=</span><span class="NAME">a.m_next</span><span class="PUNC">;</span><span class="NAME">this.m_controllerCount</span><span class="PUNC">--</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.CreateController</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_world</span><span class="PUNC">!=</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"Controller can only be a member of one world"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>225</span> </span><span class="NAME">a.m_next</span><span class="PUNC">=</span><span class="NAME">this.m_controllerList</span><span class="PUNC">;</span><span class="NAME">a.m_prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_controllerList</span><span class="PUNC">)</span><span class="NAME">this.m_controllerList.m_prev</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.m_controllerList</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">this.m_controllerCount</span><span class="PUNC">;</span><span class="NAME">a.m_world</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.DestroyController</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.Clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_next</span><span class="PUNC">)</span><span class="NAME">a.m_next.m_prev</span><span class="PUNC">=</span><span class="NAME">a.m_prev</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.m_prev</span><span class="PUNC">)</span><span class="NAME">a.m_prev.m_next</span><span class="PUNC">=</span><span class="NAME">a.m_next</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">this.m_controllerList</span><span class="PUNC">)</span><span class="NAME">this.m_controllerList</span><span class="PUNC">=</span><span class="NAME">a.m_next</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">this.m_controllerCount</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.SetWarmStarting</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">h.m_warmStarting</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.SetContinuousPhysics</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">h.m_continuousPhysics</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>226</span> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.GetBodyCount</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyCount</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.GetJointCount</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_jointCount</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.GetContactCount</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_contactCount</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.SetGravity</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_gravity</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.GetGravity</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_gravity</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.GetGroundBody</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_groundBody</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.Step</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">h.e_newFixture</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_contactManager.FindNewContacts</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>227</span> </span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">h.e_newFixture</span><span class="PUNC">}</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">h.e_locked</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">h.s_timestep2</span><span class="PUNC">;</span><span class="NAME">b.dt</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b.velocityIterations</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b.positionIterations</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">b.inv_dt</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b.dtRatio</span><span class="PUNC">=</span><span class="NAME">this.m_inv_dt0</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b.warmStarting</span><span class="PUNC">=</span><span class="NAME">h.m_warmStarting</span><span class="PUNC">;</span><span class="NAME">this.m_contactManager.Collide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.dt</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">this.Solve</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.m_continuousPhysics</span><span class="PUNC">&&</span><span class="NAME">b.dt</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">this.SolveTOI</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.dt</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">this.m_inv_dt0</span><span class="PUNC">=</span><span class="NAME">b.inv_dt</span><span class="PUNC">;</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">h.e_locked</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.ClearForces</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.m_next</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.m_force.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.m_torque</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.DrawDebugData</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>228</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_debugDraw</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_debugDraw.m_sprite.graphics.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_debugDraw.GetFlags</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">;</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&</span><span class="NAME">E.e_shapeBit</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_next</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.m_xf</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c.GetFixtureList</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g.m_next</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">g.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.IsActive</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="NAME">f.Set</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0.3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">)</span><span class="NAME">f.Set</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0.9</span><span class="PUNC">,</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.b2_kinematicBody</span><span class="PUNC">)</span><span class="NAME">f.Set</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0.9</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">c.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>229</span> </span><span class="NAME">f.Set</span><span class="PUNC">(</span><span class="NUMB">0.6</span><span class="PUNC">,</span><span class="NUMB">0.6</span><span class="PUNC">,</span><span class="NUMB">0.6</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f.Set</span><span class="PUNC">(</span><span class="NUMB">0.9</span><span class="PUNC">,</span><span class="NUMB">0.7</span><span class="PUNC">,</span><span class="NUMB">0.7</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.DrawShape</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&</span><span class="NAME">E.e_jointBit</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_jointList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_next</span><span class="PUNC">)</span><span class="NAME">this.DrawJoint</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&</span><span class="NAME">E.e_controllerBit</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_controllerList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_next</span><span class="PUNC">)</span><span class="NAME">c.Draw</span><span class="PUNC">(</span><span class="NAME">this.m_debugDraw</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&</span><span class="NAME">E.e_pairBit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f.Set</span><span class="PUNC">(</span><span class="NUMB">0.3</span><span class="PUNC">,</span><span class="NUMB">0.9</span><span class="PUNC">,</span><span class="NUMB">0.9</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_contactManager.m_contactList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.GetNext</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c.GetFixtureA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c.GetFixtureB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.GetAABB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">GetCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g.GetAABB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">GetCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_debugDraw.DrawSegment</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&</span><span class="NAME">E.e_aabbBit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_contactManager.m_broadPhase</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>230</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.GetNext</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.IsActive</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c.GetFixtureList</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g.GetNext</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">b.GetFatAABB</span><span class="PUNC">(</span><span class="NAME">g.m_proxy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NAME">m.lowerBound.x</span><span class="PUNC">,</span><span class="NAME">m.lowerBound.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NAME">m.upperBound.x</span><span class="PUNC">,</span><span class="NAME">m.lowerBound.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NAME">m.upperBound.x</span><span class="PUNC">,</span><span class="NAME">m.upperBound.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NAME">m.lowerBound.x</span><span class="PUNC">,</span><span class="NAME">m.upperBound.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_debugDraw.DrawPolygon</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&</span><span class="NAME">E.e_centerOfMassBit</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_next</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">h.s_xf</span><span class="PUNC">;</span><span class="NAME">e.R</span><span class="PUNC">=</span><span class="NAME">c.m_xf.R</span><span class="PUNC">;</span><span class="NAME">e.position</span><span class="PUNC">=</span><span class="NAME">c.GetWorldCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_debugDraw.DrawTransform</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.QueryAABB</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>231</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_contactManager.m_broadPhase</span><span class="PUNC">;</span><span class="NAME">g.Query</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">g.GetUserData</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.QueryShape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">g.SetIdentity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_contactManager.m_broadPhase</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">;</span><span class="NAME">c.ComputeAABB</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.Query</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.GetUserData</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">?</span><span class="NAME">b.GetUserData</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Y.TestOverlap</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">f.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">GetTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.QueryPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_contactManager.m_broadPhase</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>232</span> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">;</span><span class="NAME">b.lowerBound.Set</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">-</span><span class="NAME">A.b2_linearSlop</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">-</span><span class="NAME">A.b2_linearSlop</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.upperBound.Set</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">+</span><span class="NAME">A.b2_linearSlop</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">+</span><span class="NAME">A.b2_linearSlop</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.Query</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g.GetUserData</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">?</span><span class="NAME">g.GetUserData</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.TestPoint</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.RayCast</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_contactManager.m_broadPhase</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.RayCast</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">b.GetUserData</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">s</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">?</span><span class="NAME">s</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s.RayCast</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">e.fraction</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">c.x</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">g.x</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">c.y</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">g.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>233</span> </span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">e.normal</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">m.maxFraction</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.RayCastOne</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this.RayCast</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.RayCastAll</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">;</span><span class="NAME">this.RayCast</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">g.length</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.GetBodyList</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyList</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.GetJointList</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_jointList</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.GetContactList</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_contactList</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.IsLocked</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="WHIT">
<span class='line'>234</span> </span><span class="NAME">h.e_locked</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.Solve</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_controllerList</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g.m_next</span><span class="PUNC">)</span><span class="NAME">g.Step</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_island</span><span class="PUNC">;</span><span class="NAME">g.Initialize</span><span class="PUNC">(</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">,</span><span class="NAME">this.m_contactCount</span><span class="PUNC">,</span><span class="NAME">this.m_jointCount</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.m_contactManager.m_contactListener</span><span class="PUNC">,</span><span class="NAME">this.m_contactSolver</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_next</span><span class="PUNC">)</span><span class="NAME">c.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_contactList</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.m_next</span><span class="PUNC">)</span><span class="NAME">b.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">l.e_islandFlag</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_jointList</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.m_next</span><span class="PUNC">)</span><span class="NAME">b.m_islandFlag</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.s_stack</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>235</span> </span><span class="NAME">e.m_next</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">e.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">e.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">||</span><span class="NAME">e.IsActive</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g.Clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="PUNC">--</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g.AddBody</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">&&</span><span class="NAME">c.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">c.m_contactList</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">r.next</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">r.contact.m_flags</span><span class="PUNC">&</span><span class="NAME">l.e_islandFlag</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">r.contact.IsSensor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">true</span><span class="PUNC">||</span><span class="NAME">r.contact.IsEnabled</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">||</span><span class="NAME">r.contact.IsTouching</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g.AddContact</span><span class="PUNC">(</span><span class="NAME">r.contact</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.contact.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">l.e_islandFlag</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>236</span> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">r.other</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">m.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">m.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_jointList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.next</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.joint.m_islandFlag</span><span class="PUNC">!=</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">c.other</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m.IsActive</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g.AddJoint</span><span class="PUNC">(</span><span class="NAME">c.joint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.joint.m_islandFlag</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">m.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">m.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">g.Solve</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.m_gravity</span><span class="PUNC">,</span><span class="NAME">this.m_allowSleep</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">g.m_bodyCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">g.m_bodies</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">)</span><span class="NAME">c.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>237</span> </span><span class="NAME">c.m_next</span><span class="PUNC">)</span><span class="NAME">c.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">||</span><span class="NAME">c.IsActive</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">||</span><span class="NAME">c.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">&&</span><span class="NAME">c.SynchronizeFixtures</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_contactManager.FindNewContacts</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.SolveTOI</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_island</span><span class="PUNC">;</span><span class="NAME">e.Initialize</span><span class="PUNC">(</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">,</span><span class="NAME">A.b2_maxTOIContactsPerIsland</span><span class="PUNC">,</span><span class="NAME">A.b2_maxTOIJointsPerIsland</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.m_contactManager.m_contactListener</span><span class="PUNC">,</span><span class="NAME">this.m_contactSolver</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">h.s_queue</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_next</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">;</span><span class="NAME">c.m_sweep.t0</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_contactList</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.m_next</span><span class="PUNC">)</span><span class="NAME">b.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="PUNC">(</span><span class="NAME">l.e_toiFlag</span><span class="PUNC">|</span><span class="WHIT">
<span class='line'>238</span> </span><span class="NAME">l.e_islandFlag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_jointList</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.m_next</span><span class="PUNC">)</span><span class="NAME">b.m_islandFlag</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_contactList</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.m_next</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">b.IsSensor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">true</span><span class="PUNC">||</span><span class="NAME">b.IsEnabled</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">||</span><span class="NAME">b.IsContinuous</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.m_flags</span><span class="PUNC">&</span><span class="NAME">l.e_toiFlag</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.m_toi</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.m_fixtureA</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.m_fixtureB</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_body</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g.m_body</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">c.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">k.b2_dynamicBody</span><span class="PUNC">||</span><span class="NAME">c.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">k.b2_dynamicBody</span><span class="PUNC">||</span><span class="NAME">g.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">c.m_sweep.t0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.m_sweep.t0</span><span class="PUNC">&lt;</span><span class="NAME">g.m_sweep.t0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">g.m_sweep.t0</span><span class="PUNC">;</span><span class="NAME">c.m_sweep.Advance</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g.m_sweep.t0</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>239</span> </span><span class="NAME">c.m_sweep.t0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">c.m_sweep.t0</span><span class="PUNC">;</span><span class="NAME">g.m_sweep.Advance</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.ComputeTOI</span><span class="PUNC">(</span><span class="NAME">c.m_sweep</span><span class="PUNC">,</span><span class="NAME">g.m_sweep</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.b2Assert</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">&lt;=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">></span><span class="NUMB">1</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="NAME">b.m_toi</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">l.e_toiFlag</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">&lt;</span><span class="NAME">r</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">m.m_fixtureA</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">m.m_fixtureB</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_body</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g.m_body</span><span class="PUNC">;</span><span class="NAME">h.s_backupA.Set</span><span class="PUNC">(</span><span class="NAME">c.m_sweep</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.s_backupB.Set</span><span class="PUNC">(</span><span class="NAME">g.m_sweep</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.Advance</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.Advance</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.Update</span><span class="PUNC">(</span><span class="NAME">this.m_contactManager.m_contactListener</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">l.e_toiFlag</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m.IsSensor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">true</span><span class="PUNC">||</span><span class="NAME">m.IsEnabled</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>240</span> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.m_sweep.Set</span><span class="PUNC">(</span><span class="NAME">h.s_backupA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.m_sweep.Set</span><span class="PUNC">(</span><span class="NAME">h.s_backupB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m.IsTouching</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">k.b2_dynamicBody</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">e.Clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">e.AddBody</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">&&</span><span class="NAME">c.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.b2_dynamicBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c.m_contactList</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g.next</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.m_contactCount</span><span class="PUNC">==</span><span class="NAME">e.m_contactCapacity</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">g.contact.m_flags</span><span class="PUNC">&</span><span class="NAME">l.e_islandFlag</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">g.contact.IsSensor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">true</span><span class="PUNC">||</span><span class="NAME">g.contact.IsEnabled</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>241</span> </span><span class="KEYW">false</span><span class="PUNC">||</span><span class="NAME">g.contact.IsTouching</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.AddContact</span><span class="PUNC">(</span><span class="NAME">g.contact</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.contact.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">l.e_islandFlag</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">g.other</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">s.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s.Advance</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">s.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.m_jointList</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.next</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.m_jointCount</span><span class="PUNC">!=</span><span class="NAME">e.m_jointCapacity</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.joint.m_islandFlag</span><span class="PUNC">!=</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">c.other</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s.IsActive</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.AddJoint</span><span class="PUNC">(</span><span class="NAME">c.joint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.joint.m_islandFlag</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">s.m_flags</span><span class="PUNC">&</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">k.b2_staticBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s.Advance</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>242</span> </span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">s.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">h.s_timestep</span><span class="PUNC">;</span><span class="NAME">b.warmStarting</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">b.dt</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a.dt</span><span class="PUNC">;</span><span class="NAME">b.inv_dt</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">b.dt</span><span class="PUNC">;</span><span class="NAME">b.dtRatio</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b.velocityIterations</span><span class="PUNC">=</span><span class="NAME">a.velocityIterations</span><span class="PUNC">;</span><span class="NAME">b.positionIterations</span><span class="PUNC">=</span><span class="NAME">a.positionIterations</span><span class="PUNC">;</span><span class="NAME">e.SolveTOI</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">&lt;</span><span class="NAME">e.m_bodyCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">e.m_bodies</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">k.e_islandFlag</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">k.b2_dynamicBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.SynchronizeFixtures</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c.m_contactList</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g.next</span><span class="PUNC">)</span><span class="NAME">g.contact.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">l.e_toiFlag</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">&lt;</span><span class="NAME">e.m_contactCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">e.m_contacts</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="PUNC">(</span><span class="NAME">l.e_toiFlag</span><span class="PUNC">|</span><span class="WHIT">
<span class='line'>243</span> </span><span class="NAME">l.e_islandFlag</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">&lt;</span><span class="NAME">e.m_jointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">e.m_joints</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b.m_islandFlag</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">}</span><span class="NAME">this.m_contactManager.FindNewContacts</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.DrawJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.GetBodyA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.GetBodyB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c.m_xf.position</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g.m_xf.position</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.GetAnchorA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a.GetAnchorB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">h.s_jointColor</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a.m_type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">q.e_distanceJoint</span><span class="PUNC">:</span><span class="NAME">this.m_debugDraw.DrawSegment</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">q.e_pulleyJoint</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c.GetGroundAnchorA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.GetGroundAnchorB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_debugDraw.DrawSegment</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_debugDraw.DrawSegment</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>244</span> </span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_debugDraw.DrawSegment</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">q.e_mouseJoint</span><span class="PUNC">:</span><span class="NAME">this.m_debugDraw.DrawSegment</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">!=</span><span class="NAME">this.m_groundBody</span><span class="PUNC">&&</span><span class="NAME">this.m_debugDraw.DrawSegment</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_debugDraw.DrawSegment</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">!=</span><span class="NAME">this.m_groundBody</span><span class="PUNC">&&</span><span class="NAME">this.m_debugDraw.DrawSegment</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h.prototype.DrawShape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a.m_type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Y.e_circleShape</span><span class="PUNC">:</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">M</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_debugDraw.DrawSolidCircle</span><span class="PUNC">(</span><span class="NAME">F.MulX</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b.m_p</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.m_radius</span><span class="PUNC">,</span><span class="NAME">c.R.col1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Y.e_polygonShape</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">W</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>245</span> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">b.GetVertexCount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.GetVertices</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">F.MulX</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_debugDraw.DrawSolidPolygon</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Y.e_edgeShape</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_debugDraw.DrawSegment</span><span class="PUNC">(</span><span class="NAME">F.MulX</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b.GetVertex1</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">F.MulX</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b.GetVertex2</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.b2World.s_timestep2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2World.s_xf</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2World.s_backupA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2World.s_backupB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2World.s_timestep</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>246</span> </span><span class="NAME">Box2D.Dynamics.b2World.s_queue</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2World.s_jointColor</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0.8</span><span class="PUNC">,</span><span class="NUMB">0.8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2World.e_newFixture</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.b2World.e_locked</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>247</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2CircleShape</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2EdgeShape</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2PolygonShape</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.Shapes.b2Shape</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2CircleContact</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactConstraint</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactConstraintPoint</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactEdge</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactFactory</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactRegister</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactResult</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>248</span> </span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactSolver</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2EdgeAndCircleContact</span><span class="PUNC">,</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2NullContact</span><span class="PUNC">,</span><span class="NAME">Y</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2PolyAndCircleContact</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2PolyAndEdgeContact</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2PolygonContact</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2PositionSolverManifold</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2Body</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2TimeStep</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.b2Settings</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Mat22</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Math</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Vec2</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2Collision</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>249</span> </span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2ContactID</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2Manifold</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2TimeOfImpact</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2TOIInput</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">Box2D.Collision.b2WorldManifold</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.prototype</span><span class="PUNC">;</span><span class="NAME">w.b2CircleContact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.Create</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.Destroy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.prototype.Reset</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.Reset.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.prototype.Evaluate</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>250</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureA.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureB.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">S.CollideCircles</span><span class="PUNC">(</span><span class="NAME">this.m_manifold</span><span class="PUNC">,</span><span class="NAME">this.m_fixtureA.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">?</span><span class="NAME">this.m_fixtureA.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">j.m_xf</span><span class="PUNC">,</span><span class="NAME">this.m_fixtureB.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">?</span><span class="NAME">this.m_fixtureB.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">o.m_xf</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.b2Contact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_nodeA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">this.m_nodeB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">this.m_manifold</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Z</span><span class="PUNC">;</span><span class="NAME">this.m_oldManifold</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Z</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.GetManifold</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_manifold</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.GetWorldManifold</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureA.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>251</span> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureB.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureA.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureB.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.Initialize</span><span class="PUNC">(</span><span class="NAME">this.m_manifold</span><span class="PUNC">,</span><span class="NAME">o.GetTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n.m_radius</span><span class="PUNC">,</span><span class="NAME">q.GetTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.m_radius</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.IsTouching</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">A.e_touchingFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">A.e_touchingFlag</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.IsContinuous</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">A.e_continuousFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">A.e_continuousFlag</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.SetSensor</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">A.e_sensorFlag</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">A.e_sensorFlag</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.IsSensor</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="WHIT">
<span class='line'>252</span> </span><span class="NAME">A.e_sensorFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">A.e_sensorFlag</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.SetEnabled</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">A.e_enabledFlag</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">A.e_enabledFlag</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.IsEnabled</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">A.e_enabledFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">A.e_enabledFlag</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.GetNext</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_next</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.GetFixtureA</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_fixtureA</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.GetFixtureB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_fixtureB</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.FlagForFiltering</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">A.e_filterFlag</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.b2Contact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>253</span> </span><span class="NAME">A.prototype.Reset</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">j</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">o</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_flags</span><span class="PUNC">=</span><span class="NAME">A.e_enabledFlag</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">j</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">o</span><span class="PUNC">)</span><span class="NAME">this.m_fixtureB</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureA</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j.IsSensor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">o.IsSensor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">A.e_sensorFlag</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">j.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">o.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">D.b2_dynamicBody</span><span class="PUNC">||</span><span class="NAME">q.IsBullet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">n.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">D.b2_dynamicBody</span><span class="PUNC">||</span><span class="NAME">n.IsBullet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">A.e_continuousFlag</span><span class="PUNC">;</span><span class="NAME">this.m_fixtureA</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.m_fixtureB</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">this.m_manifold.m_pointCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_next</span><span class="PUNC">=</span><span class="NAME">this.m_prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_nodeA.contact</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_nodeA.prev</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>254</span> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_nodeA.next</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_nodeA.other</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_nodeB.contact</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_nodeB.prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_nodeB.next</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_nodeB.other</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_oldManifold</span><span class="PUNC">;</span><span class="NAME">this.m_oldManifold</span><span class="PUNC">=</span><span class="NAME">this.m_manifold</span><span class="PUNC">;</span><span class="NAME">this.m_manifold</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">A.e_enabledFlag</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">A.e_touchingFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">A.e_touchingFlag</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureA.m_body</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureB.m_body</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureA.m_aabb.TestOverlap</span><span class="PUNC">(</span><span class="NAME">this.m_fixtureB.m_aabb</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">A.e_sensorFlag</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">q</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>255</span> </span><span class="NAME">this.m_fixtureA.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureB.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">n.GetTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.GetTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">y.TestOverlap</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.m_manifold.m_pointCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">D.b2_dynamicBody</span><span class="PUNC">||</span><span class="NAME">n.IsBullet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">a.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">D.b2_dynamicBody</span><span class="PUNC">||</span><span class="NAME">a.IsBullet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">A.e_continuousFlag</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">A.e_continuousFlag</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.Evaluate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_manifold.m_pointCount</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">this.m_manifold.m_pointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_manifold.m_points</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g.m_normalImpulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g.m_tangentImpulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>256</span> </span><span class="NAME">g.m_id</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">this.m_oldManifold.m_pointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_oldManifold.m_points</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f.m_id.key</span><span class="PUNC">==</span><span class="NAME">b.key</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g.m_normalImpulse</span><span class="PUNC">=</span><span class="NAME">f.m_normalImpulse</span><span class="PUNC">;</span><span class="NAME">g.m_tangentImpulse</span><span class="PUNC">=</span><span class="NAME">f.m_tangentImpulse</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_manifold.m_pointCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">!=</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="NAME">this.m_flags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">A.e_touchingFlag</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">A.e_touchingFlag</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">&&</span><span class="NAME">q</span><span class="PUNC">==</span><span class="KEYW">true</span><span class="PUNC">&&</span><span class="NAME">j.BeginContact</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">==</span><span class="KEYW">true</span><span class="PUNC">&&</span><span class="NAME">q</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">&&</span><span class="NAME">j.EndContact</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">this.m_flags</span><span class="PUNC">&</span><span class="NAME">A.e_sensorFlag</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">j.PreSolve</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.m_oldManifold</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Evaluate</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>257</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.ComputeTOI</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">A.s_input.proxyA.Set</span><span class="PUNC">(</span><span class="NAME">this.m_fixtureA.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.s_input.proxyB.Set</span><span class="PUNC">(</span><span class="NAME">this.m_fixtureB.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.s_input.sweepA</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">A.s_input.sweepB</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">A.s_input.tolerance</span><span class="PUNC">=</span><span class="NAME">O.b2_linearSlop</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d.TimeOfImpact</span><span class="PUNC">(</span><span class="NAME">A.s_input</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.e_islandFlag</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.e_toiFlag</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>258</span> </span><span class="NUMB">16</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag</span><span class="PUNC">=</span><span class="NUMB">32</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.e_filterFlag</span><span class="PUNC">=</span><span class="NUMB">64</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.s_input</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">U.b2ContactConstraint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.localPlaneNormal</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">this.localPoint</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">this.normal</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">this.normalMass</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">E</span><span class="PUNC">;</span><span class="NAME">this.K</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">E</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.b2ContactConstraint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.points</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">(</span><span class="NAME">O.b2_maxManifoldPoints</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">O.b2_maxManifoldPoints</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">p.b2ContactConstraintPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.localPoint</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>259</span> </span><span class="NAME">this.rA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">this.rB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.b2ContactEdge</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Q.b2ContactFactory</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Q.prototype.b2ContactFactory</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_allocator</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.InitializeRegisters</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Q.prototype.AddType</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_registers</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">createFcn</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.m_registers</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">destroyFcn</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">this.m_registers</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">primary</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">!=</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_registers</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">createFcn</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.m_registers</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">destroyFcn</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">this.m_registers</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">primary</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Q.prototype.InitializeRegisters</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>260</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_registers</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">(</span><span class="NAME">y.e_shapeTypeCount</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">y.e_shapeTypeCount</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_registers</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">(</span><span class="NAME">y.e_shapeTypeCount</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">&lt;</span><span class="NAME">y.e_shapeTypeCount</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.m_registers</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">o</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">}</span><span class="NAME">this.AddType</span><span class="PUNC">(</span><span class="NAME">w.Create</span><span class="PUNC">,</span><span class="NAME">w.Destroy</span><span class="PUNC">,</span><span class="NAME">y.e_circleShape</span><span class="PUNC">,</span><span class="NAME">y.e_circleShape</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.AddType</span><span class="PUNC">(</span><span class="NAME">Y.Create</span><span class="PUNC">,</span><span class="NAME">Y.Destroy</span><span class="PUNC">,</span><span class="NAME">y.e_polygonShape</span><span class="PUNC">,</span><span class="NAME">y.e_circleShape</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.AddType</span><span class="PUNC">(</span><span class="NAME">z.Create</span><span class="PUNC">,</span><span class="NAME">z.Destroy</span><span class="PUNC">,</span><span class="NAME">y.e_polygonShape</span><span class="PUNC">,</span><span class="NAME">y.e_polygonShape</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.AddType</span><span class="PUNC">(</span><span class="NAME">I.Create</span><span class="PUNC">,</span><span class="NAME">I.Destroy</span><span class="PUNC">,</span><span class="NAME">y.e_edgeShape</span><span class="PUNC">,</span><span class="NAME">y.e_circleShape</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.AddType</span><span class="PUNC">(</span><span class="NAME">k.Create</span><span class="PUNC">,</span><span class="NAME">k.Destroy</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>261</span> </span><span class="NAME">y.e_polygonShape</span><span class="PUNC">,</span><span class="NAME">y.e_edgeShape</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Q.prototype.Create</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">j.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">o.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_registers</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q.pool</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">q.pool</span><span class="PUNC">;</span><span class="NAME">q.pool</span><span class="PUNC">=</span><span class="NAME">n.m_next</span><span class="PUNC">;</span><span class="NAME">q.poolCount</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="NAME">n.Reset</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">}</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">q.createFcn</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q.primary</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">(</span><span class="NAME">this.m_allocator</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.Reset</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">(</span><span class="NAME">this.m_allocator</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.Reset</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Q.prototype.Destroy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j.m_manifold.m_pointCount</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j.m_fixtureA.m_body.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.m_fixtureB.m_body.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">j.m_fixtureA.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>262</span> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">j.m_fixtureB.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_registers</span><span class="PUNC">[</span><span class="NAME">o</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">o.poolCount</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">j.m_next</span><span class="PUNC">=</span><span class="NAME">o.pool</span><span class="PUNC">;</span><span class="NAME">o.pool</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">o.destroyFcn</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">this.m_allocator</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.b2ContactRegister</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">M.b2ContactResult</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.position</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">this.normal</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">aa</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.b2ContactSolver</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_step</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">this.m_constraints</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.prototype.b2ContactSolver</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.prototype.Initialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.m_step.Set</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_allocator</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">this.m_constraintCount</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>263</span> </span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">this.m_constraints.length</span><span class="PUNC">&lt;</span><span class="NAME">this.m_constraintCount</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">this.m_constraints</span><span class="PUNC">[</span><span class="NAME">this.m_constraints.length</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">q</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">a.m_fixtureA</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.m_fixtureB</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">n.m_shape.m_radius</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c.m_shape.m_radius</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">n.m_body</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c.m_body</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a.GetManifold</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">O.b2MixFriction</span><span class="PUNC">(</span><span class="NAME">n.GetFriction</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.GetFriction</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">O.b2MixRestitution</span><span class="PUNC">(</span><span class="NAME">n.GetRestitution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.GetRestitution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">e.m_linearVelocity.x</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">e.m_linearVelocity.y</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">f.m_linearVelocity.x</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">f.m_linearVelocity.y</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">e.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">f.m_angularVelocity</span><span class="PUNC">;</span><span class="NAME">O.b2Assert</span><span class="PUNC">(</span><span class="NAME">m.m_pointCount</span><span class="PUNC">></span><span class="WHIT">
<span class='line'>264</span> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">L.s_worldManifold.Initialize</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">e.m_xf</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">f.m_xf</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">L.s_worldManifold.m_normal.x</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">L.s_worldManifold.m_normal.y</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_constraints</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">n.bodyA</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">n.bodyB</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">n.manifold</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">n.normal.x</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">n.normal.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n.pointCount</span><span class="PUNC">=</span><span class="NAME">m.m_pointCount</span><span class="PUNC">;</span><span class="NAME">n.friction</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">n.restitution</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">n.localPlaneNormal.x</span><span class="PUNC">=</span><span class="NAME">m.m_localPlaneNormal.x</span><span class="PUNC">;</span><span class="NAME">n.localPlaneNormal.y</span><span class="PUNC">=</span><span class="NAME">m.m_localPlaneNormal.y</span><span class="PUNC">;</span><span class="NAME">n.localPoint.x</span><span class="PUNC">=</span><span class="NAME">m.m_localPoint.x</span><span class="PUNC">;</span><span class="NAME">n.localPoint.y</span><span class="PUNC">=</span><span class="NAME">m.m_localPoint.y</span><span class="PUNC">;</span><span class="NAME">n.radius</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">n.type</span><span class="PUNC">=</span><span class="NAME">m.m_type</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">n.pointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">m.m_points</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">n.points</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b.normalImpulse</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>265</span> </span><span class="NAME">r.m_normalImpulse</span><span class="PUNC">;</span><span class="NAME">b.tangentImpulse</span><span class="PUNC">=</span><span class="NAME">r.m_tangentImpulse</span><span class="PUNC">;</span><span class="NAME">b.localPoint.SetV</span><span class="PUNC">(</span><span class="NAME">r.m_localPoint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">b.rA.x</span><span class="PUNC">=</span><span class="NAME">L.s_worldManifold.m_points</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">e.m_sweep.c.x</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">b.rA.y</span><span class="PUNC">=</span><span class="NAME">L.s_worldManifold.m_points</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">-</span><span class="NAME">e.m_sweep.c.y</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">b.rB.x</span><span class="PUNC">=</span><span class="NAME">L.s_worldManifold.m_points</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">f.m_sweep.c.x</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">b.rB.y</span><span class="PUNC">=</span><span class="NAME">L.s_worldManifold.m_points</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">-</span><span class="NAME">f.m_sweep.c.y</span><span class="PUNC">,</span><span class="NAME">$</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">X</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">$</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">;</span><span class="NAME">ba</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">;</span><span class="NAME">b.normalMass</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">e.m_invMass</span><span class="PUNC">+</span><span class="NAME">f.m_invMass</span><span class="PUNC">+</span><span class="NAME">e.m_invI</span><span class="PUNC">*</span><span class="NAME">$</span><span class="PUNC">+</span><span class="NAME">f.m_invI</span><span class="PUNC">*</span><span class="NAME">ba</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ca</span><span class="PUNC">=</span><span class="NAME">e.m_mass</span><span class="PUNC">*</span><span class="NAME">e.m_invMass</span><span class="PUNC">+</span><span class="NAME">f.m_mass</span><span class="PUNC">*</span><span class="NAME">f.m_invMass</span><span class="PUNC">;</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e.m_mass</span><span class="PUNC">*</span><span class="NAME">e.m_invI</span><span class="PUNC">*</span><span class="NAME">$</span><span class="PUNC">+</span><span class="NAME">f.m_mass</span><span class="PUNC">*</span><span class="NAME">f.m_invI</span><span class="PUNC">*</span><span class="NAME">ba</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>266</span> </span><span class="NAME">b.equalizedMass</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">ca</span><span class="PUNC">;</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">ca</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">$</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">ca</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">ba</span><span class="PUNC">;</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="NAME">ca</span><span class="PUNC">-</span><span class="NAME">X</span><span class="PUNC">*</span><span class="NAME">ba</span><span class="PUNC">;</span><span class="NAME">$</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">;</span><span class="NAME">ba</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">;</span><span class="NAME">b.tangentMass</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">e.m_invMass</span><span class="PUNC">+</span><span class="NAME">f.m_invMass</span><span class="PUNC">+</span><span class="NAME">e.m_invI</span><span class="PUNC">*</span><span class="NAME">$</span><span class="PUNC">+</span><span class="NAME">f.m_invI</span><span class="PUNC">*</span><span class="NAME">ba</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.velocityBias</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">n.normal.x</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">T</span><span class="PUNC">*</span><span class="NAME">X</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">J</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">n.normal.y</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">+</span><span class="NAME">T</span><span class="PUNC">*</span><span class="NAME">P</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NAME">J</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">&lt;</span><span class="PUNC">-</span><span class="NAME">O.b2_velocityThreshold</span><span class="PUNC">)</span><span class="NAME">b.velocityBias</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">n.restitution</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n.pointCount</span><span class="PUNC">==</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">n.points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">n.points</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e.m_invMass</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.m_invI</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">f.m_invMass</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f.m_invI</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">C.rA.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">C.rA.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">C.rB.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">C.rB.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">x.rA.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">x.rA.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">x.rB.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">x.rB.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">x</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>267</span> </span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n.K.col1.Set</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.K.col2.Set</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.K.GetInverse</span><span class="PUNC">(</span><span class="NAME">n.normalMass</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">n.pointCount</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.prototype.InitVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">&lt;</span><span class="NAME">this.m_constraintCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_constraints</span><span class="PUNC">[</span><span class="NAME">o</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">q.bodyA</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">q.bodyB</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">n.m_invMass</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">n.m_invI</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.m_invMass</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.m_invI</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">q.normal.x</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">q.normal.y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j.warmStarting</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">q.pointCount</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">&lt;</span><span class="NAME">t</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">q.points</span><span class="PUNC">[</span><span class="NAME">v</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">x.normalImpulse</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">j.dtRatio</span><span class="PUNC">;</span><span class="NAME">x.tangentImpulse</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">j.dtRatio</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">x.normalImpulse</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">x.tangentImpulse</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>268</span> </span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">x.normalImpulse</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">x.tangentImpulse</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">n.m_angularVelocity</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">x.rA.x</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">-</span><span class="NAME">x.rA.y</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.m_linearVelocity.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">n.m_linearVelocity.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">a.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">x.rB.x</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">-</span><span class="NAME">x.rB.y</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">a.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">q.pointCount</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">&lt;</span><span class="NAME">t</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">q.points</span><span class="PUNC">[</span><span class="NAME">v</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">n.normalImpulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">n.tangentImpulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.prototype.SolveVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">this.m_constraintCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_constraints</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">a.bodyA</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>269</span> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">a.bodyB</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">r.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">s.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">r.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">s.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">r.m_invMass</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">r.m_invI</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">s.m_invMass</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">s.m_invI</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.normal.x</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.normal.y</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.friction</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">a.pointCount</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">a.points</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">C.x</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">o.rB.y</span><span class="PUNC">-</span><span class="NAME">x.x</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">o.rA.y</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">C.y</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">o.rB.x</span><span class="PUNC">-</span><span class="NAME">x.y</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">o.rA.x</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">$</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">o.tangentMass</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">o.normalImpulse</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">R.Clamp</span><span class="PUNC">(</span><span class="NAME">o.tangentImpulse</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">o.tangentImpulse</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">$</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">x.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">x.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o.rA.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o.rA.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">C.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o.rB.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o.rB.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o.tangentImpulse</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>270</span> </span><span class="NAME">n</span><span class="PUNC">}</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a.pointCount</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.pointCount</span><span class="PUNC">==</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">a.points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">C.x</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">o.rB.y</span><span class="PUNC">-</span><span class="NAME">x.x</span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">o.rA.y</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">C.y</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">o.rB.x</span><span class="PUNC">-</span><span class="NAME">x.y</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">o.rA.x</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">o.normalMass</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">o.velocityBias</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">o.normalImpulse</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NAME">n</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">o.normalImpulse</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">x.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">x.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o.rA.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o.rA.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">C.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o.rB.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o.rB.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o.normalImpulse</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">a.points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a.points</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">o.normalImpulse</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">j.normalImpulse</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ba</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">C.x</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">o.rB.y</span><span class="PUNC">-</span><span class="NAME">x.x</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">o.rA.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">C.y</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">o.rB.x</span><span class="PUNC">-</span><span class="NAME">x.y</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">o.rA.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">C.x</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">j.rB.y</span><span class="PUNC">-</span><span class="NAME">x.x</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">j.rA.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">C.y</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>271</span> </span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">j.rB.x</span><span class="PUNC">-</span><span class="NAME">x.y</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">j.rA.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">-</span><span class="NAME">o.velocityBias</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">ca</span><span class="PUNC">-</span><span class="NAME">j.velocityBias</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.K</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">f.col1.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">f.col2.x</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">f.col1.y</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">f.col2.y</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.normalMass</span><span class="PUNC">;</span><span class="NAME">$</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">f.col1.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">f.col2.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">f.col1.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">f.col2.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">f</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">x.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">x.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o.rA.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o.rA.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">j.rA.x</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">j.rA.y</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o.rB.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o.rB.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">j.rB.x</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">j.rB.y</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o.normalImpulse</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">;</span><span class="NAME">j.normalImpulse</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">$</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">o.normalMass</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ca</span><span class="PUNC">=</span><span class="NAME">a.K.col1.y</span><span class="PUNC">*</span><span class="NAME">$</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">ca</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>272</span> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">x.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">x.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o.rA.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o.rA.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">j.rA.x</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">j.rA.y</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o.rB.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o.rB.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">j.rB.x</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">j.rB.y</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o.normalImpulse</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">;</span><span class="NAME">j.normalImpulse</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">$</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">j.normalMass</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">a.K.col2.x</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">ba</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">x.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">x.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o.rA.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o.rA.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">j.rA.x</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">j.rA.y</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o.rB.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o.rB.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">j.rB.x</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">j.rB.y</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o.normalImpulse</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">;</span><span class="NAME">j.normalImpulse</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">ca</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">ba</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">ca</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">q</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>273</span> </span><span class="NAME">$</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">x.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">x.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o.rA.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o.rA.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">j.rA.x</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">j.rA.y</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o.rB.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o.rB.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">j.rB.x</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">j.rB.y</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o.normalImpulse</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">;</span><span class="NAME">j.normalImpulse</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">r.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">s.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.prototype.FinalizeVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">this.m_constraintCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">j</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_constraints</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">o.manifold</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">&lt;</span><span class="NAME">o.pointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">q.m_points</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">o.points</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.m_normalImpulse</span><span class="PUNC">=</span><span class="NAME">c.normalImpulse</span><span class="PUNC">;</span><span class="NAME">a.m_tangentImpulse</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>274</span> </span><span class="NAME">c.tangentImpulse</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.prototype.SolvePositionConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">&lt;</span><span class="NAME">this.m_constraintCount</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_constraints</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">n.bodyA</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">n.bodyB</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.m_mass</span><span class="PUNC">*</span><span class="NAME">a.m_invMass</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.m_mass</span><span class="PUNC">*</span><span class="NAME">a.m_invI</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.m_mass</span><span class="PUNC">*</span><span class="NAME">c.m_invMass</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c.m_mass</span><span class="PUNC">*</span><span class="NAME">c.m_invI</span><span class="PUNC">;</span><span class="NAME">L.s_psm.Initialize</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">L.s_psm.m_normal</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">&lt;</span><span class="NAME">n.pointCount</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">n.points</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">L.s_psm.m_points</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">L.s_psm.m_separations</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">v.x</span><span class="PUNC">-</span><span class="NAME">a.m_sweep.c.x</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">v.y</span><span class="PUNC">-</span><span class="NAME">a.m_sweep.c.y</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">v.x</span><span class="PUNC">-</span><span class="NAME">c.m_sweep.c.x</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">v.y</span><span class="PUNC">-</span><span class="NAME">c.m_sweep.c.y</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">&lt;</span><span class="NAME">t</span><span class="PUNC">?</span><span class="NAME">o</span><span class="PUNC">:</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>275</span> </span><span class="NAME">R.Clamp</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">O.b2_linearSlop</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">O.b2_maxLinearCorrection</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">s.equalizedMass</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">m.x</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">m.y</span><span class="PUNC">;</span><span class="NAME">a.m_sweep.c.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">a.m_sweep.c.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">a.m_sweep.a</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">c.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">c.m_sweep.a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">></span><span class="PUNC">-</span><span class="NUMB">1.5</span><span class="PUNC">*</span><span class="NAME">O.b2_linearSlop</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2ContactSolver.s_psm</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">I</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>276</span> </span><span class="NAME">I.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.prototype</span><span class="PUNC">;</span><span class="NAME">I.b2EdgeAndCircleContact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.Create</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">I</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.Destroy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.Reset</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.Reset.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.Evaluate</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureA.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureB.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.b2CollideEdgeAndCircle</span><span class="PUNC">(</span><span class="NAME">this.m_manifold</span><span class="PUNC">,</span><span class="NAME">this.m_fixtureA.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">?</span><span class="NAME">this.m_fixtureA.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">j.m_xf</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>277</span> </span><span class="NAME">this.m_fixtureB.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">?</span><span class="NAME">this.m_fixtureB.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">o.m_xf</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.b2CollideEdgeAndCircle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">W</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">W.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.prototype</span><span class="PUNC">;</span><span class="NAME">W.b2NullContact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">W.prototype.b2NullContact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2Contact.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">W.prototype.Evaluate</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">Y</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Y.prototype.__super</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>278</span> </span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.prototype</span><span class="PUNC">;</span><span class="NAME">Y.b2PolyAndCircleContact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Y.Create</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Y.Destroy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Y.prototype.Reset</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.Reset.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">O.b2Assert</span><span class="PUNC">(</span><span class="NAME">j.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">y.e_polygonShape</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">O.b2Assert</span><span class="PUNC">(</span><span class="NAME">o.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">y.e_circleShape</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Y.prototype.Evaluate</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureA.m_body</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureB.m_body</span><span class="PUNC">;</span><span class="NAME">S.CollidePolygonAndCircle</span><span class="PUNC">(</span><span class="NAME">this.m_manifold</span><span class="PUNC">,</span><span class="NAME">this.m_fixtureA.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="KEYW">instanceof</span><span class="WHIT">
<span class='line'>279</span> </span><span class="NAME">K</span><span class="PUNC">?</span><span class="NAME">this.m_fixtureA.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">j.m_xf</span><span class="PUNC">,</span><span class="NAME">this.m_fixtureB.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">?</span><span class="NAME">this.m_fixtureB.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">o.m_xf</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.prototype</span><span class="PUNC">;</span><span class="NAME">k.b2PolyAndEdgeContact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.Create</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.Destroy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.Reset</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.Reset.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">O.b2Assert</span><span class="PUNC">(</span><span class="NAME">j.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">y.e_polygonShape</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>280</span> </span><span class="NAME">O.b2Assert</span><span class="PUNC">(</span><span class="NAME">o.GetType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">y.e_edgeShape</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.Evaluate</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureA.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureB.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.b2CollidePolyAndEdge</span><span class="PUNC">(</span><span class="NAME">this.m_manifold</span><span class="PUNC">,</span><span class="NAME">this.m_fixtureA.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">?</span><span class="NAME">this.m_fixtureA.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">j.m_xf</span><span class="PUNC">,</span><span class="NAME">this.m_fixtureB.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">?</span><span class="NAME">this.m_fixtureB.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">o.m_xf</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.b2CollidePolyAndEdge</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">z.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.prototype</span><span class="PUNC">;</span><span class="NAME">z.b2PolygonContact</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>281</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">z.Create</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">z.Destroy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">z.prototype.Reset</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.Reset.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">z.prototype.Evaluate</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureA.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_fixtureB.GetBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">S.CollidePolygons</span><span class="PUNC">(</span><span class="NAME">this.m_manifold</span><span class="PUNC">,</span><span class="NAME">this.m_fixtureA.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">?</span><span class="NAME">this.m_fixtureA.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">j.m_xf</span><span class="PUNC">,</span><span class="NAME">this.m_fixtureB.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">?</span><span class="NAME">this.m_fixtureB.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">o.m_xf</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.b2PositionSolverManifold</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>282</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.b2PositionSolverManifold</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_normal</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">this.m_separations</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector_a2j_Number</span><span class="PUNC">(</span><span class="NAME">O.b2_maxManifoldPoints</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_points</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Vector</span><span class="PUNC">(</span><span class="NAME">O.b2_maxManifoldPoints</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">O.b2_maxManifoldPoints</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.Initialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">O.b2Assert</span><span class="PUNC">(</span><span class="NAME">j.pointCount</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">j.type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Z.e_circles</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.bodyA.m_xf.R</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.localPoint</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">j.bodyA.m_xf.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.col1.x</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.x</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">j.bodyA.m_xf.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.col1.y</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>283</span> </span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.y</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.bodyB.m_xf.R</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">localPoint</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">j.bodyB.m_xf.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.col1.x</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.x</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.bodyB.m_xf.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.col1.y</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.y</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">></span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">*</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_normal.x</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_normal.y</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_normal.x</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.m_normal.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_separations</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_normal.x</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_normal.y</span><span class="PUNC">-</span><span class="NAME">j.radius</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Z.e_faceA</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.bodyA.m_xf.R</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.localPlaneNormal</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>284</span> </span><span class="NAME">this.m_normal.x</span><span class="PUNC">=</span><span class="NAME">a.col1.x</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.x</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">;</span><span class="NAME">this.m_normal.y</span><span class="PUNC">=</span><span class="NAME">a.col1.y</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.y</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.bodyA.m_xf.R</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.localPoint</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">j.bodyA.m_xf.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.col1.x</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.x</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">j.bodyA.m_xf.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.col1.y</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.y</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.bodyB.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">&lt;</span><span class="NAME">j.pointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.points</span><span class="PUNC">[</span><span class="NAME">o</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">localPoint</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">j.bodyB.m_xf.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.col1.x</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.x</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.bodyB.m_xf.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.col1.y</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.y</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_separations</span><span class="PUNC">[</span><span class="NAME">o</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_normal.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_normal.y</span><span class="PUNC">-</span><span class="NAME">j.radius</span><span class="PUNC">;</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">o</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">o</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>285</span> </span><span class="NAME">n</span><span class="PUNC">}</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Z.e_faceB</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.bodyB.m_xf.R</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.localPlaneNormal</span><span class="PUNC">;</span><span class="NAME">this.m_normal.x</span><span class="PUNC">=</span><span class="NAME">a.col1.x</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.x</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">;</span><span class="NAME">this.m_normal.y</span><span class="PUNC">=</span><span class="NAME">a.col1.y</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.y</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.bodyB.m_xf.R</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.localPoint</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">j.bodyB.m_xf.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.col1.x</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.x</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">j.bodyB.m_xf.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.col1.y</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.y</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.bodyA.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">&lt;</span><span class="NAME">j.pointCount</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.points</span><span class="PUNC">[</span><span class="NAME">o</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">localPoint</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">j.bodyA.m_xf.position.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.col1.x</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.x</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.bodyA.m_xf.position.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.col1.y</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">a.col2.y</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_separations</span><span class="PUNC">[</span><span class="NAME">o</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_normal.x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>286</span> </span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_normal.y</span><span class="PUNC">-</span><span class="NAME">j.radius</span><span class="PUNC">;</span><span class="NAME">this.m_points</span><span class="PUNC">[</span><span class="NAME">o</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">Set</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.m_normal.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.m_normal.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>287</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Mat22</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Math</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Vec2</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.b2Color</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Controllers.b2BuoyancyController</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Controllers.b2ConstantAccelController</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Controllers.b2ConstantForceController</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Controllers.b2ControllerEdge</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Controllers.b2GravityController</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Controllers.b2TensorDampingController</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>288</span> </span><span class="NAME">w.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller.prototype</span><span class="PUNC">;</span><span class="NAME">w.b2BuoyancyController</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.normal</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.density</span><span class="PUNC">=</span><span class="NAME">this.offset</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.velocity</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.linearDrag</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.angularDrag</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.useDensity</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.useWorldGravity</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">this.gravity</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.prototype.Step</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_bodyList</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.useWorldGravity</span><span class="PUNC">)</span><span class="NAME">this.gravity</span><span class="PUNC">=</span><span class="NAME">this.GetWorld</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">GetGravity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">M</span><span class="PUNC">;</span><span class="NAME">M</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>289</span> </span><span class="NAME">M.nextBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">M.body</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">L.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">I</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">W</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">Y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">L.GetFixtureList</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">z.GetNext</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">z.GetShape</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">ComputeSubmergedArea</span><span class="PUNC">(</span><span class="NAME">this.normal</span><span class="PUNC">,</span><span class="NAME">this.offset</span><span class="PUNC">,</span><span class="NAME">L.GetTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">I.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">*</span><span class="NAME">u.x</span><span class="PUNC">;</span><span class="NAME">I.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">*</span><span class="NAME">u.y</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">W.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">*</span><span class="NAME">u.x</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">W.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">D</span><span class="PUNC">*</span><span class="NAME">u.y</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">}</span><span class="NAME">I.x</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">Y</span><span class="PUNC">;</span><span class="NAME">I.y</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">Y</span><span class="PUNC">;</span><span class="NAME">W.x</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">W.y</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">Y</span><span class="PUNC">&lt;</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">this.gravity.GetNegative</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.Multiply</span><span class="PUNC">(</span><span class="NAME">this.density</span><span class="PUNC">*</span><span class="NAME">Y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">L.ApplyForce</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">W</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NAME">L.GetLinearVelocityFromWorldPoint</span><span class="PUNC">(</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">W.Subtract</span><span class="PUNC">(</span><span class="NAME">this.velocity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">W.Multiply</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">this.linearDrag</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>290</span> </span><span class="NAME">Y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">L.ApplyForce</span><span class="PUNC">(</span><span class="NAME">W</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">L.ApplyTorque</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">L.GetInertia</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">L.GetMass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Y</span><span class="PUNC">*</span><span class="NAME">L.GetAngularVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.angularDrag</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.prototype.Draw</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">L.x</span><span class="PUNC">=</span><span class="NAME">this.normal.x</span><span class="PUNC">*</span><span class="NAME">this.offset</span><span class="PUNC">+</span><span class="NAME">this.normal.y</span><span class="PUNC">*</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">;</span><span class="NAME">L.y</span><span class="PUNC">=</span><span class="NAME">this.normal.y</span><span class="PUNC">*</span><span class="NAME">this.offset</span><span class="PUNC">-</span><span class="NAME">this.normal.x</span><span class="PUNC">*</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">;</span><span class="NAME">I.x</span><span class="PUNC">=</span><span class="NAME">this.normal.x</span><span class="PUNC">*</span><span class="NAME">this.offset</span><span class="PUNC">-</span><span class="NAME">this.normal.y</span><span class="PUNC">*</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">;</span><span class="NAME">I.y</span><span class="PUNC">=</span><span class="NAME">this.normal.y</span><span class="PUNC">*</span><span class="NAME">this.offset</span><span class="PUNC">+</span><span class="NAME">this.normal.x</span><span class="PUNC">*</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">W</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">M.DrawSegment</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">,</span><span class="NAME">W</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller.prototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>291</span> </span><span class="NAME">A.b2ConstantAccelController</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.A</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">A.prototype.Step</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">M</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">(</span><span class="NAME">this.A.x</span><span class="PUNC">*</span><span class="NAME">M.dt</span><span class="PUNC">,</span><span class="NAME">this.A.y</span><span class="PUNC">*</span><span class="NAME">M.dt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">L</span><span class="PUNC">;</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">L.nextBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">L.body</span><span class="PUNC">;</span><span class="NAME">I.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">I.SetLinearVelocity</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">(</span><span class="NAME">I.GetLinearVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">M.x</span><span class="PUNC">,</span><span class="NAME">I.GetLinearVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">M.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">U</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">U.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller.prototype</span><span class="PUNC">;</span><span class="NAME">U.b2ConstantForceController</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>292</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.F</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.Step</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">M</span><span class="PUNC">;</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">M.nextBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">M.body</span><span class="PUNC">;</span><span class="NAME">L.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">L.ApplyForce</span><span class="PUNC">(</span><span class="NAME">this.F</span><span class="PUNC">,</span><span class="NAME">L.GetWorldCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">p.b2Controller</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">p.prototype.Step</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">p.prototype.Draw</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">p.prototype.AddBody</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">L.controller</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">L.body</span><span class="PUNC">=</span><span class="NAME">M</span><span class="PUNC">;</span><span class="NAME">L.nextBody</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">L.prevBody</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_bodyList</span><span class="PUNC">=</span><span class="NAME">L</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">L.nextBody</span><span class="PUNC">)</span><span class="NAME">L.nextBody.prevBody</span><span class="PUNC">=</span><span class="NAME">L</span><span class="PUNC">;</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>293</span> </span><span class="NAME">L.nextController</span><span class="PUNC">=</span><span class="NAME">M.m_controllerList</span><span class="PUNC">;</span><span class="NAME">L.prevController</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">M.m_controllerList</span><span class="PUNC">=</span><span class="NAME">L</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">L.nextController</span><span class="PUNC">)</span><span class="NAME">L.nextController.prevController</span><span class="PUNC">=</span><span class="NAME">L</span><span class="PUNC">;</span><span class="NAME">M.m_controllerCount</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">p.prototype.RemoveBody</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">M.m_controllerList</span><span class="PUNC">;</span><span class="NAME">L</span><span class="PUNC">&&</span><span class="NAME">L.controller</span><span class="PUNC">!=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">L.nextController</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">L.prevBody</span><span class="PUNC">)</span><span class="NAME">L.prevBody.nextBody</span><span class="PUNC">=</span><span class="NAME">L.nextBody</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">L.nextBody</span><span class="PUNC">)</span><span class="NAME">L.nextBody.prevBody</span><span class="PUNC">=</span><span class="NAME">L.prevBody</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">L.nextController</span><span class="PUNC">)</span><span class="NAME">L.nextController.prevController</span><span class="PUNC">=</span><span class="NAME">L.prevController</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">L.prevController</span><span class="PUNC">)</span><span class="NAME">L.prevController.nextController</span><span class="PUNC">=</span><span class="NAME">L.nextController</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_bodyList</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>294</span> </span><span class="NAME">L</span><span class="PUNC">)</span><span class="NAME">this.m_bodyList</span><span class="PUNC">=</span><span class="NAME">L.nextBody</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">M.m_controllerList</span><span class="PUNC">==</span><span class="NAME">L</span><span class="PUNC">)</span><span class="NAME">M.m_controllerList</span><span class="PUNC">=</span><span class="NAME">L.nextController</span><span class="PUNC">;</span><span class="NAME">M.m_controllerCount</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="NAME">this.m_bodyCount</span><span class="PUNC">--</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">p.prototype.Clear</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">this.RemoveBody</span><span class="PUNC">(</span><span class="NAME">this.m_bodyList.body</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">p.prototype.GetNext</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_next</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">p.prototype.GetWorld</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_world</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">p.prototype.GetBodyList</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyList</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.b2ControllerEdge</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Q.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller.prototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>295</span> </span><span class="NAME">Q.b2GravityController</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.G</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.invSqr</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Q.prototype.Step</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">M</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Y</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.invSqr</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">M</span><span class="PUNC">;</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">M.nextBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">M.body</span><span class="PUNC">;</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">L.GetWorldCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NAME">L.GetMass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">Y</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">Y</span><span class="PUNC">!=</span><span class="NAME">M</span><span class="PUNC">;</span><span class="NAME">Y</span><span class="PUNC">=</span><span class="NAME">Y.nextBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">Y.body</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">k.GetWorldCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">z.x</span><span class="PUNC">-</span><span class="NAME">I.x</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">z.y</span><span class="PUNC">-</span><span class="NAME">I.y</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">u</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">+</span><span class="NAME">D</span><span class="PUNC">*</span><span class="NAME">D</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">&lt;</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">u.Multiply</span><span class="PUNC">(</span><span class="NAME">this.G</span><span class="PUNC">/</span><span class="NAME">H</span><span class="PUNC">/</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>296</span> </span><span class="NAME">W</span><span class="PUNC">*</span><span class="NAME">k.GetMass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">L.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">L.ApplyForce</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">u.Multiply</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">k.ApplyForce</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">M</span><span class="PUNC">;</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">M.nextBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">M.body</span><span class="PUNC">;</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">L.GetWorldCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NAME">L.GetMass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">Y</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">Y</span><span class="PUNC">!=</span><span class="NAME">M</span><span class="PUNC">;</span><span class="NAME">Y</span><span class="PUNC">=</span><span class="NAME">Y.nextBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">Y.body</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">k.GetWorldCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">z.x</span><span class="PUNC">-</span><span class="NAME">I.x</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">z.y</span><span class="PUNC">-</span><span class="NAME">I.y</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">u</span><span class="PUNC">*</span><span class="NAME">u</span><span class="PUNC">+</span><span class="NAME">D</span><span class="PUNC">*</span><span class="NAME">D</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">&lt;</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">u.Multiply</span><span class="PUNC">(</span><span class="NAME">this.G</span><span class="PUNC">/</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">W</span><span class="PUNC">*</span><span class="NAME">k.GetMass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">L.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">L.ApplyForce</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">u.Multiply</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">k.ApplyForce</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">V.prototype.__super</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>297</span> </span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller.prototype</span><span class="PUNC">;</span><span class="NAME">V.b2TensorDampingController</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.T</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">;</span><span class="NAME">this.maxTimestep</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.prototype.SetAxisAligned</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.T.col1.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">M</span><span class="PUNC">;</span><span class="NAME">this.T.col1.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.T.col2.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.T.col2.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">L</span><span class="PUNC">;</span><span class="NAME">this.maxTimestep</span><span class="PUNC">=</span><span class="NAME">M</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">||</span><span class="NAME">L</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.prototype.Step</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">M.dt</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">&lt;=</span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">></span><span class="NAME">this.maxTimestep</span><span class="PUNC">&&</span><span class="NAME">this.maxTimestep</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">this.maxTimestep</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>298</span> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">this.m_bodyList</span><span class="PUNC">;</span><span class="NAME">L</span><span class="PUNC">;</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">L.nextBody</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">L.body</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">I.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">W</span><span class="PUNC">=</span><span class="NAME">I.GetWorldVector</span><span class="PUNC">(</span><span class="NAME">G.MulMV</span><span class="PUNC">(</span><span class="NAME">this.T</span><span class="PUNC">,</span><span class="NAME">I.GetLocalVector</span><span class="PUNC">(</span><span class="NAME">I.GetLinearVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">I.SetLinearVelocity</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">(</span><span class="NAME">I.GetLinearVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">W.x</span><span class="PUNC">*</span><span class="NAME">M</span><span class="PUNC">,</span><span class="NAME">I.GetLinearVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">W.y</span><span class="PUNC">*</span><span class="NAME">M</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>299</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.b2Settings</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Mat22</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Mat33</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Math</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Vec2</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">Box2D.Common.Math.b2Vec3</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2DistanceJoint</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2DistanceJointDef</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2FrictionJoint</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2FrictionJointDef</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2GearJoint</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2GearJointDef</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2Jacobian</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint</span><span class="PUNC">,</span><span class="NAME">W</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>300</span> </span><span class="NAME">Y</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2JointEdge</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2LineJoint</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2LineJointDef</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2MouseJoint</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2MouseJointDef</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2PrismaticJoint</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2PrismaticJointDef</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2PulleyJoint</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2PulleyJointDef</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2RevoluteJoint</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2RevoluteJointDef</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2WeldJoint</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2WeldJointDef</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>301</span> </span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">U</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">U.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.prototype</span><span class="PUNC">;</span><span class="NAME">U.b2DistanceJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.b2Joint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_u</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.GetAnchorA</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyA.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.GetAnchorB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyB.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.GetReactionForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>302</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_u.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_u.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.GetReactionTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.GetLength</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_length</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.SetLength</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_length</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.GetFrequency</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_frequencyHz</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.SetFrequency</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_frequencyHz</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.GetDampingRatio</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_dampingRatio</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.SetDampingRatio</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>303</span> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_dampingRatio</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.b2DistanceJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2Joint.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor1.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor2.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_length</span><span class="PUNC">=</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">this.m_frequencyHz</span><span class="PUNC">=</span><span class="NAME">d.frequencyHz</span><span class="PUNC">;</span><span class="NAME">this.m_dampingRatio</span><span class="PUNC">=</span><span class="NAME">d.dampingRatio</span><span class="PUNC">;</span><span class="NAME">this.m_bias</span><span class="PUNC">=</span><span class="NAME">this.m_gamma</span><span class="PUNC">=</span><span class="NAME">this.m_impulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.InitVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>304</span> </span><span class="NAME">j.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">o.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">o.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">o.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">this.m_u.x</span><span class="PUNC">=</span><span class="NAME">o.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.c.x</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">this.m_u.y</span><span class="PUNC">=</span><span class="NAME">o.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.c.y</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">this.m_u.x</span><span class="PUNC">*</span><span class="NAME">this.m_u.x</span><span class="PUNC">+</span><span class="NAME">this.m_u.y</span><span class="PUNC">*</span><span class="NAME">this.m_u.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">></span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">?</span><span class="NAME">this.m_u.Multiply</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.m_u.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">this.m_u.y</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_u.x</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_u.y</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_u.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>305</span> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j.m_invMass</span><span class="PUNC">+</span><span class="NAME">j.m_invI</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">o.m_invMass</span><span class="PUNC">+</span><span class="NAME">o.m_invI</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_frequencyHz</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">this.m_length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">*</span><span class="NAME">this.m_frequencyHz</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_mass</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this.m_gamma</span><span class="PUNC">=</span><span class="NAME">d.dt</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">this.m_mass</span><span class="PUNC">*</span><span class="NAME">this.m_dampingRatio</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">d.dt</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_gamma</span><span class="PUNC">=</span><span class="NAME">this.m_gamma</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.m_gamma</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_bias</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">d.dt</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_gamma</span><span class="PUNC">;</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">this.m_gamma</span><span class="PUNC">;</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="NAME">this.m_mass</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.m_mass</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.warmStarting</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_u.x</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_u.y</span><span class="PUNC">;</span><span class="NAME">j.m_linearVelocity.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>306</span> </span><span class="NAME">j.m_invMass</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">j.m_linearVelocity.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">j.m_invMass</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">j.m_angularVelocity</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">j.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">o.m_invMass</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">o.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">o.m_invMass</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">o.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">o.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_impulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.SolveVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.y</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">d.col1.x</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">d.col2.x</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">d.col1.y</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">d.col2.y</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">l.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>307</span> </span><span class="NAME">l.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">d.col1.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">d.col2.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d.col1.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">d.col2.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_mass</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_u.x</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">l.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_u.y</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">l.m_linearVelocity.y</span><span class="PUNC">+</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">+</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_bias</span><span class="PUNC">+</span><span class="NAME">this.m_gamma</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_impulse</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">this.m_u.x</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">this.m_u.y</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>308</span> </span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">l.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">U.prototype.SolvePositionConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_frequencyHz</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.y</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">d.col1.x</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">d.col2.x</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">d.col1.y</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">d.col2.y</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">l.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>309</span> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">d.col1.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">d.col2.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d.col1.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">d.col2.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.c.x</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">l.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.c.y</span><span class="PUNC">-</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.m_length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">F.b2_maxLinearCorrection</span><span class="PUNC">,</span><span class="NAME">F.b2_maxLinearCorrection</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_mass</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.m_u.Set</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_u.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_u.y</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.c.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.c.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.a</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">l.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>310</span> </span><span class="NAME">l.m_sweep.a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">y.Abs</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.prototype</span><span class="PUNC">;</span><span class="NAME">p.b2DistanceJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">p.prototype.b2DistanceJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2JointDef.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">I.e_distanceJoint</span><span class="PUNC">;</span><span class="NAME">this.length</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.dampingRatio</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>311</span> </span><span class="NAME">this.frequencyHz</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">p.prototype.Initialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.bodyA</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.bodyB</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA.SetV</span><span class="PUNC">(</span><span class="NAME">this.bodyA.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB.SetV</span><span class="PUNC">(</span><span class="NAME">this.bodyB.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">j.x</span><span class="PUNC">-</span><span class="NAME">l.x</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">j.y</span><span class="PUNC">-</span><span class="NAME">l.y</span><span class="PUNC">;</span><span class="NAME">this.length</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.dampingRatio</span><span class="PUNC">=</span><span class="NAME">this.frequencyHz</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">B.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.prototype</span><span class="PUNC">;</span><span class="NAME">B.b2FrictionJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.b2Joint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchorA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>312</span> </span><span class="NAME">this.m_localAnchorB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_linearMass</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">this.m_linearImpulse</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.GetAnchorA</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyA.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchorA</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.GetAnchorB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyB.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchorB</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.GetReactionForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_linearImpulse.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_linearImpulse.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.GetReactionTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_angularImpulse</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.SetMaxForce</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>313</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_maxForce</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.GetMaxForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_maxForce</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.SetMaxTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_maxTorque</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.GetMaxTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_maxTorque</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.b2FrictionJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2Joint.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchorA.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchorB.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_linearMass.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_angularMass</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_linearImpulse.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_angularImpulse</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>314</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_maxForce</span><span class="PUNC">=</span><span class="NAME">d.maxForce</span><span class="PUNC">;</span><span class="NAME">this.m_maxTorque</span><span class="PUNC">=</span><span class="NAME">d.maxTorque</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.InitVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorA.x</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorA.y</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">o.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorB.x</span><span class="PUNC">-</span><span class="NAME">o.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorB.y</span><span class="PUNC">-</span><span class="NAME">o.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j.m_invMass</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">o.m_invMass</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>315</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">j.m_invI</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">o.m_invI</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">e.col1.x</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">e.col2.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e.col1.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e.col2.y</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">e.col1.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">e.col2.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">e.col1.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">e.col2.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">e.col1.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">e.col2.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">e.col1.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">e.col2.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">e.GetInverse</span><span class="PUNC">(</span><span class="NAME">this.m_linearMass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_angularMass</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_angularMass</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="NAME">this.m_angularMass</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.m_angularMass</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.warmStarting</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_linearImpulse.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">this.m_linearImpulse.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">this.m_angularImpulse</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_linearImpulse</span><span class="PUNC">;</span><span class="NAME">j.m_linearVelocity.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">d.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>316</span> </span><span class="NAME">j.m_linearVelocity.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">d.y</span><span class="PUNC">;</span><span class="NAME">j.m_angularVelocity</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">d.y</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">d.x</span><span class="PUNC">+</span><span class="NAME">this.m_angularImpulse</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">d.x</span><span class="PUNC">;</span><span class="NAME">o.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">d.y</span><span class="PUNC">;</span><span class="NAME">o.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">d.y</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d.x</span><span class="PUNC">+</span><span class="NAME">this.m_angularImpulse</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_linearImpulse.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_angularImpulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.SolveVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">j.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">o.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">o.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">j.m_invMass</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">o.m_invMass</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">j.m_invI</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">o.m_invI</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>317</span> </span><span class="NAME">this.m_localAnchorA.x</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorA.y</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">o.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorB.x</span><span class="PUNC">-</span><span class="NAME">o.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorB.y</span><span class="PUNC">-</span><span class="NAME">o.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_angularMass</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">this.m_angularImpulse</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.dt</span><span class="PUNC">*</span><span class="NAME">this.m_maxTorque</span><span class="PUNC">;</span><span class="NAME">this.m_angularImpulse</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">this.m_angularImpulse</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_angularImpulse</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">y.MulMV</span><span class="PUNC">(</span><span class="NAME">this.m_linearMass</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>318</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">q.x</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">q.y</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_linearImpulse.Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_linearImpulse.Add</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.dt</span><span class="PUNC">*</span><span class="NAME">this.m_maxForce</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_linearImpulse.LengthSquared</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_linearImpulse.Normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_linearImpulse.Multiply</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">y.SubtractVV</span><span class="PUNC">(</span><span class="NAME">this.m_linearImpulse</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">h.x</span><span class="PUNC">;</span><span class="NAME">q.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">h.y</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">h.y</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">h.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">h.x</span><span class="PUNC">;</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">h.y</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">h.y</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">h.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">o.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">B.prototype.SolvePositionConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>319</span> </span><span class="NAME">Q.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.prototype</span><span class="PUNC">;</span><span class="NAME">Q.b2FrictionJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Q.prototype.b2FrictionJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2JointDef.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">I.e_frictionJoint</span><span class="PUNC">;</span><span class="NAME">this.maxTorque</span><span class="PUNC">=</span><span class="NAME">this.maxForce</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Q.prototype.Initialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.bodyA</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.bodyB</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA.SetV</span><span class="PUNC">(</span><span class="NAME">this.bodyA.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB.SetV</span><span class="PUNC">(</span><span class="NAME">this.bodyB.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>320</span> </span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">V.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.prototype</span><span class="PUNC">;</span><span class="NAME">V.b2GearJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.b2Joint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_groundAnchor1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_groundAnchor2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_J</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.prototype.GetAnchorA</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyA.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.prototype.GetAnchorB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyB.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.prototype.GetReactionForce</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>321</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearB.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearB.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.prototype.GetReactionTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB.m_xf.R</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">this.m_bodyB.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">this.m_bodyB.m_sweep.localCenter.y</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_J.angularB</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearB.y</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearB.x</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.prototype.GetRatio</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>322</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_ratio</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.prototype.SetRatio</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_ratio</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.prototype.b2GearJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2Joint.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">d.joint1.m_type</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">d.joint2.m_type</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_prismatic2</span><span class="PUNC">=</span><span class="NAME">this.m_revolute2</span><span class="PUNC">=</span><span class="NAME">this.m_prismatic1</span><span class="PUNC">=</span><span class="NAME">this.m_revolute1</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_ground1</span><span class="PUNC">=</span><span class="NAME">d.joint1.GetBodyA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyA</span><span class="PUNC">=</span><span class="NAME">d.joint1.GetBodyB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">==</span><span class="NAME">I.e_revoluteJoint</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_revolute1</span><span class="PUNC">=</span><span class="NAME">d.joint1</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">?</span><span class="NAME">d.joint1</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_groundAnchor1.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_revolute1.m_localAnchor1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>323</span> </span><span class="NAME">this.m_localAnchor1.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_revolute1.m_localAnchor2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_revolute1.GetJointAngle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_prismatic1</span><span class="PUNC">=</span><span class="NAME">d.joint1</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">?</span><span class="NAME">d.joint1</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_groundAnchor1.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_prismatic1.m_localAnchor1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor1.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_prismatic1.m_localAnchor2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_prismatic1.GetJointTranslation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.m_ground2</span><span class="PUNC">=</span><span class="NAME">d.joint2.GetBodyA</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB</span><span class="PUNC">=</span><span class="NAME">d.joint2.GetBodyB</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">==</span><span class="NAME">I.e_revoluteJoint</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_revolute2</span><span class="PUNC">=</span><span class="NAME">d.joint2</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">?</span><span class="NAME">d.joint2</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_groundAnchor2.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_revolute2.m_localAnchor1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>324</span> </span><span class="NAME">this.m_localAnchor2.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_revolute2.m_localAnchor2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_revolute2.GetJointAngle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_prismatic2</span><span class="PUNC">=</span><span class="NAME">d.joint2</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">?</span><span class="NAME">d.joint2</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_groundAnchor2.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_prismatic2.m_localAnchor1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor2.SetV</span><span class="PUNC">(</span><span class="NAME">this.m_prismatic2.m_localAnchor2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_prismatic2.GetJointTranslation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.m_ratio</span><span class="PUNC">=</span><span class="NAME">d.ratio</span><span class="PUNC">;</span><span class="NAME">this.m_constant</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">this.m_impulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.prototype.InitVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_ground1</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_ground2</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>325</span> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_J.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_revolute1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_J.angularA</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">j.m_invI</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_prismatic1.m_localXAxis1</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j.m_xf.R</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">this.m_J.linearA.Set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_J.angularA</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">j.m_invMass</span><span class="PUNC">+</span><span class="NAME">j.m_invI</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_revolute2</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_J.angularB</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>326</span> </span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">o.m_invI</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">l.m_xf.R</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_prismatic2.m_localXAxis1</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">o.m_xf.R</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">o.m_sweep.localCenter.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">o.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">this.m_J.linearB.Set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_J.angularB</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o.m_invMass</span><span class="PUNC">+</span><span class="NAME">o.m_invI</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.warmStarting</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>327</span> </span><span class="NAME">j.m_invMass</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearA.x</span><span class="PUNC">;</span><span class="NAME">j.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">j.m_invMass</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearA.y</span><span class="PUNC">;</span><span class="NAME">j.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">j.m_invI</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_J.angularA</span><span class="PUNC">;</span><span class="NAME">o.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">o.m_invMass</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearB.x</span><span class="PUNC">;</span><span class="NAME">o.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">o.m_invMass</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearB.y</span><span class="PUNC">;</span><span class="NAME">o.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">o.m_invI</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_J.angularB</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_impulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.prototype.SolveVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_mass</span><span class="PUNC">*</span><span class="NAME">this.m_J.Compute</span><span class="PUNC">(</span><span class="NAME">d.m_linearVelocity</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>328</span> </span><span class="NAME">d.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">h.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_impulse</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">d.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invMass</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearA.x</span><span class="PUNC">;</span><span class="NAME">d.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invMass</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearA.y</span><span class="PUNC">;</span><span class="NAME">d.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invI</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_J.angularA</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearB.x</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearB.y</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_J.angularB</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">V.prototype.SolvePositionConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_revolute1</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>329</span> </span><span class="NAME">this.m_revolute1.GetJointAngle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.m_prismatic1.GetJointTranslation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_revolute2</span><span class="PUNC">?</span><span class="NAME">this.m_revolute2.GetJointAngle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.m_prismatic2.GetJointTranslation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_mass</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_constant</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invMass</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearA.x</span><span class="PUNC">;</span><span class="NAME">d.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invMass</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearA.y</span><span class="PUNC">;</span><span class="NAME">d.m_sweep.a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invI</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_J.angularA</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearB.x</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_J.linearB.y</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_J.angularB</span><span class="PUNC">;</span><span class="NAME">d.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>330</span> </span><span class="NAME">h.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">M.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.prototype</span><span class="PUNC">;</span><span class="NAME">M.b2GearJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">M.prototype.b2GearJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2JointDef.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">I.e_gearJoint</span><span class="PUNC">;</span><span class="NAME">this.joint2</span><span class="PUNC">=</span><span class="NAME">this.joint1</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.ratio</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.b2Jacobian</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.linearA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.linearB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.prototype.SetZero</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.linearA.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>331</span> </span><span class="NAME">this.angularA</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.linearB.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.angularB</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.prototype.Set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.linearA.SetV</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.angularA</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">this.linearB.SetV</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.angularB</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">L.prototype.Compute</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.linearA.x</span><span class="PUNC">*</span><span class="NAME">d.x</span><span class="PUNC">+</span><span class="NAME">this.linearA.y</span><span class="PUNC">*</span><span class="NAME">d.y</span><span class="PUNC">+</span><span class="NAME">this.angularA</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.linearB.x</span><span class="PUNC">*</span><span class="NAME">l.x</span><span class="PUNC">+</span><span class="NAME">this.linearB.y</span><span class="PUNC">*</span><span class="NAME">l.y</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.angularB</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.b2Joint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_edgeA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Y</span><span class="PUNC">;</span><span class="NAME">this.m_edgeB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Y</span><span class="PUNC">;</span><span class="NAME">this.m_localCenterA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localCenterB</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>332</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.GetType</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_type</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.GetAnchorA</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.GetAnchorB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.GetReactionForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.GetReactionTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.GetBodyA</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyA</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.GetBodyB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyB</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.GetNext</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_next</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.GetUserData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_userData</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.SetUserData</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_userData</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>333</span> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.IsActive</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyA.IsActive</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.m_bodyB.IsActive</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.Create</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">d.type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">I.e_distanceJoint</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">I.e_mouseJoint</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">I.e_prismaticJoint</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">O</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">I.e_revoluteJoint</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">S</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">I.e_pulleyJoint</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">E</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">R</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">I.e_gearJoint</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">M</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">I.e_lineJoint</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>334</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">I.e_weldJoint</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">aa</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Z</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">I.e_frictionJoint</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Q</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.Destroy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.b2Joint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">F.b2Assert</span><span class="PUNC">(</span><span class="NAME">d.bodyA</span><span class="PUNC">!=</span><span class="NAME">d.bodyB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_type</span><span class="PUNC">=</span><span class="NAME">d.type</span><span class="PUNC">;</span><span class="NAME">this.m_next</span><span class="PUNC">=</span><span class="NAME">this.m_prev</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.m_bodyA</span><span class="PUNC">=</span><span class="NAME">d.bodyA</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB</span><span class="PUNC">=</span><span class="NAME">d.bodyB</span><span class="PUNC">;</span><span class="NAME">this.m_collideConnected</span><span class="PUNC">=</span><span class="NAME">d.collideConnected</span><span class="PUNC">;</span><span class="NAME">this.m_islandFlag</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.m_userData</span><span class="PUNC">=</span><span class="NAME">d.userData</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.InitVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.SolveVelocityConstraints</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>335</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.FinalizeVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">I.prototype.SolvePositionConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_unknownJoint</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_distanceJoint</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_mouseJoint</span><span class="PUNC">=</span><span class="NUMB">5</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_gearJoint</span><span class="PUNC">=</span><span class="NUMB">6</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_lineJoint</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>336</span> </span><span class="NUMB">7</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_weldJoint</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_frictionJoint</span><span class="PUNC">=</span><span class="NUMB">9</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.e_equalLimits</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">W.b2JointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">W.prototype.b2JointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">I.e_unknownJoint</span><span class="PUNC">;</span><span class="NAME">this.bodyB</span><span class="PUNC">=</span><span class="NAME">this.bodyA</span><span class="PUNC">=</span><span class="NAME">this.userData</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.collideConnected</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Y.b2JointEdge</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>337</span> </span><span class="NAME">k.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.prototype</span><span class="PUNC">;</span><span class="NAME">k.b2LineJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.b2Joint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localXAxis1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localYAxis1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_axis</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_perp</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_K</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">this.m_impulse</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetAnchorA</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyA.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetAnchorB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyB.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetReactionForce</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>338</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetReactionTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetJointTranslation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j.x</span><span class="PUNC">-</span><span class="NAME">l.x</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">j.y</span><span class="PUNC">-</span><span class="NAME">l.y</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.GetWorldVector</span><span class="PUNC">(</span><span class="NAME">this.m_localXAxis1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>339</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">d.y</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetJointSpeed</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">d.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">d.m_sweep.localCenter.y</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l.col1.x</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">l.col2.x</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">l.col1.y</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">l.col2.y</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l.col1.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">l.col2.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">l.col1.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">l.col2.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">d.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">d.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.GetWorldVector</span><span class="PUNC">(</span><span class="NAME">this.m_localXAxis1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>340</span> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">h.m_linearVelocity</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.m_angularVelocity</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">c.y</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">c.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">g.x</span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">c.y</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b.y</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">g.y</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.IsLimitEnabled</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_enableLimit</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.EnableLimit</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_bodyA.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetLowerLimit</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetUpperLimit</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetLimits</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>341</span> </span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_bodyA.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.IsMotorEnabled</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_enableMotor</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.EnableMotor</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_bodyA.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_enableMotor</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SetMotorSpeed</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_bodyA.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_motorSpeed</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetMotorSpeed</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_motorSpeed</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>342</span> </span><span class="NAME">k.prototype.SetMaxMotorForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_bodyA.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_maxMotorForce</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetMaxMotorForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_maxMotorForce</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.GetMotorForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.b2LineJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2Joint.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor1.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor2.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localXAxis1.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAxisA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localYAxis1.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_localXAxis1.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>343</span> </span><span class="NAME">this.m_localYAxis1.y</span><span class="PUNC">=</span><span class="NAME">this.m_localXAxis1.x</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">=</span><span class="NAME">this.m_motorMass</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">=</span><span class="NAME">d.lowerTranslation</span><span class="PUNC">;</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">=</span><span class="NAME">d.upperTranslation</span><span class="PUNC">;</span><span class="NAME">this.m_maxMotorForce</span><span class="PUNC">=</span><span class="NAME">d.maxMotorForce</span><span class="PUNC">;</span><span class="NAME">this.m_motorSpeed</span><span class="PUNC">=</span><span class="NAME">d.motorSpeed</span><span class="PUNC">;</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">=</span><span class="NAME">d.enableLimit</span><span class="PUNC">;</span><span class="NAME">this.m_enableMotor</span><span class="PUNC">=</span><span class="NAME">d.enableMotor</span><span class="PUNC">;</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">;</span><span class="NAME">this.m_axis.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_perp.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.InitVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_localCenterA.SetV</span><span class="PUNC">(</span><span class="NAME">h.GetLocalCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>344</span> </span><span class="NAME">this.m_localCenterB.SetV</span><span class="PUNC">(</span><span class="NAME">l.GetLocalCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">h.GetTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.GetTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterA.x</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterA.y</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">j.col1.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">j.col2.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.col1.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">j.col2.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">l.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterB.x</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterB.y</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">j.col1.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">j.col2.x</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">j.col1.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">j.col2.y</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">l.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.c.x</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">l.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.c.y</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.m_invMassA</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">;</span><span class="NAME">this.m_invMassB</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>345</span> </span><span class="NAME">l.m_invMass</span><span class="PUNC">;</span><span class="NAME">this.m_invIA</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">;</span><span class="NAME">this.m_invIB</span><span class="PUNC">=</span><span class="NAME">l.m_invI</span><span class="PUNC">;</span><span class="NAME">this.m_axis.SetV</span><span class="PUNC">(</span><span class="NAME">y.MulMV</span><span class="PUNC">(</span><span class="NAME">q.R</span><span class="PUNC">,</span><span class="NAME">this.m_localXAxis1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_a1</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="NAME">this.m_a2</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="NAME">this.m_motorMass</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">+</span><span class="NAME">this.m_invMassB</span><span class="PUNC">+</span><span class="NAME">this.m_invIA</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">+</span><span class="NAME">this.m_invIB</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">this.m_motorMass</span><span class="PUNC">=</span><span class="NAME">this.m_motorMass</span><span class="PUNC">></span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.m_motorMass</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_perp.SetV</span><span class="PUNC">(</span><span class="NAME">y.MulMV</span><span class="PUNC">(</span><span class="NAME">q.R</span><span class="PUNC">,</span><span class="NAME">this.m_localYAxis1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_s1</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">;</span><span class="NAME">this.m_s2</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>346</span> </span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">;</span><span class="NAME">this.m_K.col1.x</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">;</span><span class="NAME">this.m_K.col1.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">this.m_K.col2.x</span><span class="PUNC">=</span><span class="NAME">this.m_K.col1.y</span><span class="PUNC">;</span><span class="NAME">this.m_K.col2.y</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_axis.x</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">this.m_axis.y</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y.Abs</span><span class="PUNC">(</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">-</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">)</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_equalLimits</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">&lt;=</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">!=</span><span class="WHIT">
<span class='line'>347</span> </span><span class="NAME">I.e_atLowerLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_atLowerLimit</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">>=</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">!=</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableMotor</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.warmStarting</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>348</span> </span><span class="NAME">this.m_impulse.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">l.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">l.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>349</span> </span><span class="NAME">q</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_impulse.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SolveVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableMotor</span><span class="PUNC">&&</span><span class="NAME">this.m_limitState</span><span class="PUNC">!=</span><span class="NAME">I.e_equalLimits</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_motorMass</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_motorSpeed</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_axis.x</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q.x</span><span class="PUNC">-</span><span class="NAME">j.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_axis.y</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q.y</span><span class="PUNC">-</span><span class="NAME">j.y</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_a2</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">this.m_a1</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.dt</span><span class="PUNC">*</span><span class="NAME">this.m_maxMotorForce</span><span class="PUNC">;</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>350</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">j.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">j.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">q.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">q.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_perp.x</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q.x</span><span class="PUNC">-</span><span class="NAME">j.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_perp.y</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q.y</span><span class="PUNC">-</span><span class="NAME">j.y</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_s2</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">this.m_s1</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">&&</span><span class="NAME">this.m_limitState</span><span class="PUNC">!=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_axis.x</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q.x</span><span class="PUNC">-</span><span class="NAME">j.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_axis.y</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q.y</span><span class="PUNC">-</span><span class="NAME">j.y</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_a2</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">this.m_a1</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_K.Solve</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.Add</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>351</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">==</span><span class="NAME">I.e_atLowerLimit</span><span class="PUNC">)</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">=</span><span class="NAME">y.Max</span><span class="PUNC">(</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">==</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">)</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">=</span><span class="NAME">y.Min</span><span class="PUNC">(</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_K.col2.x</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_K.col1.x</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NAME">this.m_K.col1.x</span><span class="PUNC">+</span><span class="NAME">a.x</span><span class="PUNC">:</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">d.x</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">d.y</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">+</span><span class="NAME">d.y</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">+</span><span class="NAME">d.y</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">d.y</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">+</span><span class="NAME">d.y</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_K.col1.x</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>352</span> </span><span class="NAME">this.m_K.col1.x</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">}</span><span class="NAME">j.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">j.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">q.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">q.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.SetV</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">l.m_linearVelocity.SetV</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">k.prototype.SolvePositionConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d.m_sweep.c</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d.m_sweep.a</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.c</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.a</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>353</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">G.FromAngle</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">G.FromAngle</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterA.x</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterA.y</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">n.col1.x</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">n.col2.x</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">n.col1.y</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">n.col2.y</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterB.x</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterB.y</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">n.col1.x</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">n.col2.x</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">n.col1.y</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">n.col2.y</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">o.x</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">l.x</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">o.y</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">l.y</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_axis</span><span class="PUNC">=</span><span class="NAME">y.MulMV</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">this.m_localXAxis1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_a1</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="NAME">this.m_a2</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>354</span> </span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">this.m_axis.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">this.m_axis.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y.Abs</span><span class="PUNC">(</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">-</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">F.b2_maxLinearCorrection</span><span class="PUNC">,</span><span class="NAME">F.b2_maxLinearCorrection</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">y.Abs</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">&lt;=</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">+</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">F.b2_maxLinearCorrection</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">>=</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">+</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">F.b2_maxLinearCorrection</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>355</span> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.m_perp</span><span class="PUNC">=</span><span class="NAME">y.MulMV</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">this.m_localYAxis1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_s1</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">;</span><span class="NAME">this.m_s2</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">this.m_perp.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">this.m_perp.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">y.Max</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">y.Abs</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">;</span><span class="NAME">this.m_K.col1.x</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">;</span><span class="NAME">this.m_K.col1.y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">this.m_K.col2.x</span><span class="PUNC">=</span><span class="NAME">this.m_K.col1.y</span><span class="PUNC">;</span><span class="NAME">this.m_K.col2.y</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">this.m_K.Solve</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>356</span> </span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">/</span><span class="NAME">m</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r.x</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">r.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">r.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">+</span><span class="NAME">r.y</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">r.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">+</span><span class="NAME">r.y</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">r.x</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">r.y</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">r.x</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">+</span><span class="NAME">r.y</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">l.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">l.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">o.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">o.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">d.m_sweep.a</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.a</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">d.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">&lt;=</span><span class="WHIT">
<span class='line'>357</span> </span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">&&</span><span class="NAME">f</span><span class="PUNC">&lt;=</span><span class="NAME">F.b2_angularSlop</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">z.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.prototype</span><span class="PUNC">;</span><span class="NAME">z.b2LineJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.localAxisA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">z.prototype.b2LineJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2JointDef.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">I.e_lineJoint</span><span class="PUNC">;</span><span class="NAME">this.localAxisA.Set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.enableLimit</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.upperTranslation</span><span class="PUNC">=</span><span class="NAME">this.lowerTranslation</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>358</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.enableMotor</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.motorSpeed</span><span class="PUNC">=</span><span class="NAME">this.maxMotorForce</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">z.prototype.Initialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.bodyA</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.bodyB</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA</span><span class="PUNC">=</span><span class="NAME">this.bodyA.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB</span><span class="PUNC">=</span><span class="NAME">this.bodyB.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAxisA</span><span class="PUNC">=</span><span class="NAME">this.bodyA.GetLocalVector</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">u.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.prototype</span><span class="PUNC">;</span><span class="NAME">u.b2MouseJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.b2Joint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.K</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">this.K1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">this.K2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>359</span> </span><span class="NAME">this.m_localAnchor</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_target</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_impulse</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">this.m_C</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.GetAnchorA</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_target</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.GetAnchorB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyB.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.GetReactionForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.GetReactionTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.GetTarget</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_target</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.SetTarget</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_bodyB.IsAwake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>360</span> </span><span class="KEYW">false</span><span class="PUNC">&&</span><span class="NAME">this.m_bodyB.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_target</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.GetMaxForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_maxForce</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.SetMaxForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_maxForce</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.GetFrequency</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_frequencyHz</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.SetFrequency</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_frequencyHz</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.GetDampingRatio</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_dampingRatio</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.SetDampingRatio</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_dampingRatio</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.b2MouseJoint</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>361</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2Joint.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_target.SetV</span><span class="PUNC">(</span><span class="NAME">d.target</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_target.x</span><span class="PUNC">-</span><span class="NAME">this.m_bodyB.m_xf.position.x</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_target.y</span><span class="PUNC">-</span><span class="NAME">this.m_bodyB.m_xf.position.y</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB.m_xf.R</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor.x</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">j.col1.x</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">j.col1.y</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor.y</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">j.col2.x</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">j.col2.y</span><span class="PUNC">;</span><span class="NAME">this.m_maxForce</span><span class="PUNC">=</span><span class="NAME">d.maxForce</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_frequencyHz</span><span class="PUNC">=</span><span class="NAME">d.frequencyHz</span><span class="PUNC">;</span><span class="NAME">this.m_dampingRatio</span><span class="PUNC">=</span><span class="NAME">d.dampingRatio</span><span class="PUNC">;</span><span class="NAME">this.m_gamma</span><span class="PUNC">=</span><span class="NAME">this.m_beta</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.InitVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.GetMass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>362</span> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">*</span><span class="NAME">this.m_frequencyHz</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.m_gamma</span><span class="PUNC">=</span><span class="NAME">d.dt</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_dampingRatio</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">d.dt</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_gamma</span><span class="PUNC">=</span><span class="NAME">this.m_gamma</span><span class="PUNC">!=</span><span class="NUMB">0</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.m_gamma</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_beta</span><span class="PUNC">=</span><span class="NAME">d.dt</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">this.m_gamma</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor.x</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.x</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor.y</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">o.col1.x</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">o.col2.x</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">o.col1.y</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">o.col2.y</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">;</span><span class="NAME">this.K1.col1.x</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">this.K1.col2.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.K1.col1.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.K1.col2.y</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">this.K2.col1.x</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.K2.col2.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.K2.col1.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.K2.col2.y</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>363</span> </span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">this.K.SetM</span><span class="PUNC">(</span><span class="NAME">this.K1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.K.AddM</span><span class="PUNC">(</span><span class="NAME">this.K2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.K.col1.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_gamma</span><span class="PUNC">;</span><span class="NAME">this.K.col2.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_gamma</span><span class="PUNC">;</span><span class="NAME">this.K.GetInverse</span><span class="PUNC">(</span><span class="NAME">this.m_mass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_C.x</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">this.m_target.x</span><span class="PUNC">;</span><span class="NAME">this.m_C.y</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">this.m_target.y</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">0.98</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.SolveVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>364</span> </span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor.x</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor.y</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">l.col1.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">l.col2.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">l.col1.y</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">l.col2.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">+</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_mass</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">this.m_beta</span><span class="PUNC">*</span><span class="NAME">this.m_C.x</span><span class="PUNC">+</span><span class="NAME">this.m_gamma</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">this.m_beta</span><span class="PUNC">*</span><span class="NAME">this.m_C.y</span><span class="PUNC">+</span><span class="NAME">this.m_gamma</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">l.col1.x</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">l.col2.x</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">l.col1.y</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">l.col2.y</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>365</span> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.dt</span><span class="PUNC">*</span><span class="NAME">this.m_maxForce</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.LengthSquared</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">this.m_impulse.Multiply</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NAME">this.m_impulse.Length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">u.prototype.SolvePositionConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.prototype</span><span class="PUNC">;</span><span class="NAME">D.b2MouseJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>366</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.target</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">D.prototype.b2MouseJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2JointDef.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">I.e_mouseJoint</span><span class="PUNC">;</span><span class="NAME">this.maxForce</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.frequencyHz</span><span class="PUNC">=</span><span class="NUMB">5</span><span class="PUNC">;</span><span class="NAME">this.dampingRatio</span><span class="PUNC">=</span><span class="NUMB">0.7</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">H.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.prototype</span><span class="PUNC">;</span><span class="NAME">H.b2PrismaticJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.b2Joint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localXAxis1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localYAxis1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_axis</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>367</span> </span><span class="NAME">this.m_perp</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_K</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">this.m_impulse</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.GetAnchorA</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyA.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.GetAnchorB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyB.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.GetReactionForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.GetReactionTorque</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>368</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.GetJointTranslation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j.x</span><span class="PUNC">-</span><span class="NAME">l.x</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">j.y</span><span class="PUNC">-</span><span class="NAME">l.y</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.GetWorldVector</span><span class="PUNC">(</span><span class="NAME">this.m_localXAxis1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">d.y</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.GetJointSpeed</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">d.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">d.m_sweep.localCenter.y</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l.col1.x</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">l.col2.x</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>369</span> </span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">l.col1.y</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">l.col2.y</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l.col1.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">l.col2.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">l.col1.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">l.col2.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">d.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">d.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.GetWorldVector</span><span class="PUNC">(</span><span class="NAME">this.m_localXAxis1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">h.m_linearVelocity</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.m_angularVelocity</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">c.y</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">c.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">g.x</span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">c.y</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b.y</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">g.y</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.IsLimitEnabled</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_enableLimit</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>370</span> </span><span class="NAME">H.prototype.EnableLimit</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_bodyA.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.GetLowerLimit</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.GetUpperLimit</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.SetLimits</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_bodyA.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.IsMotorEnabled</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_enableMotor</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>371</span> </span><span class="NAME">H.prototype.EnableMotor</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_bodyA.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_enableMotor</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.SetMotorSpeed</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_bodyA.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_motorSpeed</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.GetMotorSpeed</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_motorSpeed</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.SetMaxMotorForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_bodyA.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_maxMotorForce</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.GetMotorForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>372</span> </span><span class="NAME">H.prototype.b2PrismaticJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2Joint.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor1.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor2.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localXAxis1.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAxisA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localYAxis1.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_localXAxis1.y</span><span class="PUNC">;</span><span class="NAME">this.m_localYAxis1.y</span><span class="PUNC">=</span><span class="NAME">this.m_localXAxis1.x</span><span class="PUNC">;</span><span class="NAME">this.m_refAngle</span><span class="PUNC">=</span><span class="NAME">d.referenceAngle</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">=</span><span class="NAME">this.m_motorMass</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">=</span><span class="NAME">d.lowerTranslation</span><span class="PUNC">;</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">=</span><span class="NAME">d.upperTranslation</span><span class="PUNC">;</span><span class="NAME">this.m_maxMotorForce</span><span class="PUNC">=</span><span class="NAME">d.maxMotorForce</span><span class="PUNC">;</span><span class="NAME">this.m_motorSpeed</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>373</span> </span><span class="NAME">d.motorSpeed</span><span class="PUNC">;</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">=</span><span class="NAME">d.enableLimit</span><span class="PUNC">;</span><span class="NAME">this.m_enableMotor</span><span class="PUNC">=</span><span class="NAME">d.enableMotor</span><span class="PUNC">;</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">;</span><span class="NAME">this.m_axis.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_perp.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.InitVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_localCenterA.SetV</span><span class="PUNC">(</span><span class="NAME">h.GetLocalCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localCenterB.SetV</span><span class="PUNC">(</span><span class="NAME">l.GetLocalCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">h.GetTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.GetTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterA.x</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterA.y</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">j.col1.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">j.col2.x</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>374</span> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.col1.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">j.col2.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">l.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterB.x</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterB.y</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">j.col1.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">j.col2.x</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">j.col1.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">j.col2.y</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">l.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.c.x</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">l.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.c.y</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.m_invMassA</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">;</span><span class="NAME">this.m_invMassB</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">;</span><span class="NAME">this.m_invIA</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">;</span><span class="NAME">this.m_invIB</span><span class="PUNC">=</span><span class="NAME">l.m_invI</span><span class="PUNC">;</span><span class="NAME">this.m_axis.SetV</span><span class="PUNC">(</span><span class="NAME">y.MulMV</span><span class="PUNC">(</span><span class="NAME">q.R</span><span class="PUNC">,</span><span class="NAME">this.m_localXAxis1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_a1</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="NAME">this.m_a2</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="NAME">this.m_motorMass</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>375</span> </span><span class="NAME">this.m_invMassA</span><span class="PUNC">+</span><span class="NAME">this.m_invMassB</span><span class="PUNC">+</span><span class="NAME">this.m_invIA</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">+</span><span class="NAME">this.m_invIB</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_motorMass</span><span class="PUNC">></span><span class="NAME">Number.MIN_VALUE</span><span class="PUNC">)</span><span class="NAME">this.m_motorMass</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.m_motorMass</span><span class="PUNC">;</span><span class="NAME">this.m_perp.SetV</span><span class="PUNC">(</span><span class="NAME">y.MulMV</span><span class="PUNC">(</span><span class="NAME">q.R</span><span class="PUNC">,</span><span class="NAME">this.m_localYAxis1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_s1</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">;</span><span class="NAME">this.m_s2</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">;</span><span class="NAME">this.m_K.col1.x</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">;</span><span class="NAME">this.m_K.col1.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">;</span><span class="NAME">this.m_K.col1.z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>376</span> </span><span class="NAME">this.m_s1</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">this.m_K.col2.x</span><span class="PUNC">=</span><span class="NAME">this.m_K.col1.y</span><span class="PUNC">;</span><span class="NAME">this.m_K.col2.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.m_K.col2.z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">this.m_K.col3.x</span><span class="PUNC">=</span><span class="NAME">this.m_K.col1.z</span><span class="PUNC">;</span><span class="NAME">this.m_K.col3.y</span><span class="PUNC">=</span><span class="NAME">this.m_K.col2.z</span><span class="PUNC">;</span><span class="NAME">this.m_K.col3.z</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_axis.x</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">this.m_axis.y</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y.Abs</span><span class="PUNC">(</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">-</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">)</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_equalLimits</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">&lt;=</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">!=</span><span class="NAME">I.e_atLowerLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>377</span> </span><span class="NAME">I.e_atLowerLimit</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">>=</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">!=</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableMotor</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.warmStarting</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>378</span> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">l.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">l.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>379</span> </span><span class="NAME">q</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_impulse.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.SolveVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableMotor</span><span class="PUNC">&&</span><span class="NAME">this.m_limitState</span><span class="PUNC">!=</span><span class="NAME">I.e_equalLimits</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_motorMass</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_motorSpeed</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_axis.x</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q.x</span><span class="PUNC">-</span><span class="NAME">j.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_axis.y</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q.y</span><span class="PUNC">-</span><span class="NAME">j.y</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_a2</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">this.m_a1</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.dt</span><span class="PUNC">*</span><span class="NAME">this.m_maxMotorForce</span><span class="PUNC">;</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>380</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">j.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">j.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">q.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">q.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">}</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_perp.x</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q.x</span><span class="PUNC">-</span><span class="NAME">j.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_perp.y</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q.y</span><span class="PUNC">-</span><span class="NAME">j.y</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_s2</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">this.m_s1</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">o</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">&&</span><span class="NAME">this.m_limitState</span><span class="PUNC">!=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_axis.x</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q.x</span><span class="PUNC">-</span><span class="NAME">j.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_axis.y</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q.y</span><span class="PUNC">-</span><span class="NAME">j.y</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.m_a2</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">this.m_a1</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_K.Solve33</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.Add</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>381</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">==</span><span class="NAME">I.e_atLowerLimit</span><span class="PUNC">)</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">=</span><span class="NAME">y.Max</span><span class="PUNC">(</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">==</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">)</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">=</span><span class="NAME">y.Min</span><span class="PUNC">(</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">-</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_K.col3.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">-</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_K.col3.y</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_K.Solve22</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">=</span><span class="NAME">c.x</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">=</span><span class="NAME">c.y</span><span class="PUNC">;</span><span class="NAME">d.x</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">d.y</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">d.z</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">-</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">+</span><span class="NAME">d.z</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">+</span><span class="NAME">d.z</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>382</span> </span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">d.y</span><span class="PUNC">+</span><span class="NAME">d.z</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">+</span><span class="NAME">d.y</span><span class="PUNC">+</span><span class="NAME">d.z</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_K.Solve22</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.y</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">d.y</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">+</span><span class="NAME">d.y</span><span class="PUNC">}</span><span class="NAME">j.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">j.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">q.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">q.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.SetV</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">l.m_linearVelocity.SetV</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">H.prototype.SolvePositionConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>383</span> </span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d.m_sweep.c</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d.m_sweep.a</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.c</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.a</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">G.FromAngle</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">G.FromAngle</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterA.x</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterA.y</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">n.col1.x</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">n.col2.x</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">n.col1.y</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">n.col2.y</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterB.x</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">this.m_localCenterB.y</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">n.col1.x</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NAME">n.col2.x</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">n.col1.y</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NAME">n.col2.y</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">o.x</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">l.x</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">o.y</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">l.y</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_axis</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>384</span> </span><span class="NAME">y.MulMV</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">this.m_localXAxis1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_a1</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="NAME">this.m_a2</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">this.m_axis.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">this.m_axis.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y.Abs</span><span class="PUNC">(</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">-</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">F.b2_maxLinearCorrection</span><span class="PUNC">,</span><span class="NAME">F.b2_maxLinearCorrection</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">y.Abs</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">&lt;=</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">+</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">F.b2_maxLinearCorrection</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_lowerTranslation</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">>=</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>385</span> </span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">+</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">F.b2_maxLinearCorrection</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">this.m_upperTranslation</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.m_perp</span><span class="PUNC">=</span><span class="NAME">y.MulMV</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">this.m_localYAxis1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_s1</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">;</span><span class="NAME">this.m_s2</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">this.m_perp.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">this.m_perp.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">this.m_refAngle</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">y.Max</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">y.Abs</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">y.Abs</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">;</span><span class="NAME">this.m_K.col1.x</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">;</span><span class="NAME">this.m_K.col1.y</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>386</span> </span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">;</span><span class="NAME">this.m_K.col1.z</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">this.m_K.col2.x</span><span class="PUNC">=</span><span class="NAME">this.m_K.col1.y</span><span class="PUNC">;</span><span class="NAME">this.m_K.col2.y</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.m_K.col2.z</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">this.m_K.col3.x</span><span class="PUNC">=</span><span class="NAME">this.m_K.col1.z</span><span class="PUNC">;</span><span class="NAME">this.m_K.col3.y</span><span class="PUNC">=</span><span class="NAME">this.m_K.col2.z</span><span class="PUNC">;</span><span class="NAME">this.m_K.col3.z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">this.m_K.Solve33</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.m_K.col1.Set</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_K.col2.Set</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>387</span> </span><span class="NAME">v</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_K.Solve22</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.x</span><span class="PUNC">=</span><span class="NAME">f.x</span><span class="PUNC">;</span><span class="NAME">m.y</span><span class="PUNC">=</span><span class="NAME">f.y</span><span class="PUNC">;</span><span class="NAME">m.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">m.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.x</span><span class="PUNC">+</span><span class="NAME">m.z</span><span class="PUNC">*</span><span class="NAME">this.m_axis.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">m.x</span><span class="PUNC">*</span><span class="NAME">this.m_perp.y</span><span class="PUNC">+</span><span class="NAME">m.z</span><span class="PUNC">*</span><span class="NAME">this.m_axis.y</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">m.x</span><span class="PUNC">*</span><span class="NAME">this.m_s1</span><span class="PUNC">+</span><span class="NAME">m.y</span><span class="PUNC">+</span><span class="NAME">m.z</span><span class="PUNC">*</span><span class="NAME">this.m_a1</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">m.x</span><span class="PUNC">*</span><span class="NAME">this.m_s2</span><span class="PUNC">+</span><span class="NAME">m.y</span><span class="PUNC">+</span><span class="NAME">m.z</span><span class="PUNC">*</span><span class="NAME">this.m_a2</span><span class="PUNC">;</span><span class="NAME">l.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">l.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invMassA</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.m_invIA</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">o.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">o.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invMassB</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.m_invIB</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">d.m_sweep.a</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.a</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">d.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">&lt;=</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">&lt;=</span><span class="NAME">F.b2_angularSlop</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">O</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>388</span> </span><span class="NAME">O.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.prototype</span><span class="PUNC">;</span><span class="NAME">O.b2PrismaticJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.localAxisA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">O.prototype.b2PrismaticJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2JointDef.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">I.e_prismaticJoint</span><span class="PUNC">;</span><span class="NAME">this.localAxisA.Set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.referenceAngle</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.enableLimit</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.upperTranslation</span><span class="PUNC">=</span><span class="NAME">this.lowerTranslation</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.enableMotor</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.motorSpeed</span><span class="PUNC">=</span><span class="NAME">this.maxMotorForce</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>389</span> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">O.prototype.Initialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.bodyA</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.bodyB</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA</span><span class="PUNC">=</span><span class="NAME">this.bodyA.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB</span><span class="PUNC">=</span><span class="NAME">this.bodyB.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAxisA</span><span class="PUNC">=</span><span class="NAME">this.bodyA.GetLocalVector</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.referenceAngle</span><span class="PUNC">=</span><span class="NAME">this.bodyB.GetAngle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this.bodyA.GetAngle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">E</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">E.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.prototype</span><span class="PUNC">;</span><span class="NAME">E.b2PulleyJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.b2Joint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_groundAnchor1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_groundAnchor2</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>390</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_u1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_u2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetAnchorA</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyA.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetAnchorB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyB.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetReactionForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_u2.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="NAME">this.m_u2.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetReactionTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetGroundAnchorA</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>391</span> </span><span class="NAME">this.m_ground.m_xf.position.Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.Add</span><span class="PUNC">(</span><span class="NAME">this.m_groundAnchor1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetGroundAnchorB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_ground.m_xf.position.Copy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.Add</span><span class="PUNC">(</span><span class="NAME">this.m_groundAnchor2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetLength1</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_ground.m_xf.position.x</span><span class="PUNC">+</span><span class="NAME">this.m_groundAnchor1.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_ground.m_xf.position.y</span><span class="PUNC">+</span><span class="NAME">this.m_groundAnchor1.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetLength2</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>392</span> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.x</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_ground.m_xf.position.x</span><span class="PUNC">+</span><span class="NAME">this.m_groundAnchor2.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_ground.m_xf.position.y</span><span class="PUNC">+</span><span class="NAME">this.m_groundAnchor2.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.GetRatio</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_ratio</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.b2PulleyJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2Joint.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_ground</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA.m_world.m_groundBody</span><span class="PUNC">;</span><span class="NAME">this.m_groundAnchor1.x</span><span class="PUNC">=</span><span class="NAME">d.groundAnchorA.x</span><span class="PUNC">-</span><span class="NAME">this.m_ground.m_xf.position.x</span><span class="PUNC">;</span><span class="NAME">this.m_groundAnchor1.y</span><span class="PUNC">=</span><span class="NAME">d.groundAnchorA.y</span><span class="PUNC">-</span><span class="NAME">this.m_ground.m_xf.position.y</span><span class="PUNC">;</span><span class="NAME">this.m_groundAnchor2.x</span><span class="PUNC">=</span><span class="NAME">d.groundAnchorB.x</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>393</span> </span><span class="NAME">this.m_ground.m_xf.position.x</span><span class="PUNC">;</span><span class="NAME">this.m_groundAnchor2.y</span><span class="PUNC">=</span><span class="NAME">d.groundAnchorB.y</span><span class="PUNC">-</span><span class="NAME">this.m_ground.m_xf.position.y</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor1.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor2.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_ratio</span><span class="PUNC">=</span><span class="NAME">d.ratio</span><span class="PUNC">;</span><span class="NAME">this.m_constant</span><span class="PUNC">=</span><span class="NAME">d.lengthA</span><span class="PUNC">+</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">d.lengthB</span><span class="PUNC">;</span><span class="NAME">this.m_maxLength1</span><span class="PUNC">=</span><span class="NAME">y.Min</span><span class="PUNC">(</span><span class="NAME">d.maxLengthA</span><span class="PUNC">,</span><span class="NAME">this.m_constant</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">E.b2_minPulleyLength</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_maxLength2</span><span class="PUNC">=</span><span class="NAME">y.Min</span><span class="PUNC">(</span><span class="NAME">d.maxLengthB</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">this.m_constant</span><span class="PUNC">-</span><span class="NAME">E.b2_minPulleyLength</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.m_ratio</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_limitImpulse2</span><span class="PUNC">=</span><span class="NAME">this.m_limitImpulse1</span><span class="PUNC">=</span><span class="NAME">this.m_impulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.InitVelocityConstraints</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>394</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.y</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.col1.x</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">j.col2.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">j.col1.y</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">j.col2.y</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">l.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.col1.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">j.col2.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">j.col1.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">j.col2.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">l.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">l.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_ground.m_xf.position.x</span><span class="PUNC">+</span><span class="NAME">this.m_groundAnchor2.x</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_ground.m_xf.position.y</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>395</span> </span><span class="NAME">this.m_groundAnchor2.y</span><span class="PUNC">;</span><span class="NAME">this.m_u1.Set</span><span class="PUNC">(</span><span class="NAME">h.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">o</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_ground.m_xf.position.x</span><span class="PUNC">+</span><span class="NAME">this.m_groundAnchor1.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_ground.m_xf.position.y</span><span class="PUNC">+</span><span class="NAME">this.m_groundAnchor1.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_u2.Set</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_u1.Length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_u2.Length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">></span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">?</span><span class="NAME">this.m_u1.Multiply</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.m_u1.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">></span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">?</span><span class="NAME">this.m_u2.Multiply</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.m_u2.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_constant</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_state</span><span class="PUNC">=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">;</span><span class="NAME">this.m_impulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_state</span><span class="PUNC">=</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">this.m_maxLength1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_limitState1</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>396</span> </span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">;</span><span class="NAME">this.m_limitImpulse1</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_limitState1</span><span class="PUNC">=</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">&lt;</span><span class="NAME">this.m_maxLength2</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_limitState2</span><span class="PUNC">=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">;</span><span class="NAME">this.m_limitImpulse2</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_limitState2</span><span class="PUNC">=</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">this.m_u1.y</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">this.m_u1.x</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_u2.y</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_u2.x</span><span class="PUNC">;</span><span class="NAME">this.m_limitMass1</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">+</span><span class="NAME">h.m_invI</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.m_limitMass2</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">+</span><span class="NAME">l.m_invI</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">this.m_pulleyMass</span><span class="PUNC">=</span><span class="NAME">this.m_limitMass1</span><span class="PUNC">+</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">this.m_limitMass2</span><span class="PUNC">;</span><span class="NAME">this.m_limitMass1</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.m_limitMass1</span><span class="PUNC">;</span><span class="NAME">this.m_limitMass2</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.m_limitMass2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>397</span> </span><span class="NAME">this.m_pulleyMass</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.m_pulleyMass</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.warmStarting</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_impulse</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">this.m_limitImpulse1</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">this.m_limitImpulse2</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">this.m_impulse</span><span class="PUNC">-</span><span class="NAME">this.m_limitImpulse1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_u1.x</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">this.m_impulse</span><span class="PUNC">-</span><span class="NAME">this.m_limitImpulse1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_u1.y</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">-</span><span class="NAME">this.m_limitImpulse2</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_u2.x</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">this.m_impulse</span><span class="PUNC">-</span><span class="NAME">this.m_limitImpulse2</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.m_u2.y</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>398</span> </span><span class="NAME">l.m_invMass</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">l.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_limitImpulse2</span><span class="PUNC">=</span><span class="NAME">this.m_limitImpulse1</span><span class="PUNC">=</span><span class="NAME">this.m_impulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.SolveVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">d.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">d.m_sweep.localCenter.y</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l.col1.x</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">l.col2.x</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">l.col1.y</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">l.col2.y</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>399</span> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l.col1.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">l.col2.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">l.col1.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">l.col2.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_state</span><span class="PUNC">==</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">d.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">d.m_linearVelocity.y</span><span class="PUNC">+</span><span class="NAME">d.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">+</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_u1.x</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">this.m_u1.y</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.m_u2.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">this.m_u2.y</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_pulleyMass</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_impulse</span><span class="PUNC">;</span><span class="NAME">this.m_impulse</span><span class="PUNC">=</span><span class="NAME">y.Max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.m_impulse</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_impulse</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_u1.x</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_u1.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>400</span> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_u2.x</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_u2.y</span><span class="PUNC">;</span><span class="NAME">d.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invMass</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">d.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invMass</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">d.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState1</span><span class="PUNC">==</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">d.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">d.m_linearVelocity.y</span><span class="PUNC">+</span><span class="NAME">d.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_u1.x</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">this.m_u1.y</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_limitMass1</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_limitImpulse1</span><span class="PUNC">;</span><span class="NAME">this.m_limitImpulse1</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>401</span> </span><span class="NAME">y.Max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.m_limitImpulse1</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_limitImpulse1</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_u1.x</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_u1.y</span><span class="PUNC">;</span><span class="NAME">d.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invMass</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">d.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invMass</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">d.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState2</span><span class="PUNC">==</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">+</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.m_u2.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">this.m_u2.y</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_limitMass2</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_limitImpulse2</span><span class="PUNC">;</span><span class="NAME">this.m_limitImpulse2</span><span class="PUNC">=</span><span class="NAME">y.Max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.m_limitImpulse2</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_limitImpulse2</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_u2.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>402</span> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">this.m_u2.y</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">E.prototype.SolvePositionConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_ground.m_xf.position.x</span><span class="PUNC">+</span><span class="NAME">this.m_groundAnchor1.x</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_ground.m_xf.position.y</span><span class="PUNC">+</span><span class="NAME">this.m_groundAnchor1.y</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_ground.m_xf.position.x</span><span class="PUNC">+</span><span class="NAME">this.m_groundAnchor2.x</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_ground.m_xf.position.y</span><span class="PUNC">+</span><span class="NAME">this.m_groundAnchor2.y</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_state</span><span class="PUNC">==</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">l</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>403</span> </span><span class="NAME">d.m_xf.R</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">d.m_sweep.localCenter.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">d.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">l.col1.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">l.col2.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">l.col1.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">l.col2.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.x</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">l.col1.x</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">l.col2.x</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">l.col1.y</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">l.col2.y</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_u1.Set</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_u2.Set</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_u1.Length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_u2.Length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">></span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">?</span><span class="NAME">this.m_u1.Multiply</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>404</span> </span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.m_u1.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">></span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">?</span><span class="NAME">this.m_u2.Multiply</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.m_u2.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_constant</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">y.Max</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">F.b2_maxLinearCorrection</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_pulleyMass</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">this.m_u1.x</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">this.m_u1.y</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">this.m_u2.x</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_ratio</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">this.m_u2.y</span><span class="PUNC">;</span><span class="NAME">d.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invMass</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">d.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invMass</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d.m_sweep.a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>405</span> </span><span class="NAME">h.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState1</span><span class="PUNC">==</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d.m_xf.R</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">d.m_sweep.localCenter.x</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">d.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">l.col1.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">l.col2.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">l.col1.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">l.col2.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.m_u1.Set</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_u1.Length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">></span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_u1.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">this.m_u1.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">l</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_u1.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_maxLength1</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">y.Max</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">F.b2_maxLinearCorrection</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_limitMass1</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>406</span> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">this.m_u1.x</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">this.m_u1.y</span><span class="PUNC">;</span><span class="NAME">d.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invMass</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">d.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invMass</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d.m_sweep.a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState2</span><span class="PUNC">==</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.x</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">l.col1.x</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">l.col2.x</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">l.col1.y</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">l.col2.y</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_u2.Set</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_u2.Length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">></span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_u2.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.m_u2.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">e</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_u2.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>407</span> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_maxLength2</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">y.Max</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">F.b2_maxLinearCorrection</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_limitMass2</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">this.m_u2.x</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">this.m_u2.y</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">h.m_sweep.a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">&lt;</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">R</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">R.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.prototype</span><span class="PUNC">;</span><span class="NAME">R.b2PulleyJointDef</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>408</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.groundAnchorA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.groundAnchorB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">R.prototype.b2PulleyJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2JointDef.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">I.e_pulleyJoint</span><span class="PUNC">;</span><span class="NAME">this.groundAnchorA.Set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.groundAnchorB.Set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA.Set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB.Set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.maxLengthB</span><span class="PUNC">=</span><span class="NAME">this.lengthB</span><span class="PUNC">=</span><span class="NAME">this.maxLengthA</span><span class="PUNC">=</span><span class="NAME">this.lengthA</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.ratio</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.collideConnected</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">R.prototype.Initialize</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>409</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.bodyA</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.bodyB</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">this.groundAnchorA.SetV</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.groundAnchorB.SetV</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA</span><span class="PUNC">=</span><span class="NAME">this.bodyA.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB</span><span class="PUNC">=</span><span class="NAME">this.bodyB.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">o.x</span><span class="PUNC">-</span><span class="NAME">l.x</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">o.y</span><span class="PUNC">-</span><span class="NAME">l.y</span><span class="PUNC">;</span><span class="NAME">this.lengthA</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">q.x</span><span class="PUNC">-</span><span class="NAME">j.x</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">q.y</span><span class="PUNC">-</span><span class="NAME">j.y</span><span class="PUNC">;</span><span class="NAME">this.lengthB</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ratio</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.lengthA</span><span class="PUNC">+</span><span class="NAME">this.ratio</span><span class="PUNC">*</span><span class="NAME">this.lengthB</span><span class="PUNC">;</span><span class="NAME">this.maxLengthA</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">this.ratio</span><span class="PUNC">*</span><span class="NAME">E.b2_minPulleyLength</span><span class="PUNC">;</span><span class="NAME">this.maxLengthB</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">E.b2_minPulleyLength</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.ratio</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>410</span> </span><span class="NAME">N.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.prototype</span><span class="PUNC">;</span><span class="NAME">N.b2RevoluteJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.b2Joint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.K</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">this.K1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">this.K2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">this.K3</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">this.impulse3</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.impulse2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.reduced</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_impulse</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.GetAnchorA</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyA.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.GetAnchorB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyB.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchor2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>411</span> </span><span class="NAME">N.prototype.GetReactionForce</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.GetReactionTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.GetJointAngle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyB.m_sweep.a</span><span class="PUNC">-</span><span class="NAME">this.m_bodyA.m_sweep.a</span><span class="PUNC">-</span><span class="NAME">this.m_referenceAngle</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.GetJointSpeed</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyB.m_angularVelocity</span><span class="PUNC">-</span><span class="NAME">this.m_bodyA.m_angularVelocity</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.IsLimitEnabled</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_enableLimit</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.EnableLimit</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>412</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.GetLowerLimit</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_lowerAngle</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.GetUpperLimit</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_upperAngle</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.SetLimits</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_lowerAngle</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.m_upperAngle</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.IsMotorEnabled</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_bodyA.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_enableMotor</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.EnableMotor</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_enableMotor</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.SetMotorSpeed</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>413</span> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_bodyA.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_bodyB.SetAwake</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_motorSpeed</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.GetMotorSpeed</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_motorSpeed</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.SetMaxMotorTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_maxMotorTorque</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.GetMotorTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_maxMotorTorque</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.b2RevoluteJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2Joint.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor1.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchor2.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_referenceAngle</span><span class="PUNC">=</span><span class="NAME">d.referenceAngle</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>414</span> </span><span class="NAME">this.m_impulse.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_lowerAngle</span><span class="PUNC">=</span><span class="NAME">d.lowerAngle</span><span class="PUNC">;</span><span class="NAME">this.m_upperAngle</span><span class="PUNC">=</span><span class="NAME">d.upperAngle</span><span class="PUNC">;</span><span class="NAME">this.m_maxMotorTorque</span><span class="PUNC">=</span><span class="NAME">d.maxMotorTorque</span><span class="PUNC">;</span><span class="NAME">this.m_motorSpeed</span><span class="PUNC">=</span><span class="NAME">d.motorSpeed</span><span class="PUNC">;</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">=</span><span class="NAME">d.enableLimit</span><span class="PUNC">;</span><span class="NAME">this.m_enableMotor</span><span class="PUNC">=</span><span class="NAME">d.enableMotor</span><span class="PUNC">;</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.InitVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">j.col1.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">j.col2.x</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>415</span> </span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.col1.y</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">j.col2.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">l.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">j.col1.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">j.col2.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">j.col1.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">j.col2.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">l.m_invI</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col1.x</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col2.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col3.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col1.y</span><span class="PUNC">=</span><span class="NAME">this.m_mass.col2.x</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col2.y</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col3.y</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col1.z</span><span class="PUNC">=</span><span class="NAME">this.m_mass.col3.x</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col2.z</span><span class="PUNC">=</span><span class="NAME">this.m_mass.col3.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>416</span> </span><span class="NAME">this.m_mass.col3.z</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_motorMass</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableMotor</span><span class="PUNC">==</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">l.m_sweep.a</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.a</span><span class="PUNC">-</span><span class="NAME">this.m_referenceAngle</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y.Abs</span><span class="PUNC">(</span><span class="NAME">this.m_upperAngle</span><span class="PUNC">-</span><span class="NAME">this.m_lowerAngle</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">F.b2_angularSlop</span><span class="PUNC">)</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_equalLimits</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">&lt;=</span><span class="NAME">this.m_lowerAngle</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">!=</span><span class="NAME">I.e_atLowerLimit</span><span class="PUNC">)</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_atLowerLimit</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">>=</span><span class="NAME">this.m_upperAngle</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">!=</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">)</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>417</span> </span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_limitState</span><span class="PUNC">=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.warmStarting</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">h.m_linearVelocity.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">l.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.m_impulse.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>418</span> </span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.SolveVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">h.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">l.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">h.m_invMass</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">h.m_invI</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">l.m_invI</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableMotor</span><span class="PUNC">&&</span><span class="NAME">this.m_limitState</span><span class="PUNC">!=</span><span class="NAME">I.e_equalLimits</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_motorMass</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">this.m_motorSpeed</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">d.dt</span><span class="PUNC">*</span><span class="NAME">this.m_maxMotorTorque</span><span class="PUNC">;</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">+</span><span class="NAME">o</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_motorImpulse</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>419</span> </span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">&&</span><span class="NAME">this.m_limitState</span><span class="PUNC">!=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.x</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d.col1.x</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">d.col2.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">d.col1.y</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">d.col2.y</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">l.m_xf.R</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.x</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d.col1.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">d.col2.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d.col1.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">d.col2.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">c.x</span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">c.y</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">this.m_mass.Solve33</span><span class="PUNC">(</span><span class="NAME">this.impulse3</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>420</span> </span><span class="NAME">I.e_equalLimits</span><span class="PUNC">)</span><span class="NAME">this.m_impulse.Add</span><span class="PUNC">(</span><span class="NAME">this.impulse3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">==</span><span class="NAME">I.e_atLowerLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">+</span><span class="NAME">this.impulse3.z</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_mass.Solve22</span><span class="PUNC">(</span><span class="NAME">this.reduced</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.impulse3.x</span><span class="PUNC">=</span><span class="NAME">this.reduced.x</span><span class="PUNC">;</span><span class="NAME">this.impulse3.y</span><span class="PUNC">=</span><span class="NAME">this.reduced.y</span><span class="PUNC">;</span><span class="NAME">this.impulse3.z</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.reduced.x</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.reduced.y</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">==</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">+</span><span class="NAME">this.impulse3.z</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_mass.Solve22</span><span class="PUNC">(</span><span class="NAME">this.reduced</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.impulse3.x</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>421</span> </span><span class="NAME">this.reduced.x</span><span class="PUNC">;</span><span class="NAME">this.impulse3.y</span><span class="PUNC">=</span><span class="NAME">this.reduced.y</span><span class="PUNC">;</span><span class="NAME">this.impulse3.z</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.reduced.x</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.reduced.y</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">c.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">this.impulse3.x</span><span class="PUNC">;</span><span class="NAME">c.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">this.impulse3.y</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">this.impulse3.y</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">this.impulse3.x</span><span class="PUNC">+</span><span class="NAME">this.impulse3.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">this.impulse3.x</span><span class="PUNC">;</span><span class="NAME">b.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">this.impulse3.y</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.impulse3.y</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.impulse3.x</span><span class="PUNC">+</span><span class="NAME">this.impulse3.z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">h.m_xf.R</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.x</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">h.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d.col1.x</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>422</span> </span><span class="NAME">d.col2.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">d.col1.y</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">d.col2.y</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">l.m_xf.R</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.x</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d.col1.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">d.col2.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d.col1.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">d.col2.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.m_mass.Solve22</span><span class="PUNC">(</span><span class="NAME">this.impulse2</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">c.x</span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">b.y</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">c.y</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.impulse2.x</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.impulse2.y</span><span class="PUNC">;</span><span class="NAME">c.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">this.impulse2.x</span><span class="PUNC">;</span><span class="NAME">c.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">this.impulse2.y</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">this.impulse2.y</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">this.impulse2.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">this.impulse2.x</span><span class="PUNC">;</span><span class="NAME">b.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">this.impulse2.y</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.impulse2.y</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>423</span> </span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.impulse2.x</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">h.m_linearVelocity.SetV</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">l.m_linearVelocity.SetV</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">N.prototype.SolvePositionConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_enableLimit</span><span class="PUNC">&&</span><span class="NAME">this.m_limitState</span><span class="PUNC">!=</span><span class="NAME">I.e_inactiveLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">j.m_sweep.a</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.a</span><span class="PUNC">-</span><span class="NAME">this.m_referenceAngle</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">==</span><span class="NAME">I.e_equalLimits</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.m_lowerAngle</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">F.b2_maxAngularCorrection</span><span class="PUNC">,</span><span class="NAME">F.b2_maxAngularCorrection</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_motorMass</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">y.Abs</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>424</span> </span><span class="NAME">I.e_atLowerLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.m_lowerAngle</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">F.b2_angularSlop</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">F.b2_maxAngularCorrection</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_motorMass</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.m_limitState</span><span class="PUNC">==</span><span class="NAME">I.e_atUpperLimit</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.m_upperAngle</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">y.Clamp</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">F.b2_angularSlop</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">F.b2_maxAngularCorrection</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.m_motorMass</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">}</span><span class="NAME">l.m_sweep.a</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">l.m_invI</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">j.m_sweep.a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">j.m_invI</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">l.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">l.m_xf.R</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.x</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.x</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor1.y</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>425</span> </span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.x</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchor2.y</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.c.x</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.c.y</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">j.m_invMass</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">l.m_invI</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">j.m_invI</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">></span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">l.m_sweep.c.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">l.m_sweep.c.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">j.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">j.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.m_sweep.c.x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>426</span> </span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.c.x</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.c.y</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">}</span><span class="NAME">this.K1.col1.x</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">this.K1.col2.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.K1.col1.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.K1.col2.y</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">this.K2.col1.x</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.K2.col2.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.K2.col1.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.K2.col2.y</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.K3.col1.x</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.K3.col2.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.K3.col1.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.K3.col2.y</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this.K.SetM</span><span class="PUNC">(</span><span class="NAME">this.K1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.K.AddM</span><span class="PUNC">(</span><span class="NAME">this.K2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.K.AddM</span><span class="PUNC">(</span><span class="NAME">this.K3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.K.Solve</span><span class="PUNC">(</span><span class="NAME">N.tImpulse</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">N.tImpulse.x</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">N.tImpulse.y</span><span class="PUNC">;</span><span class="NAME">l.m_sweep.c.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">l.m_sweep.c.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">l.m_sweep.a</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">l.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>427</span> </span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">j.m_invMass</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">j.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">j.m_invMass</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">j.m_sweep.a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">j.m_invI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">&lt;=</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">&&</span><span class="NAME">o</span><span class="PUNC">&lt;=</span><span class="NAME">F.b2_angularSlop</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.postDefs.push</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">S</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">S.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.prototype</span><span class="PUNC">;</span><span class="NAME">S.b2RevoluteJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>428</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.b2RevoluteJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2JointDef.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">I.e_revoluteJoint</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA.Set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB.Set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.motorSpeed</span><span class="PUNC">=</span><span class="NAME">this.maxMotorTorque</span><span class="PUNC">=</span><span class="NAME">this.upperAngle</span><span class="PUNC">=</span><span class="NAME">this.lowerAngle</span><span class="PUNC">=</span><span class="NAME">this.referenceAngle</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.enableMotor</span><span class="PUNC">=</span><span class="NAME">this.enableLimit</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">S.prototype.Initialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.bodyA</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.bodyB</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA</span><span class="PUNC">=</span><span class="NAME">this.bodyA.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB</span><span class="PUNC">=</span><span class="NAME">this.bodyB.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.referenceAngle</span><span class="PUNC">=</span><span class="NAME">this.bodyB.GetAngle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>429</span> </span><span class="NAME">this.bodyA.GetAngle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">aa.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.prototype</span><span class="PUNC">;</span><span class="NAME">aa.b2WeldJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2Joint.b2Joint.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchorA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchorB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.m_impulse</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">aa.prototype.GetAnchorA</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyA.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchorA</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">aa.prototype.GetAnchorB</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_bodyB.GetWorldPoint</span><span class="PUNC">(</span><span class="NAME">this.m_localAnchorB</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">aa.prototype.GetReactionForce</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>430</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">aa.prototype.GetReactionTorque</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">aa.prototype.b2WeldJoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2Joint.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchorA.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_localAnchorB.SetV</span><span class="PUNC">(</span><span class="NAME">d.localAnchorB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_referenceAngle</span><span class="PUNC">=</span><span class="NAME">d.referenceAngle</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_mass</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">aa.prototype.InitVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>431</span> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorA.x</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorA.y</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">o.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorB.x</span><span class="PUNC">-</span><span class="NAME">o.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorB.y</span><span class="PUNC">-</span><span class="NAME">o.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.col1.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">h.col2.x</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">h.col1.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">h.col2.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j.m_invMass</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">o.m_invMass</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">j.m_invI</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">o.m_invI</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col1.x</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col2.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col3.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col1.y</span><span class="PUNC">=</span><span class="NAME">this.m_mass.col2.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>432</span> </span><span class="NAME">this.m_mass.col2.y</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col3.y</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col1.z</span><span class="PUNC">=</span><span class="NAME">this.m_mass.col3.x</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col2.z</span><span class="PUNC">=</span><span class="NAME">this.m_mass.col3.y</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col3.z</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.warmStarting</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d.dtRatio</span><span class="PUNC">;</span><span class="NAME">j.m_linearVelocity.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">;</span><span class="NAME">j.m_linearVelocity.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">;</span><span class="NAME">j.m_angularVelocity</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o.m_linearVelocity.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">;</span><span class="NAME">o.m_linearVelocity.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>433</span> </span><span class="NAME">o.m_angularVelocity</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.y</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.m_impulse.x</span><span class="PUNC">+</span><span class="NAME">this.m_impulse.z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.m_impulse.SetZero</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">aa.prototype.SolveVelocityConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">l.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.m_linearVelocity</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j.m_angularVelocity</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">j.m_invMass</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">l.m_invI</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">j.m_invI</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">l.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorA.x</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorA.y</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.col1.x</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">d.col2.x</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">d.col1.y</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">d.col2.y</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>434</span> </span><span class="NAME">j.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorB.x</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorB.y</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.col1.x</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NAME">d.col2.x</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">d.col1.y</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NAME">d.col2.y</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">n.x</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">o.x</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">n.y</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">o.y</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.m_mass.Solve33</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.m_impulse.Add</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">o.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">t.x</span><span class="PUNC">;</span><span class="NAME">o.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">t.y</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">t.y</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">t.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">t.x</span><span class="PUNC">;</span><span class="NAME">n.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">t.y</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">t.y</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">t.x</span><span class="PUNC">+</span><span class="NAME">t.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">j.m_angularVelocity</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">aa.prototype.SolvePositionConstraints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.m_bodyA</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.m_bodyB</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">l.m_xf.R</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>435</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorA.x</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorA.y</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.col1.x</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">d.col2.x</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">d.col1.y</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">d.col2.y</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">j.m_xf.R</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorB.x</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.x</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.m_localAnchorB.y</span><span class="PUNC">-</span><span class="NAME">j.m_sweep.localCenter.y</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.col1.x</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">d.col2.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d.col1.y</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">d.col2.y</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">l.m_invMass</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j.m_invMass</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">l.m_invI</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">j.m_invI</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">j.m_sweep.c.x</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.c.x</span><span class="PUNC">-</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">j.m_sweep.c.y</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.c.y</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">j.m_sweep.a</span><span class="PUNC">-</span><span class="NAME">l.m_sweep.a</span><span class="PUNC">-</span><span class="NAME">this.m_referenceAngle</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>436</span> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">y.Abs</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">></span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="NAME">this.m_mass.col1.x</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col2.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col3.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col1.y</span><span class="PUNC">=</span><span class="NAME">this.m_mass.col2.x</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col2.y</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col3.y</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col1.z</span><span class="PUNC">=</span><span class="NAME">this.m_mass.col3.x</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col2.z</span><span class="PUNC">=</span><span class="NAME">this.m_mass.col3.y</span><span class="PUNC">;</span><span class="NAME">this.m_mass.col3.z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.m_mass.Solve33</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.m_sweep.c.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">m.x</span><span class="PUNC">;</span><span class="NAME">l.m_sweep.c.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">m.y</span><span class="PUNC">;</span><span class="NAME">l.m_sweep.a</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">*</span><span class="NAME">m.y</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">m.x</span><span class="PUNC">+</span><span class="NAME">m.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.m_sweep.c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">m.x</span><span class="PUNC">;</span><span class="NAME">j.m_sweep.c.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">m.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>437</span> </span><span class="NAME">j.m_sweep.a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">m.y</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">m.x</span><span class="PUNC">+</span><span class="NAME">m.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.SynchronizeTransform</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">&lt;=</span><span class="NAME">F.b2_linearSlop</span><span class="PUNC">&&</span><span class="NAME">s</span><span class="PUNC">&lt;=</span><span class="NAME">F.b2_angularSlop</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Box2D.inherit</span><span class="PUNC">(</span><span class="NAME">Z</span><span class="PUNC">,</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Z.prototype.__super</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.prototype</span><span class="PUNC">;</span><span class="NAME">Z.b2WeldJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.b2WeldJointDef</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__super.b2JointDef.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">I.e_weldJoint</span><span class="PUNC">;</span><span class="NAME">this.referenceAngle</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>438</span> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">Z.prototype.Initialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.bodyA</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.bodyB</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">this.localAnchorA.SetV</span><span class="PUNC">(</span><span class="NAME">this.bodyA.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.localAnchorB.SetV</span><span class="PUNC">(</span><span class="NAME">this.bodyB.GetLocalPoint</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.referenceAngle</span><span class="PUNC">=</span><span class="NAME">this.bodyB.GetAngle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this.bodyA.GetAngle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>439</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">Box2D.Dynamics.b2DebugDraw</span><span class="PUNC">;</span><span class="NAME">F.b2DebugDraw</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_xformScale</span><span class="PUNC">=</span><span class="NAME">this.m_fillAlpha</span><span class="PUNC">=</span><span class="NAME">this.m_alpha</span><span class="PUNC">=</span><span class="NAME">this.m_lineThickness</span><span class="PUNC">=</span><span class="NAME">this.m_drawScale</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this.m_sprite</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">graphics</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">clear</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">G.m_ctx.clearRect</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">G.m_ctx.canvas.width</span><span class="PUNC">,</span><span class="NAME">G.m_ctx.canvas.height</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype._color</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="STRN">"rgba("</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">&</span><span class="NUMB">16711680</span><span class="PUNC">)</span><span class="PUNC">>></span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">&</span><span class="NUMB">65280</span><span class="PUNC">)</span><span class="PUNC">>></span><span class="NUMB">8</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">K</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.b2DebugDraw</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_drawFlags</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.SetFlags</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_drawFlags</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>440</span> </span><span class="NAME">G</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.GetFlags</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_drawFlags</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.AppendFlags</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_drawFlags</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">G</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.ClearFlags</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_drawFlags</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="PUNC">~</span><span class="NAME">G</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.SetSprite</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.m_ctx</span><span class="PUNC">=</span><span class="NAME">G</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.GetSprite</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_ctx</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.SetDrawScale</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_drawScale</span><span class="PUNC">=</span><span class="NAME">G</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.GetDrawScale</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_drawScale</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.SetLineThickness</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>441</span> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_lineThickness</span><span class="PUNC">=</span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">this.m_ctx.strokeWidth</span><span class="PUNC">=</span><span class="NAME">G</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.GetLineThickness</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_lineThickness</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.SetAlpha</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_alpha</span><span class="PUNC">=</span><span class="NAME">G</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.GetAlpha</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_alpha</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.SetFillAlpha</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_fillAlpha</span><span class="PUNC">=</span><span class="NAME">G</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.GetFillAlpha</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_fillAlpha</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.SetXFormScale</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.m_xformScale</span><span class="PUNC">=</span><span class="NAME">G</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.GetXFormScale</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.m_xformScale</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>442</span> </span><span class="NAME">F.prototype.DrawPolygon</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">this.m_ctx</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">this.m_drawScale</span><span class="PUNC">;</span><span class="NAME">w.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.strokeStyle</span><span class="PUNC">=</span><span class="NAME">this._color</span><span class="PUNC">(</span><span class="NAME">y.color</span><span class="PUNC">,</span><span class="NAME">this.m_alpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.moveTo</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">y</span><span class="PUNC">&lt;</span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">y</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">w.lineTo</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.lineTo</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.DrawSolidPolygon</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">this.m_ctx</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">this.m_drawScale</span><span class="PUNC">;</span><span class="NAME">w.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.strokeStyle</span><span class="PUNC">=</span><span class="NAME">this._color</span><span class="PUNC">(</span><span class="NAME">y.color</span><span class="PUNC">,</span><span class="NAME">this.m_alpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.fillStyle</span><span class="PUNC">=</span><span class="NAME">this._color</span><span class="PUNC">(</span><span class="NAME">y.color</span><span class="PUNC">,</span><span class="NAME">this.m_fillAlpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.moveTo</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>443</span> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">y</span><span class="PUNC">&lt;</span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">y</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">w.lineTo</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.lineTo</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.DrawCircle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">this.m_ctx</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">this.m_drawScale</span><span class="PUNC">;</span><span class="NAME">w.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.strokeStyle</span><span class="PUNC">=</span><span class="NAME">this._color</span><span class="PUNC">(</span><span class="NAME">y.color</span><span class="PUNC">,</span><span class="NAME">this.m_alpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.arc</span><span class="PUNC">(</span><span class="NAME">G.x</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">G.y</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Math.PI</span><span class="PUNC">*</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.DrawSolidCircle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">this.m_ctx</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">=</span><span class="NAME">this.m_drawScale</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">G.x</span><span class="PUNC">*</span><span class="NAME">U</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">G.y</span><span class="PUNC">*</span><span class="NAME">U</span><span class="PUNC">;</span><span class="NAME">A.moveTo</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.strokeStyle</span><span class="PUNC">=</span><span class="NAME">this._color</span><span class="PUNC">(</span><span class="NAME">w.color</span><span class="PUNC">,</span><span class="NAME">this.m_alpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.fillStyle</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>444</span> </span><span class="NAME">this._color</span><span class="PUNC">(</span><span class="NAME">w.color</span><span class="PUNC">,</span><span class="NAME">this.m_fillAlpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.arc</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">*</span><span class="NAME">U</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Math.PI</span><span class="PUNC">*</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.moveTo</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.lineTo</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">G.x</span><span class="PUNC">+</span><span class="NAME">y.x</span><span class="PUNC">*</span><span class="NAME">K</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">U</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">G.y</span><span class="PUNC">+</span><span class="NAME">y.y</span><span class="PUNC">*</span><span class="NAME">K</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">U</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.DrawSegment</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">this.m_ctx</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">this.m_drawScale</span><span class="PUNC">;</span><span class="NAME">w.strokeStyle</span><span class="PUNC">=</span><span class="NAME">this._color</span><span class="PUNC">(</span><span class="NAME">y.color</span><span class="PUNC">,</span><span class="NAME">this.m_alpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.moveTo</span><span class="PUNC">(</span><span class="NAME">G.x</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">G.y</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.lineTo</span><span class="PUNC">(</span><span class="NAME">K.x</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">K.y</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">F.prototype.DrawTransform</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">this.m_ctx</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">this.m_drawScale</span><span class="PUNC">;</span><span class="NAME">K.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">K.strokeStyle</span><span class="PUNC">=</span><span class="NAME">this._color</span><span class="PUNC">(</span><span class="NUMB">16711680</span><span class="PUNC">,</span><span class="NAME">this.m_alpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>445</span> </span><span class="NAME">K.moveTo</span><span class="PUNC">(</span><span class="NAME">G.position.x</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">G.position.y</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">K.lineTo</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">G.position.x</span><span class="PUNC">+</span><span class="NAME">this.m_xformScale</span><span class="PUNC">*</span><span class="NAME">G.R.col1.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">G.position.y</span><span class="PUNC">+</span><span class="NAME">this.m_xformScale</span><span class="PUNC">*</span><span class="NAME">G.R.col1.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">K.strokeStyle</span><span class="PUNC">=</span><span class="NAME">this._color</span><span class="PUNC">(</span><span class="NUMB">65280</span><span class="PUNC">,</span><span class="NAME">this.m_alpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">K.moveTo</span><span class="PUNC">(</span><span class="NAME">G.position.x</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">G.position.y</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">K.lineTo</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">G.position.x</span><span class="PUNC">+</span><span class="NAME">this.m_xformScale</span><span class="PUNC">*</span><span class="NAME">G.R.col2.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">G.position.y</span><span class="PUNC">+</span><span class="NAME">this.m_xformScale</span><span class="PUNC">*</span><span class="NAME">G.R.col2.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">K.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">K.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">Box2D.postDefs.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">i</span><span class="PUNC">)</span><span class="NAME">Box2D.postDefs</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">Box2D.postDefs</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>446</span> </span></pre></body></html>